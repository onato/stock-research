<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seeka Limited (SEK.NZ) Financial Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        .header h1 {
            font-size: 2.5rem;
            background: linear-gradient(90deg, #00d4aa, #00b894);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        .header p {
            color: #888;
            font-size: 1.1rem;
        }

        /* Investment Overview Section */
        .overview-section {
            max-width: 1400px;
            margin: 0 auto 30px;
        }
        .overview-toggle {
            width: 100%;
            background: rgba(0, 212, 170, 0.1);
            border: 1px solid rgba(0, 212, 170, 0.3);
            border-radius: 12px;
            padding: 16px 24px;
            color: #00d4aa;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
        }
        .overview-toggle:hover {
            background: rgba(0, 212, 170, 0.2);
        }
        .overview-toggle .arrow {
            transition: transform 0.3s ease;
        }
        .overview-toggle.active .arrow {
            transform: rotate(180deg);
        }
        .overview-content {
            display: none;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-top: none;
            border-radius: 0 0 12px 12px;
            padding: 30px;
            margin-top: -12px;
        }
        .overview-content.active {
            display: block;
        }
        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
        }
        .overview-card {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .overview-card h3 {
            color: #00d4aa;
            font-size: 1.1rem;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .overview-card p {
            margin-bottom: 12px;
            line-height: 1.6;
        }
        .overview-card ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .overview-card li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            line-height: 1.5;
        }
        .overview-card li:last-child {
            border-bottom: none;
        }
        .overview-card.bull h3 { color: #00d4aa; }
        .overview-card.bear h3 { color: #ff6b6b; }
        .overview-card.risks h3 { color: #fdcb6e; }
        .risk-high { color: #ff6b6b; font-weight: 600; }
        .risk-moderate { color: #fdcb6e; font-weight: 600; }
        .risk-low { color: #00d4aa; font-weight: 600; }
        .revenue-stream {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .revenue-stream .percent {
            color: #00d4aa;
            font-weight: 600;
        }
        .trend-growing { color: #00d4aa; }
        .trend-stable { color: #888; }
        .trend-declining { color: #ff6b6b; }

        /* KPI Grid */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
        }
        .kpi-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 212, 170, 0.2);
        }
        .kpi-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #00d4aa;
            margin-bottom: 5px;
        }
        .kpi-label {
            font-size: 0.85rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .kpi-change {
            font-size: 0.9rem;
            margin-top: 5px;
        }
        .kpi-change.positive { color: #00d4aa; }
        .kpi-change.negative { color: #ff6b6b; }

        /* Guidance Section */
        .guidance-section {
            max-width: 1400px;
            margin: 0 auto 30px;
        }
        .guidance-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .guidance-header h3 {
            color: #fff;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .guidance-header h3::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 20px;
            background: linear-gradient(180deg, #00d4aa, #00b894);
            border-radius: 2px;
        }
        .guidance-meta {
            font-size: 0.85rem;
            color: #888;
        }
        .guidance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .guidance-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 18px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.2s ease;
        }
        .guidance-card:hover {
            transform: translateY(-2px);
        }
        .guidance-metric {
            font-size: 0.8rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }
        .guidance-target {
            font-size: 1.4rem;
            font-weight: 600;
            color: #00d4aa;
            margin-bottom: 6px;
        }
        .guidance-period {
            font-size: 0.85rem;
            color: #e0e0e0;
            margin-bottom: 8px;
        }
        .guidance-vs-prior {
            display: inline-block;
            font-size: 0.75rem;
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: 500;
        }
        .guidance-vs-prior.raised {
            background: rgba(0, 212, 170, 0.15);
            color: #00d4aa;
        }
        .guidance-vs-prior.lowered {
            background: rgba(255, 107, 107, 0.15);
            color: #ff6b6b;
        }
        .guidance-vs-prior.maintained {
            background: rgba(255, 255, 255, 0.1);
            color: #888;
        }
        .guidance-vs-prior.new {
            background: rgba(99, 102, 241, 0.15);
            color: #818cf8;
        }
        .guidance-notes {
            font-size: 0.8rem;
            color: #666;
            margin-top: 8px;
            line-height: 1.4;
        }
        .guidance-commentary {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            padding: 16px 20px;
            border-left: 3px solid #00d4aa;
            font-style: italic;
            color: #b0b0b0;
            line-height: 1.6;
        }
        .guidance-commentary::before {
            content: '"';
            font-size: 1.5rem;
            color: #00d4aa;
            margin-right: 4px;
        }

        /* Charts */
        .section-title {
            font-size: 1.5rem;
            color: #fff;
            margin: 40px auto 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(0, 212, 170, 0.3);
            max-width: 1400px;
        }
        .charts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 25px;
            max-width: 1400px;
            margin: 0 auto;
        }
        .chart-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .chart-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .chart-header h3 {
            color: #fff;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .chart-header h3::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 20px;
            background: linear-gradient(180deg, #00d4aa, #00b894);
            border-radius: 2px;
        }
        .help-btn {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: rgba(0, 212, 170, 0.2);
            border: 1px solid #00d4aa;
            color: #00d4aa;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        .help-btn:hover {
            background: #00d4aa;
            color: #1a1a2e;
        }
        .chart-wrapper {
            position: relative;
            height: 300px;
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .modal-overlay.active { display: flex; }
        .modal {
            background: linear-gradient(135deg, #1e2a4a 0%, #16213e 100%);
            border-radius: 16px;
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid rgba(0, 212, 170, 0.3);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }
        .modal-header {
            padding: 20px 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .modal-header h3 {
            color: #00d4aa;
            font-size: 1.4rem;
            margin: 0;
        }
        .modal-close {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid #ff6b6b;
            color: #ff6b6b;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-close:hover {
            background: #ff6b6b;
            color: #fff;
        }
        .modal-body {
            padding: 25px;
            line-height: 1.7;
        }
        .modal-body p { margin-bottom: 15px; }
        .modal-body strong { color: #00d4aa; }
        .modal-body ul { margin: 15px 0; padding-left: 20px; }
        .modal-body li { margin-bottom: 8px; }
        .metric-highlight {
            background: rgba(0, 212, 170, 0.1);
            border-left: 3px solid #00d4aa;
            padding: 12px 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        /* DCF Valuation Section */
        .dcf-section {
            max-width: 1400px;
            margin: 0 auto 40px;
        }
        .dcf-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .dcf-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease;
        }
        .dcf-card:hover {
            transform: translateY(-3px);
        }
        .dcf-card.highlight {
            background: rgba(0, 212, 170, 0.1);
            border-color: rgba(0, 212, 170, 0.3);
        }
        .dcf-label {
            font-size: 0.85rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }
        .dcf-value {
            font-size: 2.2rem;
            font-weight: bold;
            color: #00d4aa;
        }
        .dcf-card:not(.highlight) .dcf-value {
            color: #fff;
        }
        .dcf-change {
            font-size: 1rem;
            margin-top: 8px;
            font-weight: 600;
        }
        .dcf-change.positive { color: #00d4aa; }
        .dcf-change.negative { color: #ff6b6b; }
        .dcf-sublabel {
            font-size: 0.8rem;
            color: #666;
            margin-top: 8px;
        }
        .dcf-warning {
            background: rgba(253, 203, 110, 0.15);
            border: 1px solid rgba(253, 203, 110, 0.4);
            border-radius: 8px;
            padding: 12px 16px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #fdcb6e;
        }
        .warning-icon {
            font-size: 1.2rem;
        }
        .dcf-inputs {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .dcf-inputs h4 {
            color: #e0e0e0;
            margin-bottom: 15px;
            font-size: 1rem;
        }
        .dcf-inputs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .dcf-input-card {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        .dcf-input-label {
            font-size: 0.75rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }
        .dcf-input-value {
            font-size: 1.3rem;
            font-weight: 600;
            color: #00d4aa;
        }
        .dcf-input-note {
            font-size: 0.7rem;
            color: #666;
            margin-top: 4px;
        }
        .fcf-projections h5 {
            color: #b0b0b0;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }
        .fcf-projection-table {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 12px;
        }
        .fcf-projection-item {
            text-align: center;
        }
        .fcf-projection-item.header {
            font-size: 0.75rem;
            color: #888;
            font-weight: 600;
        }
        .fcf-projection-item .year {
            font-size: 0.75rem;
            color: #888;
            margin-bottom: 2px;
        }
        .fcf-projection-item .fcf-value {
            font-size: 1rem;
            color: #e0e0e0;
            font-weight: 500;
        }
        .fcf-projection-item .growth-rate {
            font-size: 0.75rem;
            color: #00d4aa;
            margin-top: 2px;
        }
        .dcf-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .slider-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .slider-group label {
            font-size: 0.95rem;
            color: #e0e0e0;
            display: flex;
            justify-content: space-between;
        }
        .slider-group label span {
            color: #00d4aa;
            font-weight: 600;
        }
        .slider-group input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: rgba(255, 255, 255, 0.1);
            outline: none;
        }
        .slider-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #00d4aa;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .slider-group input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }
        .slider-group input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #00d4aa;
            cursor: pointer;
            border: none;
        }
        .slider-hint {
            font-size: 0.8rem;
            color: #666;
        }
        .scenario-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .scenario-tab {
            padding: 10px 24px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: transparent;
            color: #888;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.2s;
        }
        .scenario-tab:hover {
            border-color: rgba(0, 212, 170, 0.5);
            color: #e0e0e0;
        }
        .scenario-tab.active {
            background: rgba(0, 212, 170, 0.15);
            border-color: #00d4aa;
            color: #00d4aa;
        }
        .scenario-details {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .scenario-details h4 {
            color: #00d4aa;
            margin-bottom: 15px;
        }
        .assumption-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        .assumption-item {
            text-align: center;
        }
        .assumption-item .label {
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 4px;
        }
        .assumption-item .value {
            font-size: 1.1rem;
            color: #e0e0e0;
            font-weight: 500;
        }
        .sensitivity-section {
            margin-bottom: 30px;
        }
        .sensitivity-section h4 {
            color: #e0e0e0;
            margin-bottom: 15px;
        }
        .sensitivity-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            overflow: hidden;
        }
        .sensitivity-table th,
        .sensitivity-table td {
            padding: 12px 16px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .sensitivity-table th {
            background: rgba(0, 212, 170, 0.1);
            color: #00d4aa;
            font-weight: 600;
        }
        .sensitivity-table td {
            color: #e0e0e0;
        }
        .sensitivity-table td.highlight {
            background: rgba(0, 212, 170, 0.15);
            color: #00d4aa;
            font-weight: 600;
        }
        .sensitivity-table td.below-current {
            color: #ff6b6b;
        }
        .sensitivity-table td.above-current {
            color: #00d4aa;
        }
        .historical-growth {
            margin-bottom: 30px;
        }
        .historical-growth h4 {
            color: #e0e0e0;
            margin-bottom: 15px;
        }
        .growth-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
        }
        .growth-item {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .growth-item .metric {
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 6px;
        }
        .growth-item .rate {
            font-size: 1.2rem;
            font-weight: 600;
        }
        .growth-item .rate.positive { color: #00d4aa; }
        .growth-item .rate.negative { color: #ff6b6b; }
        .growth-item.selected {
            border-color: #00d4aa;
            background: rgba(0, 212, 170, 0.1);
        }
        .dcf-download {
            text-align: center;
            margin-top: 30px;
        }
        .download-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 14px 28px;
            background: rgba(0, 212, 170, 0.15);
            border: 1px solid #00d4aa;
            border-radius: 8px;
            color: #00d4aa;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.2s;
        }
        .download-btn:hover {
            background: #00d4aa;
            color: #1a1a2e;
        }
        .download-icon {
            font-size: 1.2rem;
        }

        @media (max-width: 768px) {
            .charts-container { grid-template-columns: 1fr; }
            .overview-grid { grid-template-columns: 1fr; }
            .header h1 { font-size: 1.8rem; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Seeka Limited (SEK.NZ)</h1>
        <p>New Zealand's Largest Integrated Kiwifruit Company | All values in NZD</p>
    </div>

    <!-- Investment Overview Section -->
    <div class="overview-section">
        <button class="overview-toggle" onclick="toggleOverview()">
            <span>Investment Overview & Analysis</span>
            <span class="arrow">▼</span>
        </button>
        <div class="overview-content" id="overviewContent">
            <div class="overview-grid">
                <!-- Company Overview -->
                <div class="overview-card">
                    <h3>Company Overview</h3>
                    <p>Seeka Limited is New Zealand and Australia's largest fully integrated kiwifruit supply company, providing orcharding, post-harvest packing, coolstorage, and retail services across the fresh produce industry. Headquartered in Te Puke, New Zealand, Seeka operates 12 post-harvest facilities, grows kiwifruit on approximately 1,000 hectares, and handles approximately 21% of New Zealand's kiwifruit post-harvest market, servicing Zespri (the global kiwifruit marketer) and directly supplying large-format retailers in Australia, Asia, and New Zealand.</p>
                </div>

                <!-- Business Model -->
                <div class="overview-card">
                    <h3>Business Model</h3>
                    <p>Highly seasonal fee-for-service business model with revenue concentrated in H1 (January-June harvest period). Post-harvest operations generate ~60% of revenue through per-tray packing and coolstorage fees. Orcharding provides ~25% of revenue through orchard management fees and profit-sharing on leased orchards. Model benefits from operational leverage as volumes increase.</p>
                    <ul>
                        <li class="revenue-stream">
                            <span>Post-harvest (packing & coolstorage)</span>
                            <span class="percent">60%</span>
                        </li>
                        <li class="revenue-stream">
                            <span>Orcharding (management & leased orchards) <span class="trend-growing">↑</span></span>
                            <span class="percent">25%</span>
                        </li>
                        <li class="revenue-stream">
                            <span>SeekaFresh retail services <span class="trend-growing">↑</span></span>
                            <span class="percent">8%</span>
                        </li>
                        <li class="revenue-stream">
                            <span>Australia operations <span class="trend-growing">↑</span></span>
                            <span class="percent">5%</span>
                        </li>
                        <li class="revenue-stream">
                            <span>Other (avocado oil, Kiwi Crush)</span>
                            <span class="percent">2%</span>
                        </li>
                    </ul>
                    <p><strong>Customer Type:</strong> B2B - primarily Zespri (single-desk kiwifruit exporter), independent growers, and retail customers</p>
                    <p><strong>Seasonality:</strong> Highly seasonal - majority of earnings generated in H1 (January-June kiwifruit harvest and packing period)</p>
                </div>

                <!-- Competitive Position -->
                <div class="overview-card">
                    <h3>Competitive Position</h3>
                    <p><strong>Market Position:</strong> Second-largest post-harvest operator in New Zealand with ~21% market share. Largest fully integrated player (growing + packing + marketing). Only listed pure-play kiwifruit company on NZX.</p>
                    <p><strong>Main Competitors:</strong> EastPack (cooperative, ~30% market share), DMS Progrowers Limited, Apata Group Limited, Mount Pack and Cool, Aongatete Coolstores Limited</p>
                    <p><strong>Moat Factors:</strong></p>
                    <ul>
                        <li><strong>Long-term grower relationships (Moderate):</strong> 40% of packed fruit comes from Seeka-managed or leased orchards, providing supply certainty and cross-selling opportunities.</li>
                        <li><strong>Strategic infrastructure (Moderate):</strong> 12 post-harvest facilities with capacity for >50M trays, automated packing lines provide efficiency advantages. $388.3M in PP&E creates high barriers to entry.</li>
                        <li><strong>Switching costs (Moderate):</strong> Growers face costs and disruption switching packhouses; multi-year contracts common.</li>
                        <li><strong>Operational expertise (Moderate):</strong> Excellence in harvest timing, quality control, and automation delivers grower value.</li>
                    </ul>
                    <p><strong>Weaknesses:</strong> Dependence on Zespri's global marketing success, limited pricing power in competitive post-harvest sector, high fixed costs create earnings volatility, market cap below net asset value signals investor concerns.</p>
                </div>

                <!-- Growth Drivers -->
                <div class="overview-card">
                    <h3>Growth Drivers</h3>
                    <ul>
                        <li>New Zealand kiwifruit industry volume growth - Zespri forecasts 10% volume increase to 236M trays by 2030 from 214M in 2025</li>
                        <li>SunGold variety expansion - higher-margin gold kiwifruit projected to grow 17% to 163.5M trays by 2030</li>
                        <li>Automation investments - new Reemoon technology at Kerikeri and Huka Pak for 2026 season will lower unit costs and increase throughput. Cost per tray already down 19% in FY2024.</li>
                        <li>Australian orchard expansion - $17.2M invested in new developments including 64 hectares of kiwifruit. Kiwifruit production up 166% in FY2024.</li>
                        <li>Diversification beyond kiwifruit - growing revenue from persimmon, citrus, banana ripening, avocado, and wholesale markets improves asset utilization</li>
                        <li>Market share consolidation - history of successful acquisitions. Industry consolidating from ~39 packing facilities as capital requirements increase.</li>
                    </ul>
                </div>

                <!-- Key Risks -->
                <div class="overview-card risks">
                    <h3>Key Risks</h3>
                    <ul>
                        <li><span class="risk-high">HIGH:</span> Volume volatility - FY2023 saw $21M loss from low volumes (29.8M trays) vs FY2024 $29.7M profit on 43.0M trays. High operating leverage magnifies volume swings from weather, cyclones, disease.</li>
                        <li><span class="risk-high">HIGH:</span> Zespri dependency - ~60% of revenue dependent on Zespri as single-desk exporter. Limited ability to diversify away from this structural dependency.</li>
                        <li><span class="risk-high">HIGH:</span> Climate change and weather - Research shows Te Puke (core region) kiwifruit production may become marginal by 2050. Near-term risks: inadequate winter chill, spring frost, water stress, cyclones.</li>
                        <li><span class="risk-high">HIGH:</span> PSA disease - Bacterial canker remains endemic requiring ongoing management. New strains or mutations could cause production losses.</li>
                        <li><span class="risk-moderate">MODERATE:</span> Debt levels and covenants - Net debt of $130.6M (June 2025, down from $170.9M). Reduced but still material relative to $266M net assets.</li>
                        <li><span class="risk-moderate">MODERATE:</span> Competitive pressure - Unregulated post-harvest sector constrains pricing power and margins.</li>
                        <li><span class="risk-moderate">MODERATE:</span> Automation integration - Significant capex in Reemoon technology requires successful integration and ROI achievement.</li>
                    </ul>
                </div>

                <!-- Bull Case -->
                <div class="overview-card bull">
                    <h3>Bull Case</h3>
                    <ul>
                        <li>Industry tailwind: NZ kiwifruit volumes forecast to grow 10% by 2030, with Zespri projecting record 2025/26 season of 205-215M trays. Seeka positioned to capture proportional growth.</li>
                        <li>Operating leverage: Record H1 2025 ($59.4M NPBT in 6 months) demonstrates earnings power at higher volumes. NPBT margin expanded to 19.3% in H1 2025 vs 15.8% in H1 2024.</li>
                        <li>Financial turnaround complete: Successfully navigated 2023 crisis, reduced net debt by $75M+ over two years, resumed dividends ($0.30/share in H1 2025).</li>
                        <li>Valuation discount to fundamentals: Trading below net asset value ($266M). Stock up 67.88% over past year but normalized earnings of $44-48M NPBT supports significantly higher valuation.</li>
                        <li>Australian growth engine: Kiwifruit production up 166% in FY2024. Dominant 70% share of Australian kiwifruit market.</li>
                        <li>Automation competitive advantage: Reemoon technology will drive throughput gains and labor cost savings vs competitors.</li>
                    </ul>
                </div>

                <!-- Bear Case -->
                <div class="overview-card bear">
                    <h3>Bear Case</h3>
                    <ul>
                        <li>Binary volume-driven outcomes: FY2023 ($21M loss) vs FY2024 ($30M profit) vs H1 2025 ($59M NPBT) shows extreme earnings sensitivity to weather. Climate change threatens long-term viability.</li>
                        <li>Structural Zespri dependency: ~60% of business tied to single customer with no ability to diversify away. Zespri faces 7,850+ hectares of unauthorized SunGold in China diluting variety premiums.</li>
                        <li>Market skepticism justified: Trading below book value despite record earnings suggests market sees earnings as cyclical peak or asset values as overstated. Goodwill of $20.2M may face impairment.</li>
                        <li>Automation execution risk: Significant capex in Reemoon technology requires successful integration and ROI achievement. Competitors like Mount Pack & Cool have superior automation.</li>
                        <li>Debt overhang constrains flexibility: Despite improvement, $130.6M net debt (49% of net assets) limits ability to fund growth, weather downturns, or pursue M&A.</li>
                        <li>Climate and biosecurity existential threats: PSA-V required costly industry restructuring. Increasing cyclone frequency and water stress threaten core Te Puke region.</li>
                    </ul>
                </div>

                <!-- Recent Developments -->
                <div class="overview-card">
                    <h3>Recent Developments</h3>
                    <ul>
                        <li><strong>2025-Aug:</strong> Upgraded FY2025 guidance to $44-48M NPBT (from $35-39M). Announced $0.15 dividend payable October 2025.</li>
                        <li><strong>2025-H1:</strong> Record H1 result: NPAT $37.8M (up 121% YoY), NPBT $59.4M, revenue $307.9M. Packed 47.1M trays vs 43.0M prior year. Net debt reduced $40.2M to $130.6M.</li>
                        <li><strong>2025-H1:</strong> Announced Reemoon automation upgrades for Kerikeri and Huka Pak facilities for 2026 season to increase capacity and efficiency.</li>
                        <li><strong>2025-Jan:</strong> Launched Ruby Roo (new red nashi variety) in Australian market, developed by Plant & Food Research.</li>
                        <li><strong>2024-Dec:</strong> Board changes: Mark Dewdney appointed Dec 1, Hayley Gourley appointed Jan 1. Fred Hutchings to retire at April 2025 AGM.</li>
                        <li><strong>2024-FY:</strong> Record FY2024 results: NPBT $29.7M (vs $21M loss FY2023), packed 43.0M trays (up 44%). Resumed dividends with $0.15/share total.</li>
                        <li><strong>2024-FY:</strong> Australian operations revenue up 85% to $19.2M with kiwifruit production up 166% to 2.3M kg following new Psa crop protection program.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- KPI Cards -->
    <div class="kpi-grid" id="kpiGrid">
        <!-- Populated by JavaScript -->
    </div>

    <!-- Management Guidance Section -->
    <div class="guidance-section" id="guidanceSection">
        <div class="guidance-header">
            <h3>Management Guidance</h3>
            <span class="guidance-meta">As of <span id="guidanceAsOf">H1 2025 Results (August 2025)</span> | <span id="guidanceFY">FY2025</span></span>
        </div>
        <div class="guidance-grid" id="guidanceGrid">
            <!-- Populated by JavaScript -->
        </div>
        <div class="guidance-commentary" id="guidanceCommentary">
            <!-- Populated by JavaScript -->
        </div>
    </div>

    <!-- Charts -->
    <h2 class="section-title">Financial Performance</h2>
    <div class="charts-container">
        <div class="chart-card">
            <div class="chart-header">
                <h3>Revenue Trend</h3>
                <button class="help-btn" onclick="openModal('revenue')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="revenueChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Profitability Metrics</h3>
                <button class="help-btn" onclick="openModal('profitability')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="profitabilityChart"></canvas>
            </div>
        </div>
    </div>

    <h2 class="section-title">Operational Metrics</h2>
    <div class="charts-container">
        <div class="chart-card">
            <div class="chart-header">
                <h3>Kiwifruit Trays Packed</h3>
                <button class="help-btn" onclick="openModal('trays')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="traysChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Margin Analysis</h3>
                <button class="help-btn" onclick="openModal('margins')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="marginsChart"></canvas>
            </div>
        </div>
    </div>

    <h2 class="section-title">Cash Flow & Balance Sheet</h2>
    <div class="charts-container">
        <div class="chart-card">
            <div class="chart-header">
                <h3>Operating Cash Flow</h3>
                <button class="help-btn" onclick="openModal('cashflow')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="cashflowChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Balance Sheet Overview</h3>
                <button class="help-btn" onclick="openModal('balancesheet')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="balancesheetChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Net Debt Trend</h3>
                <button class="help-btn" onclick="openModal('netdebt')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="netdebtChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>EPS Trend</h3>
                <button class="help-btn" onclick="openModal('eps')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="epsChart"></canvas>
            </div>
        </div>
    </div>

    <h2 class="section-title">Revenue Analysis</h2>
    <div class="charts-container">
        <div class="chart-card">
            <div class="chart-header">
                <h3>Revenue vs Gross Profit</h3>
                <button class="help-btn" onclick="openModal('revenuevsgp')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="revenuevsgpChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Dividends Per Share</h3>
                <button class="help-btn" onclick="openModal('dividends')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="dividendsChart"></canvas>
            </div>
        </div>
    </div>

    <!-- DCF Valuation Section -->
    <h2 class="section-title">DCF Valuation</h2>
    <div class="dcf-section">
        <!-- Valuation Summary Cards -->
        <div class="dcf-summary">
            <div class="dcf-card highlight">
                <div class="dcf-label">Intrinsic Value</div>
                <div class="dcf-value" id="dcfIV">$20.88</div>
                <div class="dcf-change positive" id="dcfUpside">+349% upside</div>
            </div>
            <div class="dcf-card">
                <div class="dcf-label">Entry Price (15% CAGR)</div>
                <div class="dcf-value" id="dcfEntry">$13.91</div>
                <div class="dcf-sublabel">Buy below for 15% annual return</div>
            </div>
            <div class="dcf-card">
                <div class="dcf-label">Current Price</div>
                <div class="dcf-value" id="dcfCurrent">$4.65</div>
            </div>
            <div class="dcf-card">
                <div class="dcf-label">Prob-Weighted IV</div>
                <div class="dcf-value" id="dcfWeighted">$21.91</div>
                <div class="dcf-sublabel">25% Bull / 50% Base / 25% Bear</div>
            </div>
        </div>

        <!-- Growth Rate Warning -->
        <div class="dcf-warning" id="growthWarning" style="display: none;">
            <span class="warning-icon">⚠</span>
            <span id="warningText">Growth divergence warning</span>
        </div>

        <!-- DCF Inputs Display -->
        <div class="dcf-inputs">
            <h4>DCF Model Inputs</h4>
            <div class="dcf-inputs-grid">
                <div class="dcf-input-card">
                    <div class="dcf-input-label">Base Year FCF</div>
                    <div class="dcf-input-value" id="baseFCF">$66.0M</div>
                    <div class="dcf-input-note">Starting point for projections</div>
                </div>
                <div class="dcf-input-card">
                    <div class="dcf-input-label">Shares Outstanding</div>
                    <div class="dcf-input-value" id="sharesOut">41.6M</div>
                </div>
                <div class="dcf-input-card">
                    <div class="dcf-input-label">Net Debt</div>
                    <div class="dcf-input-value" id="netDebt">$136.9M</div>
                    <div class="dcf-input-note">As of FY2024</div>
                </div>
            </div>
            <div class="fcf-projections">
                <h5>Projected FCF (5-Year)</h5>
                <div class="fcf-projection-table" id="fcfProjectionTable">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Interactive Sliders -->
        <div class="dcf-controls">
            <div class="slider-group">
                <label>Growth Rate: <span id="growthValue">12%</span></label>
                <input type="range" id="growthSlider" min="0" max="30" value="12" step="1">
                <div class="slider-hint" id="growthHint">Based on industry growth and momentum</div>
            </div>
            <div class="slider-group">
                <label>WACC: <span id="waccValue">11%</span></label>
                <input type="range" id="waccSlider" min="6" max="18" value="11" step="0.5">
            </div>
            <div class="slider-group">
                <label>Terminal Growth: <span id="terminalValue">2.5%</span></label>
                <input type="range" id="terminalSlider" min="0" max="5" value="2.5" step="0.5">
            </div>
        </div>

        <!-- Scenario Tabs -->
        <div class="scenario-tabs">
            <button class="scenario-tab active" data-scenario="base" onclick="switchScenario('base')">Base Case</button>
            <button class="scenario-tab" data-scenario="bull" onclick="switchScenario('bull')">Bull Case</button>
            <button class="scenario-tab" data-scenario="bear" onclick="switchScenario('bear')">Bear Case</button>
        </div>

        <!-- Scenario Details -->
        <div class="scenario-details" id="scenarioDetails">
            <div class="scenario-assumptions">
                <h4>Assumptions</h4>
                <div class="assumption-grid" id="assumptionGrid">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Sensitivity Table -->
        <div class="sensitivity-section">
            <h4>Sensitivity Analysis: Intrinsic Value by WACC & Terminal Growth</h4>
            <table class="sensitivity-table" id="sensitivityMatrix">
                <!-- Populated by JavaScript -->
            </table>
        </div>

        <!-- Historical Growth Rates -->
        <div class="historical-growth">
            <h4>Historical Growth Rates (CAGR)</h4>
            <div class="growth-grid" id="growthGrid">
                <!-- Populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal-overlay" id="modalOverlay" onclick="closeModal(event)">
        <div class="modal">
            <div class="modal-header">
                <h3 id="modalTitle">Metric Title</h3>
                <button class="modal-close" onclick="closeModal()">×</button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Content populated by JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // EMBEDDED CSV DATA
        const csvData = `Period,Revenue,GrossProfit,GrossMargin,EBITDA,EBIT,NetProfitBeforeTax,NetProfit,NetMargin,EPS,OperatingCashFlow,TotalAssets,TotalLiabilities,TotalEquity,TotalDebt,NetDebt,CashAndEquivalents,SharesOutstanding,KiwifruitTraysNZ,DividendPerShare
FY2015,142112,23725,16.7,13925,7208,5246,4272,3.0,0.29,1804,164318,93499,70819,54152,52960,1192,14.7,,0.18
H1-2016,134243,21478,16.0,15844,12059,10389,7121,5.3,0.45,,,,,,,,,,
FY2016,191317,33434,17.5,24764,16958,13612,10385,5.4,0.65,21252,197309,111998,85311,74445,72757,1688,15.8,32.4,0.20
H1-2017,150591,23698,15.7,18215,14471,12699,8752,5.8,0.54,,,,,,,,25.7,,
FY2017,186814,35277,18.9,23128,13689,9908,5833,3.1,0.34,14058,222023,123398,98625,85510,83121,2389,17.2,25.7,0.22
H1-2018,161181,31893,19.8,26408,21265,19192,13327,8.3,0.78,,,,,,,,28.4,,
FY2018,203713,45757,22.5,33301,17326,9871,6651,3.3,0.33,16787,269806,116430,153376,80400,79060,1340,20.2,28.4,0.24
H1-2019,169872,34533,20.3,27906,20314,16539,15448,9.1,0.49,,,,,,,,30.0,,
FY2019,236868,47464,20.0,34519,17557,9863,6884,2.9,0.22,16370,354944,200000,154944,86013,83164,2849,31.4,30.0,0.24
H1-2020,178681,37717,21.1,30435,21419,17394,18439,10.3,0.63,,,416317,242689,173628,,,,33.4,,
FY2020,251457,52676,20.9,42946,24318,16278,15151,6.0,0.52,26353,373748,197455,176293,83164,78000,5164,29.1,33.4,0.24
H1-2021,224479,60139,26.8,46894,34700,30761,27402,12.2,0.78,,,,,,,,35.1,,
FY2021,309569,73232,23.7,56790,32180,23488,14860,4.8,0.43,41584,482269,235778,246491,158861,146500,12361,35.2,39.2,0.26
H1-2022,247345,61966,25.0,49360,35396,30065,22955,9.3,0.55,,,594364,318753,275611,,,,40.1,,
FY2022,348387,68309,19.6,46079,19086,7593,6504,1.9,0.16,12128,547869,276926,270943,175554,172000,3554,41.3,42.0,
H1-2023,238027,40823,17.2,31109,23948,19993,14089,5.9,0.34,,,,,,,,41.0,,
FY2023,300920,48726,16.2,25988,-4118,-20988,-14466,-4.8,-0.35,2671,548811,288862,259949,177583,172376,5207,41.6,29.8,
H1-2024,284196,79040,27.8,68384,54544,45006,17052,6.0,0.41,,,,,,,,,43.0,
FY2024,411412,104927,25.5,76121,46816,29713,8751,2.1,0.21,66037,549862,283459,266403,139890,136907,2983,41.6,43.0,0.15
H1-2025,307903,96813,31.4,83480,67302,59369,37769,12.3,0.90,,,,130600,,,41.6,47.1,`;

        // EMBEDDED ANALYSIS JSON
        const analysis = {"ticker":"SEK.NZ","company_name":"Seeka Limited","analysis_date":"2026-02-03","overview":"Seeka Limited is New Zealand and Australia's largest fully integrated kiwifruit supply company, providing orcharding, post-harvest packing, coolstorage, and retail services across the fresh produce industry. Headquartered in Te Puke, New Zealand, Seeka operates 12 post-harvest facilities, grows kiwifruit on approximately 1,000 hectares, and handles approximately 21% of New Zealand's kiwifruit post-harvest market, servicing Zespri (the global kiwifruit marketer) and directly supplying large-format retailers in Australia, Asia, and New Zealand.","business_model":{"summary":"Highly seasonal fee-for-service business model with revenue concentrated in H1 (January-June harvest period). Post-harvest operations generate ~60% of revenue through per-tray packing and coolstorage fees. Orcharding provides ~25% of revenue through orchard management fees and profit-sharing on leased orchards. Model benefits from operational leverage as volumes increase.","revenue_streams":[{"name":"Post-harvest (packing & coolstorage)","percent":60,"trend":"stable"},{"name":"Orcharding (management & leased orchards)","percent":25,"trend":"growing"},{"name":"SeekaFresh retail services","percent":8,"trend":"growing"},{"name":"Australia operations","percent":5,"trend":"growing"},{"name":"Other (avocado oil, Kiwi Crush)","percent":2,"trend":"stable"}]},"guidance":{"as_of":"H1 2025 Results (August 2025) - Updated Guidance","fiscal_year":"FY2025 (year ending December 2025)","items":[{"metric":"Net Profit Before Tax","target":"$44.0-48.0M","period":"FY2025","vs_prior":"raised","notes":"Strong H1 result ($59.4M NPBT for 6 months) supports increased full-year guidance. Significantly above FY2024's $29.7M. Upgraded guidance reflects higher volumes and operational excellence."},{"metric":"NZ Kiwifruit Volumes","target":"~47-50M trays (implied from H1 results)","period":"FY2025","vs_prior":"raised","notes":"H1 2025 packed 47.1M trays (up 10% vs H1 2024's 43.0M). Full year depends on H2 orcharding/export activity but volumes trending positive. Capacity exists for >50M trays."},{"metric":"Net Bank Debt","target":"Further reduction expected","period":"FY2025","vs_prior":"maintained","notes":"Net debt $130.6M at June 2025 (down $40.2M YoY from $170.9M). Additional $64.8M banked in July 2025, suggesting continued strong deleveraging focus and cash generation."},{"metric":"Dividend","target":"$0.15 per share (October 2025 payment announced)","period":"H1 2025","vs_prior":"maintained","notes":"Total H1 2025 dividends of $0.30/share ($0.10 Jan + $0.05 Apr + $0.15 Oct) vs $0.15 total for full FY2024. Fully imputed, dividend reinvestment plan applies with 2% discount to VWAP."},{"metric":"2026 Crop Outlook","target":"Good winter chill, positive early indicators","period":"2026 season","vs_prior":"new","notes":"Management noted 2025 winter chill in most regions better than prior year, lifting probability of good 2026 kiwifruit season. Too early for specific volume forecast but early indicators positive."},{"metric":"Zespri Industry Forecast","target":"205-215M trays for 2025/26 season","period":"2025/26 season","vs_prior":"new","notes":"Zespri forecasting record season with strong per-tray returns for all fruit groups (Green, SunGold, Organic, RubyRed). Additional 400 hectares SunGold license releasing in 2026. Long-term target of 236M trays by 2030."}],"management_commentary":"Management stated strong interim result reflects higher volumes and successful execution of strategy to lift performance. Expect FY2025 NPBT of $44-48M (raised from $35-39M). Seeka operates in seasonal industry with significant H1 earnings weighting (~70-80% of annual profit). 2026 crop early indicators positive with better winter chill than same point 2024, though too early for reliable prediction. Focus remains on gradual debt reduction, operational excellence, and automation investments to drive efficiency gains. New Reemoon technology at Kerikeri and Huka Pak will deliver step change in capacity and unit economics for 2026 season."}};

        // EMBEDDED DCF JSON
        const dcfData = {"ticker":"SEK.NZ","company_name":"Seeka Limited","valuation_date":"2026-01-21","current_price":4.65,"currency":"NZD","inputs":{"shares_outstanding":41.6,"total_debt":139.9,"cash_and_equivalents":3.0,"net_debt":136.9,"last_fcf":66.0,"last_revenue":411.4,"last_equity":266.4,"currency":"NZD","units":"millions","note":"Using FY2024 actual data. FCF approximated by Operating Cash Flow given minimal maintenance capex requirements post-automation investments."},"historical_growth":{"revenue_3yr_cagr":17.8,"revenue_5yr_cagr":13.1,"eps_3yr_cagr":-15.2,"eps_5yr_cagr":-16.4,"equity_3yr_cagr":5.6,"equity_5yr_cagr":8.6,"fcf_3yr_cagr":16.5,"fcf_5yr_cagr":20.2,"selected_growth_rate":8.6,"growth_rate_source":"equity_5yr_cagr","growth_rate_rationale":"Conservative value investing approach uses equity CAGR as primary metric. Equity growth of 8.6% more sustainable than revenue (13.1%) or FCF (20.2%) given cyclicality.","growth_divergence_warning":"Revenue CAGR (13.1%) and FCF CAGR (20.2%) significantly exceed Equity CAGR (8.6%), driven by cyclical recovery from FY2023 cyclone impact. Equity growth more conservative and appropriate given business volatility."},"assumptions":{"base":{"growth_rates":[12.0,10.0,8.0,6.0,4.0],"growth_rationale":"Start above equity CAGR (8.6%) reflecting strong industry tailwinds and H1-2025 momentum, then decelerate toward mature industry growth. Year 1: 12% reflects Zespri record season forecast. Years 2-5: gradual deceleration as industry matures.","fcf_margin":16.0,"fcf_margin_rationale":"FY2024 FCF/Revenue = 66.0/411.4 = 16.0%. Maintain this level assuming stable operations and minimal growth capex given existing 50m+ tray capacity.","wacc":11.0,"wacc_rationale":"Higher than typical 9-10% WACC given: cyclical volume volatility, weather/climate exposure, customer concentration (Zespri), NZ small-cap liquidity premium, and current net debt of 51% of equity.","terminal_growth":2.5,"terminal_growth_rationale":"Mature NZ kiwifruit industry with modest long-term expansion. Below NZ GDP growth (2.5-3%) given market saturation and cyclical nature."},"bull":{"growth_rates":[18.0,15.0,12.0,10.0,8.0],"growth_rationale":"Aggressive volume growth from Zespri 205-215m tray season, market share gains, Australian expansion accelerating, and automation driving margin improvement. Assumes strong execution and favorable weather.","fcf_margin":18.0,"fcf_margin_rationale":"Margin expansion from automation efficiencies (cost per tray down 19% in FY2024), operating leverage on higher volumes, and improved Australian profitability.","wacc":10.0,"wacc_rationale":"Lower risk premium as balance sheet improves with debt reduction, dividend re-established, and operational track record strengthens.","terminal_growth":3.0,"terminal_growth_rationale":"Industry continues moderate expansion beyond current forecasts, Seeka gains market share through consolidation, Australian operations become material contributor."},"bear":{"growth_rates":[5.0,3.0,2.0,1.0,0.0],"growth_rationale":"Weather impacts return (cyclone, water stress), volume volatility, automation investments underperform, Australian expansion disappoints, or competitive pressure from MPac/EastPack.","fcf_margin":14.0,"fcf_margin_rationale":"Margin compression from lower volumes hitting fixed cost base (FY2023 demonstrated downside), increased competition, wage inflation, or automation execution issues.","wacc":13.0,"wacc_rationale":"Higher risk premium reflecting volume volatility, climate/weather exposure, debt burden limiting flexibility, and execution risk on automation/Australian expansion.","terminal_growth":2.0,"terminal_growth_rationale":"Structural headwinds from climate change, mature industry, limited growth beyond current trajectory, or regulatory changes to Zespri model."}},"projections":{"base":{"years":["Y1 (2025)","Y2 (2026)","Y3 (2027)","Y4 (2028)","Y5 (2029)"],"revenue":[460.8,506.9,547.4,580.3,603.5],"fcf":[73.7,81.1,87.6,92.8,96.6],"discount_factors":[0.901,0.812,0.731,0.659,0.593],"pv_fcf":[66.4,65.9,64.0,61.1,57.3]},"bull":{"years":["Y1 (2025)","Y2 (2026)","Y3 (2027)","Y4 (2028)","Y5 (2029)"],"revenue":[485.5,558.3,625.3,687.8,742.8],"fcf":[87.4,100.5,112.6,123.8,133.7],"discount_factors":[0.909,0.826,0.751,0.683,0.621],"pv_fcf":[79.5,83.0,84.6,84.6,83.0]},"bear":{"years":["Y1 (2025)","Y2 (2026)","Y3 (2027)","Y4 (2028)","Y5 (2029)"],"revenue":[432.0,445.0,453.9,458.4,458.4],"fcf":[60.5,62.3,63.5,64.2,64.2],"discount_factors":[0.885,0.783,0.693,0.613,0.543],"pv_fcf":[53.5,48.8,44.0,39.4,34.8]}},"valuation":{"base":{"sum_pv_fcf":314.7,"terminal_value":1164.7,"pv_terminal":690.9,"enterprise_value":1005.6,"equity_value":868.7,"intrinsic_value":20.88,"upside":348.9},"bull":{"sum_pv_fcf":414.7,"terminal_value":1968.6,"pv_terminal":1222.8,"enterprise_value":1637.5,"equity_value":1500.6,"intrinsic_value":36.07,"upside":675.7},"bear":{"sum_pv_fcf":220.5,"terminal_value":595.9,"pv_terminal":323.5,"enterprise_value":544.0,"equity_value":407.1,"intrinsic_value":9.78,"upside":110.3}},"entry_price":{"base":{"terminal_value_per_share":27.99,"years_to_terminal":5,"entry_price":13.91,"entry_discount_from_current":199.1}},"entry_price_analysis":{"base":{"terminal_value_per_share":27.99,"years_to_terminal":5,"target_cagr":0.15,"entry_price":13.91,"entry_discount_from_current":199.1,"interpretation":"To achieve 15% annual returns from current price to terminal value, investor could enter at $13.91 (current price $4.65 offers 199% upside to this entry point)"},"bull":{"terminal_value_per_share":47.32,"years_to_terminal":5,"target_cagr":0.15,"entry_price":23.52,"entry_discount_from_current":405.8,"interpretation":"Bull case terminal value supports entry price of $23.52 for 15% CAGR"},"bear":{"terminal_value_per_share":14.32,"years_to_terminal":5,"target_cagr":0.15,"entry_price":7.12,"entry_discount_from_current":53.1,"interpretation":"Even in bear case, current price of $4.65 offers significant margin of safety to $7.12 entry price"}},"sensitivity":{"wacc_range":[9.0,10.0,11.0,12.0,13.0],"terminal_growth_range":[1.5,2.0,2.5,3.0,3.5],"matrix":[[30,33,36,40,45],[25,27,30,32,36],[21,23,25,27,29],[19,20,21,23,25],[16,17,18,20,21]]},"probability_weighted":{"weights":{"bull":0.25,"base":0.50,"bear":0.25},"weighted_iv":21.91}};

        // Parse CSV
        function parseCSV(csv) {
            const lines = csv.trim().split('\n');
            const headers = lines[0].split(',');
            return lines.slice(1).map(line => {
                const values = line.split(',');
                const obj = {};
                headers.forEach((h, i) => obj[h.trim()] = values[i]?.trim());
                return obj;
            });
        }

        const data = parseCSV(csvData);

        // Sort chronologically (oldest first)
        data.sort((a, b) => {
            const parseDate = (p) => {
                const year = parseInt(p.match(/\d{4}/)?.[0] || '0');
                const isQ1 = p.includes('Q1');
                const isQ2 = p.includes('Q2');
                const isQ3 = p.includes('Q3');
                const isQ4 = p.includes('Q4');
                const isH1 = p.includes('H1');
                const isH2 = p.includes('H2');
                const isFY = p.startsWith('FY');
                const subOrder = isQ1 ? 1 : isQ2 ? 2 : isH1 ? 3 : isQ3 ? 4 : isQ4 ? 5 : isH2 ? 6 : isFY ? 7 : 0;
                return year * 10 + subOrder;
            };
            return parseDate(a.Period) - parseDate(b.Period);
        });

        // Filter for FY and H1 data
        const fyData = data.filter(d => d.Period.startsWith('FY'));
        const allData = data; // Includes both FY and H1 for revenue/trays charts

        // Format currency (NZD)
        function formatNZD(value) {
            const num = parseFloat(value);
            if (isNaN(num)) return '-';
            if (Math.abs(num) >= 1000) return '$' + (num/1000).toFixed(1) + 'M';
            return '$' + num.toFixed(0) + 'K';
        }

        // YoY change calculation
        function calcYoYChange(current, previous) {
            if (!previous || !current || previous === '' || current === '') return null;
            const curr = parseFloat(current);
            const prev = parseFloat(previous);
            if (isNaN(curr) || isNaN(prev) || prev === 0) return null;
            return ((curr - prev) / Math.abs(prev) * 100).toFixed(1);
        }

        // Render KPI cards
        function renderKPIs() {
            const latest = fyData[fyData.length - 1];
            const previous = fyData[fyData.length - 2];

            const kpis = [
                {
                    label: 'Revenue',
                    value: formatNZD(latest.Revenue),
                    change: calcYoYChange(latest.Revenue, previous?.Revenue)
                },
                {
                    label: 'Gross Margin',
                    value: latest.GrossMargin + '%',
                    change: calcYoYChange(latest.GrossMargin, previous?.GrossMargin)
                },
                {
                    label: 'EBITDA',
                    value: formatNZD(latest.EBITDA),
                    change: calcYoYChange(latest.EBITDA, previous?.EBITDA)
                },
                {
                    label: 'Net Profit',
                    value: formatNZD(latest.NetProfit),
                    change: calcYoYChange(latest.NetProfit, previous?.NetProfit)
                },
                {
                    label: 'EPS',
                    value: '$' + parseFloat(latest.EPS).toFixed(2),
                    change: calcYoYChange(latest.EPS, previous?.EPS)
                },
                {
                    label: 'Kiwifruit Trays',
                    value: latest.KiwifruitTraysNZ + 'M',
                    change: calcYoYChange(latest.KiwifruitTraysNZ, previous?.KiwifruitTraysNZ)
                },
                {
                    label: 'Net Debt',
                    value: formatNZD(latest.NetDebt),
                    change: calcYoYChange(latest.NetDebt, previous?.NetDebt)
                },
                {
                    label: 'Dividend Per Share',
                    value: '$' + parseFloat(latest.DividendPerShare || 0).toFixed(2),
                    change: calcYoYChange(latest.DividendPerShare, previous?.DividendPerShare)
                }
            ];

            const grid = document.getElementById('kpiGrid');
            grid.innerHTML = kpis.map(kpi => {
                const changeClass = kpi.change ? (parseFloat(kpi.change) >= 0 ? 'positive' : 'negative') : '';
                const changeText = kpi.change ? (parseFloat(kpi.change) >= 0 ? '+' : '') + kpi.change + '% YoY' : '';

                // Special handling for Net Debt (lower is better)
                let displayChangeClass = changeClass;
                let displayChangeText = changeText;
                if (kpi.label === 'Net Debt' && kpi.change) {
                    displayChangeClass = parseFloat(kpi.change) < 0 ? 'positive' : 'negative';
                    displayChangeText = changeText + ' (reduced)';
                }

                return `
                    <div class="kpi-card">
                        <div class="kpi-value">${kpi.value}</div>
                        <div class="kpi-label">${kpi.label}</div>
                        ${displayChangeText ? `<div class="kpi-change ${displayChangeClass}">${displayChangeText}</div>` : ''}
                    </div>
                `;
            }).join('');
        }

        // Render guidance
        function renderGuidance() {
            if (!analysis.guidance || !analysis.guidance.items || analysis.guidance.items.length === 0) {
                document.getElementById('guidanceSection').style.display = 'none';
                return;
            }

            const guidance = analysis.guidance;
            document.getElementById('guidanceAsOf').textContent = guidance.as_of || '';
            document.getElementById('guidanceFY').textContent = guidance.fiscal_year || '';

            const grid = document.getElementById('guidanceGrid');
            grid.innerHTML = guidance.items.map(item => {
                const vsClass = item.vs_prior ? item.vs_prior.toLowerCase() : 'new';
                const vsLabel = item.vs_prior ? item.vs_prior.charAt(0).toUpperCase() + item.vs_prior.slice(1) : 'New';
                return `
                    <div class="guidance-card">
                        <div class="guidance-metric">${item.metric}</div>
                        <div class="guidance-target">${item.target}</div>
                        <div class="guidance-period">${item.period}</div>
                        <span class="guidance-vs-prior ${vsClass}">${vsLabel}</span>
                        ${item.notes ? `<div class="guidance-notes">${item.notes}</div>` : ''}
                    </div>
                `;
            }).join('');

            const commentary = document.getElementById('guidanceCommentary');
            if (guidance.management_commentary) {
                commentary.textContent = guidance.management_commentary;
                commentary.style.display = 'block';
            } else {
                commentary.style.display = 'none';
            }
        }

        // Toggle overview
        function toggleOverview() {
            const btn = document.querySelector('.overview-toggle');
            const content = document.getElementById('overviewContent');
            btn.classList.toggle('active');
            content.classList.toggle('active');
        }

        // Chart defaults
        const chartDefaults = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { labels: { color: '#e0e0e0', font: { size: 11 } } }
            },
            scales: {
                x: { ticks: { color: '#888' }, grid: { color: 'rgba(255,255,255,0.05)' } },
                y: { ticks: { color: '#888' }, grid: { color: 'rgba(255,255,255,0.05)' } }
            }
        };

        const colors = {
            primary: '#00d4aa',
            secondary: '#00b894',
            tertiary: '#0984e3',
            quaternary: '#6c5ce7',
            warning: '#fdcb6e',
            danger: '#ff6b6b'
        };

        // Revenue Chart (include H1 data)
        new Chart(document.getElementById('revenueChart'), {
            type: 'bar',
            data: {
                labels: allData.map(d => d.Period),
                datasets: [{
                    label: 'Revenue (NZD 000s)',
                    data: allData.map(d => parseFloat(d.Revenue || 0)),
                    backgroundColor: allData.map(d => d.Period.startsWith('FY') ? colors.primary : 'rgba(0, 212, 170, 0.5)'),
                    borderColor: colors.primary,
                    borderWidth: 1
                }]
            },
            options: chartDefaults
        });

        // Profitability Chart
        new Chart(document.getElementById('profitabilityChart'), {
            type: 'line',
            data: {
                labels: fyData.map(d => d.Period),
                datasets: [
                    {
                        label: 'Gross Profit',
                        data: fyData.map(d => parseFloat(d.GrossProfit || 0)),
                        borderColor: colors.primary,
                        backgroundColor: 'transparent',
                        tension: 0.3
                    },
                    {
                        label: 'EBITDA',
                        data: fyData.map(d => parseFloat(d.EBITDA || 0)),
                        borderColor: colors.secondary,
                        backgroundColor: 'transparent',
                        tension: 0.3
                    },
                    {
                        label: 'EBIT',
                        data: fyData.map(d => parseFloat(d.EBIT || 0)),
                        borderColor: colors.tertiary,
                        backgroundColor: 'transparent',
                        tension: 0.3
                    },
                    {
                        label: 'Net Profit',
                        data: fyData.map(d => parseFloat(d.NetProfit || 0)),
                        borderColor: colors.quaternary,
                        backgroundColor: 'transparent',
                        tension: 0.3
                    }
                ]
            },
            options: chartDefaults
        });

        // Kiwifruit Trays Chart (include H1 data)
        const traysData = allData.filter(d => d.KiwifruitTraysNZ && d.KiwifruitTraysNZ !== '');
        new Chart(document.getElementById('traysChart'), {
            type: 'bar',
            data: {
                labels: traysData.map(d => d.Period),
                datasets: [{
                    label: 'Kiwifruit Trays (Millions)',
                    data: traysData.map(d => parseFloat(d.KiwifruitTraysNZ || 0)),
                    backgroundColor: traysData.map(d => d.Period.startsWith('FY') ? colors.secondary : 'rgba(0, 184, 148, 0.5)'),
                    borderColor: colors.secondary,
                    borderWidth: 1
                }]
            },
            options: chartDefaults
        });

        // Margins Chart
        new Chart(document.getElementById('marginsChart'), {
            type: 'line',
            data: {
                labels: fyData.map(d => d.Period),
                datasets: [
                    {
                        label: 'Gross Margin (%)',
                        data: fyData.map(d => parseFloat(d.GrossMargin || 0)),
                        borderColor: colors.primary,
                        backgroundColor: 'transparent',
                        tension: 0.3,
                        yAxisID: 'y'
                    },
                    {
                        label: 'Net Margin (%)',
                        data: fyData.map(d => parseFloat(d.NetMargin || 0)),
                        borderColor: colors.tertiary,
                        backgroundColor: 'transparent',
                        tension: 0.3,
                        yAxisID: 'y'
                    }
                ]
            },
            options: {
                ...chartDefaults,
                scales: {
                    ...chartDefaults.scales,
                    y: {
                        ...chartDefaults.scales.y,
                        title: { display: true, text: 'Margin (%)', color: '#888' }
                    }
                }
            }
        });

        // Operating Cash Flow Chart
        const cashflowData = fyData.filter(d => d.OperatingCashFlow && d.OperatingCashFlow !== '');
        new Chart(document.getElementById('cashflowChart'), {
            type: 'bar',
            data: {
                labels: cashflowData.map(d => d.Period),
                datasets: [{
                    label: 'Operating Cash Flow (NZD 000s)',
                    data: cashflowData.map(d => parseFloat(d.OperatingCashFlow || 0)),
                    backgroundColor: colors.tertiary,
                    borderColor: colors.tertiary,
                    borderWidth: 1
                }]
            },
            options: chartDefaults
        });

        // Balance Sheet Chart
        const balanceData = fyData.filter(d => d.TotalAssets && d.TotalAssets !== '');
        new Chart(document.getElementById('balancesheetChart'), {
            type: 'bar',
            data: {
                labels: balanceData.map(d => d.Period),
                datasets: [
                    {
                        label: 'Total Assets',
                        data: balanceData.map(d => parseFloat(d.TotalAssets || 0)),
                        backgroundColor: colors.primary,
                        borderColor: colors.primary,
                        borderWidth: 1
                    },
                    {
                        label: 'Total Equity',
                        data: balanceData.map(d => parseFloat(d.TotalEquity || 0)),
                        backgroundColor: colors.secondary,
                        borderColor: colors.secondary,
                        borderWidth: 1
                    },
                    {
                        label: 'Total Debt',
                        data: balanceData.map(d => parseFloat(d.TotalDebt || 0)),
                        backgroundColor: colors.danger,
                        borderColor: colors.danger,
                        borderWidth: 1
                    }
                ]
            },
            options: chartDefaults
        });

        // Net Debt Chart
        const netDebtData = fyData.filter(d => d.NetDebt && d.NetDebt !== '');
        new Chart(document.getElementById('netdebtChart'), {
            type: 'line',
            data: {
                labels: netDebtData.map(d => d.Period),
                datasets: [{
                    label: 'Net Debt (NZD 000s)',
                    data: netDebtData.map(d => parseFloat(d.NetDebt || 0)),
                    borderColor: colors.warning,
                    backgroundColor: 'rgba(253, 203, 110, 0.1)',
                    fill: true,
                    tension: 0.3
                }]
            },
            options: chartDefaults
        });

        // EPS Chart
        new Chart(document.getElementById('epsChart'), {
            type: 'line',
            data: {
                labels: fyData.map(d => d.Period),
                datasets: [{
                    label: 'EPS ($)',
                    data: fyData.map(d => parseFloat(d.EPS || 0)),
                    borderColor: colors.quaternary,
                    backgroundColor: 'rgba(108, 92, 231, 0.1)',
                    fill: true,
                    tension: 0.3
                }]
            },
            options: chartDefaults
        });

        // Revenue vs Gross Profit Chart
        new Chart(document.getElementById('revenuevsgpChart'), {
            type: 'bar',
            data: {
                labels: fyData.map(d => d.Period),
                datasets: [
                    {
                        label: 'Revenue',
                        data: fyData.map(d => parseFloat(d.Revenue || 0)),
                        backgroundColor: colors.primary,
                        borderColor: colors.primary,
                        borderWidth: 1
                    },
                    {
                        label: 'Gross Profit',
                        data: fyData.map(d => parseFloat(d.GrossProfit || 0)),
                        backgroundColor: colors.secondary,
                        borderColor: colors.secondary,
                        borderWidth: 1
                    }
                ]
            },
            options: chartDefaults
        });

        // Dividends Chart
        const dividendData = fyData.filter(d => d.DividendPerShare && d.DividendPerShare !== '');
        new Chart(document.getElementById('dividendsChart'), {
            type: 'bar',
            data: {
                labels: dividendData.map(d => d.Period),
                datasets: [{
                    label: 'Dividends Per Share ($)',
                    data: dividendData.map(d => parseFloat(d.DividendPerShare || 0)),
                    backgroundColor: colors.primary,
                    borderColor: colors.primary,
                    borderWidth: 1
                }]
            },
            options: chartDefaults
        });

        // Metric descriptions (Seeka-specific)
        const metricDescriptions = {
            revenue: {
                title: "Revenue",
                content: `
                    <p><strong>Revenue</strong> is Seeka's total income from post-harvest packing, coolstorage, orcharding, and retail services.</p>
                    <div class="metric-highlight">
                        <strong>For Seeka:</strong> Revenue is highly seasonal, with 70-80% generated in H1 (January-June harvest period). Post-harvest packing (~60% of revenue) is fee-for-service based on trays packed. Orcharding (~25%) includes orchard management fees and profit-sharing on leased orchards.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Kiwifruit trays packed - primary volume driver (43.0M trays in FY2024, up from 29.8M in FY2023)</li>
                        <li>Cost per tray - Seeka's automation investments reduced cost per tray by 19% in FY2024</li>
                        <li>Zespri's industry forecasts - Zespri projects 205-215M trays for 2025/26 season (10% growth by 2030)</li>
                        <li>H1 vs FY ratio - typically 70-80% of annual revenue comes in H1 harvest period</li>
                    </ul>
                `
            },
            profitability: {
                title: "Profitability Metrics",
                content: `
                    <p><strong>Profitability metrics</strong> show Seeka's ability to convert revenue into profit at different stages of the income statement.</p>
                    <div class="metric-highlight">
                        <strong>For Seeka:</strong> High operating leverage means profitability is extremely sensitive to volume. FY2023 (29.8M trays) generated $21M loss, while FY2024 (43.0M trays) generated $29.7M NPBT. H1 2025 delivered $59.4M NPBT on 47.1M trays, demonstrating earnings power at higher volumes.
                    </div>
                    <p><strong>Key metrics:</strong></p>
                    <ul>
                        <li><strong>Gross Profit:</strong> Revenue minus direct costs. Watch gross margin trend (25.5% in FY2024, up from 16.2% in FY2023)</li>
                        <li><strong>EBITDA:</strong> Earnings before interest, tax, depreciation, amortization - best measure of operating performance</li>
                        <li><strong>EBIT:</strong> Operating profit after depreciation - watch for asset write-downs</li>
                        <li><strong>Net Profit:</strong> Bottom line after all costs. Note FY2024 had $20.5M deferred tax charge reducing net profit</li>
                    </ul>
                `
            },
            trays: {
                title: "Kiwifruit Trays Packed",
                content: `
                    <p><strong>Kiwifruit trays packed</strong> is Seeka's primary volume metric, measuring millions of trays processed through post-harvest facilities.</p>
                    <div class="metric-highlight">
                        <strong>For Seeka:</strong> This is the single most important operational metric. Seeka has ~21% market share of NZ kiwifruit post-harvest (43.0M trays in FY2024 out of ~200M industry total). Capacity exists for >50M trays without major capex. Each 1M tray swing materially impacts profitability due to high fixed costs.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Year-over-year volume trends - FY2024 43.0M trays vs FY2023 29.8M (44% increase drove recovery)</li>
                        <li>Industry total vs Seeka's share - Zespri forecasts 205-215M trays for 2025/26 season</li>
                        <li>H1 volumes as early indicator - H1 2025 delivered record 47.1M trays</li>
                        <li>Weather impacts - cyclone Gabrielle caused 38% yield losses in some regions in 2023</li>
                        <li>Automation efficiency - new Reemoon technology at Kerikeri and Huka Pak will increase throughput for 2026</li>
                    </ul>
                `
            },
            margins: {
                title: "Margin Analysis",
                content: `
                    <p><strong>Margins</strong> show what percentage of revenue converts to profit at different stages.</p>
                    <div class="metric-highlight">
                        <strong>For Seeka:</strong> Margins are highly cyclical and volume-dependent. Gross margin peaked at 31.4% in H1-2025 vs trough of 16.2% in FY2023. Net margin swung from -4.8% (FY2023 loss) to +2.1% (FY2024) to +12.3% (H1-2025). Operating leverage from high fixed costs means margins expand significantly at higher volumes.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Gross margin expansion from automation - cost per tray down 19% in FY2024</li>
                        <li>Operating leverage at scale - NPBT margin reached 19.3% in H1-2025 vs 15.8% in H1-2024</li>
                        <li>Impact of low-volume years - FY2023 showed -4.8% net margin on 29.8M trays</li>
                        <li>Seasonal patterns - H1 margins typically higher than full-year due to harvest concentration</li>
                    </ul>
                `
            },
            cashflow: {
                title: "Operating Cash Flow",
                content: `
                    <p><strong>Operating Cash Flow</strong> measures actual cash generated from business operations, excluding financing and investing activities.</p>
                    <div class="metric-highlight">
                        <strong>For Seeka:</strong> OCF is the truest measure of cash-generating ability. FY2024 delivered record $66.0M OCF (16% of revenue), enabling $35.1M debt reduction and dividend resumption. Highly seasonal with most cash generated in H1. Used as FCF proxy in DCF valuation given minimal maintenance capex post-automation investments.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>OCF conversion from EBITDA - FY2024 OCF of $66.0M vs EBITDA of $76.1M = 87% conversion</li>
                        <li>Working capital swings - seasonal business requires significant H1 working capital for labor</li>
                        <li>Debt reduction capacity - FY2024 reduced net debt by $35.1M to $136.9M</li>
                        <li>Dividend sustainability - FY2024 resumed dividends ($0.15/share) with strong OCF coverage</li>
                        <li>Capex requirements - automation investments front-loaded; minimal maintenance capex needed</li>
                    </ul>
                `
            },
            balancesheet: {
                title: "Balance Sheet Overview",
                content: `
                    <p><strong>Balance Sheet</strong> shows Seeka's assets (what it owns), liabilities (what it owes), and equity (net worth).</p>
                    <div class="metric-highlight">
                        <strong>For Seeka:</strong> Total Assets of $549.9M include $388.3M in PP&E (post-harvest facilities, orchards, equipment). Total Equity of $266.4M (book value $6.40/share) vs market cap of ~$193M indicates stock trades at 0.76x P/B. Net debt of $136.9M = 51% of equity (improved from $172.4M in FY2023).
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Price-to-Book ratio - currently 0.76x suggests market skepticism about asset values or earnings quality</li>
                        <li>Leverage ratio - improved to 1.57:1 (June 2025) from distressed levels post-FY2023</li>
                        <li>PP&E growth - watch for impairments or sale-leaseback (Turanga Whetu marketed for sale-leaseback)</li>
                        <li>Goodwill ($20.2M) - watch for impairment if volumes/profitability disappoints</li>
                        <li>Working capital adequacy - credit facility headroom improved to $61.1M from $23.2M</li>
                    </ul>
                `
            },
            netdebt: {
                title: "Net Debt Trend",
                content: `
                    <p><strong>Net Debt</strong> is total debt minus cash and equivalents, showing Seeka's net borrowing position.</p>
                    <div class="metric-highlight">
                        <strong>For Seeka:</strong> Net debt reduction is critical strategic priority. Declined from $172.4M (FY2023) to $136.9M (FY2024) to $130.6M (June 2025 H1) - total reduction of $41.8M over 18 months. Additional $64.8M banked in July 2025. Leverage ratio improved to 1.57:1. Finance expenses of $17.1M in FY2024 consume 35-57% of normalized NPBT.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Deleveraging pace - target to continue gradual reduction from strong OCF generation</li>
                        <li>Covenant headroom - past covenant pressures limited dividends; now comfortable</li>
                        <li>Interest rate sensitivity - $130.6M debt means rate movements materially impact finance costs</li>
                        <li>Balance with growth capex - Australian expansion ($17.2M) and automation compete with debt reduction</li>
                        <li>Debt/Equity ratio - currently 51% vs peak ~66% in FY2023 crisis</li>
                    </ul>
                `
            },
            eps: {
                title: "EPS Trend",
                content: `
                    <p><strong>EPS (Earnings Per Share)</strong> is net profit divided by shares outstanding, showing per-share profitability.</p>
                    <div class="metric-highlight">
                        <strong>For Seeka:</strong> EPS is highly volatile due to cyclical volumes and one-time items. FY2024 EPS of $0.21 understates true earnings due to $20.5M deferred tax charge; adjusted EPS ~$0.51. H1-2025 delivered $0.90 EPS (annualized ~$1.80), demonstrating earnings power at higher volumes. Historical range: -$0.35 (FY2023 loss) to +$0.78 (H1-2021 peak).
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Normalized EPS vs reported - adjust for tax timing and one-time items</li>
                        <li>Volume sensitivity - EPS swings dramatically with tray volumes (operating leverage)</li>
                        <li>P/E ratio assessment - current price $4.65 vs normalized earnings $0.40-0.50 = ~10x P/E</li>
                        <li>H1 as indicator - H1 EPS typically 70-80% of full-year due to seasonal concentration</li>
                        <li>Dividend coverage - FY2024 $0.15 DPS vs $0.21 EPS = 71% payout (conservative given recent crisis)</li>
                    </ul>
                `
            },
            revenuevsgp: {
                title: "Revenue vs Gross Profit",
                content: `
                    <p><strong>Revenue vs Gross Profit</strong> shows the relationship between total revenue and gross profit (revenue minus direct costs).</p>
                    <div class="metric-highlight">
                        <strong>For Seeka:</strong> Gross profit margin expanded from 16.2% (FY2023) to 25.5% (FY2024) to 31.4% (H1-2025) as volumes recovered and automation reduced cost per tray by 19%. Gap between revenue and gross profit shows cost of goods sold (labor, packaging, electricity, coolstorage operations). Margin expansion demonstrates operating leverage.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Gross margin trend - watch for continued margin expansion from automation efficiencies</li>
                        <li>Volume impact on margins - higher volumes spread fixed costs over more trays</li>
                        <li>Cost per tray trajectory - automation investments target further reductions</li>
                        <li>Labor cost inflation - largest COGS component; RSE worker availability critical</li>
                        <li>Electricity costs - significant for coolstorage operations; volatile NZ electricity market</li>
                    </ul>
                `
            },
            dividends: {
                title: "Dividends Per Share",
                content: `
                    <p><strong>Dividends Per Share</strong> is the total dividend payment distributed to shareholders per share owned.</p>
                    <div class="metric-highlight">
                        <strong>For Seeka:</strong> Dividends suspended after FY2022 due to covenant pressures from FY2023 crisis. Resumed in FY2024 with $0.15/share total ($0.10 Jan 2025 + $0.05 Apr 2025). H1-2025 delivered $0.30/share ($0.10 Jan + $0.05 Apr + $0.15 Oct 2025 announced). Fully imputed, dividend reinvestment plan available with 2% discount. Current yield ~4.3%.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Dividend sustainability - payout ratio of ~50-70% of normalized earnings appears sustainable</li>
                        <li>Growth trajectory - H1-2025 $0.30 annualized vs FY2024 $0.15 shows strong recovery</li>
                        <li>Covenant headroom - improved leverage ratio removes dividend constraints</li>
                        <li>Balance with debt reduction - management targeting gradual deleveraging while resuming returns</li>
                        <li>Historical comparison - pre-crisis dividends ranged $0.20-0.26/share (FY2015-FY2021)</li>
                    </ul>
                `
            }
        };

        // Modal functions
        function openModal(key) {
            document.getElementById('modalTitle').textContent = metricDescriptions[key].title;
            document.getElementById('modalBody').innerHTML = metricDescriptions[key].content;
            document.getElementById('modalOverlay').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(event) {
            if (event && event.target !== document.getElementById('modalOverlay')) return;
            document.getElementById('modalOverlay').classList.remove('active');
            document.body.style.overflow = '';
        }

        document.addEventListener('keydown', e => { if (e.key === 'Escape') closeModal(); });

        // DCF Functions
        let currentScenario = 'base';

        function initDCF() {
            if (!dcfData || !dcfData.valuation) return;

            document.getElementById('dcfCurrent').textContent = '$' + dcfData.current_price.toFixed(2);

            if (dcfData.historical_growth.growth_divergence_warning) {
                document.getElementById('growthWarning').style.display = 'flex';
                document.getElementById('warningText').textContent = dcfData.historical_growth.growth_divergence_warning;
            }

            const base = dcfData.assumptions.base;
            document.getElementById('growthSlider').value = dcfData.assumptions.base.growth_rates[0];
            document.getElementById('waccSlider').value = base.wacc;
            document.getElementById('terminalSlider').value = base.terminal_growth;

            document.getElementById('growthValue').textContent = dcfData.assumptions.base.growth_rates[0] + '%';
            document.getElementById('waccValue').textContent = base.wacc + '%';
            document.getElementById('terminalValue').textContent = base.terminal_growth + '%';

            document.getElementById('growthHint').textContent = 'Based on industry growth and momentum';

            renderDCFInputs();
            renderHistoricalGrowth();
            renderSensitivityMatrix();
            updateDCFDisplay();
            switchScenario('base');
        }

        function renderDCFInputs() {
            const inputs = dcfData.inputs;
            const currency = '$';

            const formatNum = (n) => {
                if (Math.abs(n) >= 1000) return currency + (n/1000).toFixed(1) + 'B';
                return currency + n.toFixed(0) + 'M';
            };

            document.getElementById('baseFCF').textContent = formatNum(inputs.last_fcf);

            const shares = inputs.shares_outstanding;
            document.getElementById('sharesOut').textContent = shares.toFixed(1) + 'M';

            const netDebt = inputs.net_debt;
            const netDebtEl = document.getElementById('netDebt');
            netDebtEl.textContent = formatNum(netDebt);

            renderFCFProjections();
        }

        function renderFCFProjections() {
            const startGrowth = parseFloat(document.getElementById('growthSlider')?.value || dcfData.assumptions.base.growth_rates[0]);
            const baseFCF = dcfData.inputs.last_fcf;
            const currency = '$';

            const formatFCF = (n) => {
                if (Math.abs(n) >= 1000) return currency + (n/1000).toFixed(1) + 'B';
                return currency + n.toFixed(0) + 'M';
            };

            const endGrowth = 10;
            const growthRates = [];
            for (let i = 0; i < 5; i++) {
                const rate = startGrowth > endGrowth
                    ? startGrowth - (startGrowth - endGrowth) * (i / 4)
                    : startGrowth;
                growthRates.push(rate);
            }

            let fcf = baseFCF;
            const fcfValues = [baseFCF];

            for (let i = 0; i < 5; i++) {
                fcf = fcf * (1 + growthRates[i] / 100);
                fcfValues.push(fcf);
            }

            let html = `
                <div class="fcf-projection-item header">Base</div>
                <div class="fcf-projection-item header">Year 1</div>
                <div class="fcf-projection-item header">Year 2</div>
                <div class="fcf-projection-item header">Year 3</div>
                <div class="fcf-projection-item header">Year 4</div>
                <div class="fcf-projection-item header">Year 5</div>
            `;

            html += `<div class="fcf-projection-item">
                <div class="fcf-value">${formatFCF(fcfValues[0])}</div>
                <div class="growth-rate">-</div>
            </div>`;

            for (let i = 1; i <= 5; i++) {
                html += `<div class="fcf-projection-item">
                    <div class="fcf-value">${formatFCF(fcfValues[i])}</div>
                    <div class="growth-rate">+${growthRates[i-1].toFixed(0)}%</div>
                </div>`;
            }

            document.getElementById('fcfProjectionTable').innerHTML = html;
        }

        function calculateDCF(startGrowth, wacc, terminalGrowth) {
            const years = 5;
            const fcf = dcfData.inputs.last_fcf;
            let pvFCF = 0;
            let projectedFCF = fcf;

            const endGrowth = 10;

            for (let i = 0; i < years; i++) {
                const yearGrowth = startGrowth > endGrowth
                    ? startGrowth - (startGrowth - endGrowth) * (i / 4)
                    : startGrowth;
                projectedFCF *= (1 + yearGrowth / 100);
                pvFCF += projectedFCF / Math.pow(1 + wacc/100, i + 1);
            }

            const terminalFCF = projectedFCF * (1 + terminalGrowth/100);
            const terminalValue = terminalFCF / (wacc/100 - terminalGrowth/100);
            const pvTerminal = terminalValue / Math.pow(1 + wacc/100, years);

            const enterpriseValue = pvFCF + pvTerminal;
            const equityValue = enterpriseValue - dcfData.inputs.net_debt;
            const iv = equityValue / dcfData.inputs.shares_outstanding;

            const terminalPerShare = terminalValue / dcfData.inputs.shares_outstanding;
            const entryPrice = terminalPerShare / Math.pow(1.15, years);

            return {
                iv: iv,
                entryPrice: entryPrice,
                terminalPerShare: terminalPerShare,
                pvFCF: pvFCF,
                pvTerminal: pvTerminal,
                enterpriseValue: enterpriseValue
            };
        }

        window.updateDCFDisplay = function() {
            const growth = parseFloat(document.getElementById('growthSlider').value);
            const wacc = parseFloat(document.getElementById('waccSlider').value);
            const terminal = parseFloat(document.getElementById('terminalSlider').value);

            document.getElementById('growthValue').textContent = growth + '%';
            document.getElementById('waccValue').textContent = wacc + '%';
            document.getElementById('terminalValue').textContent = terminal + '%';

            renderFCFProjections();

            const result = calculateDCF(growth, wacc, terminal);

            document.getElementById('dcfIV').textContent = '$' + result.iv.toFixed(2);
            document.getElementById('dcfEntry').textContent = '$' + result.entryPrice.toFixed(2);

            const upside = ((result.iv - dcfData.current_price) / dcfData.current_price * 100);
            const upsideEl = document.getElementById('dcfUpside');
            upsideEl.textContent = (upside >= 0 ? '+' : '') + upside.toFixed(0) + '% ' + (upside >= 0 ? 'upside' : 'downside');
            upsideEl.className = 'dcf-change ' + (upside >= 0 ? 'positive' : 'negative');

            document.getElementById('dcfWeighted').textContent = '$' + dcfData.probability_weighted.weighted_iv.toFixed(2);

            const grid = document.getElementById('assumptionGrid');
            if (grid) {
                grid.innerHTML = `
                    <div class="assumption-item">
                        <div class="label">Growth Rate</div>
                        <div class="value">${growth}%</div>
                    </div>
                    <div class="assumption-item">
                        <div class="label">WACC</div>
                        <div class="value">${wacc}%</div>
                    </div>
                    <div class="assumption-item">
                        <div class="label">Terminal Growth</div>
                        <div class="value">${terminal}%</div>
                    </div>
                    <div class="assumption-item">
                        <div class="label">Intrinsic Value</div>
                        <div class="value" style="color: #00d4aa;">$${result.iv.toFixed(2)}</div>
                    </div>
                    <div class="assumption-item">
                        <div class="label">Entry Price</div>
                        <div class="value" style="color: #00d4aa;">$${result.entryPrice.toFixed(2)}</div>
                    </div>
                `;
            }
        };

        window.switchScenario = function(scenario) {
            currentScenario = scenario;

            document.querySelectorAll('.scenario-tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.scenario === scenario);
            });

            const assumptions = dcfData.assumptions[scenario];
            const valuation = dcfData.valuation[scenario];

            document.getElementById('growthSlider').value = assumptions.growth_rates[0];
            document.getElementById('waccSlider').value = assumptions.wacc;
            document.getElementById('terminalSlider').value = assumptions.terminal_growth;

            const grid = document.getElementById('assumptionGrid');
            grid.innerHTML = `
                <div class="assumption-item">
                    <div class="label">Year 1 Growth</div>
                    <div class="value">${assumptions.growth_rates[0]}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">Year 5 Growth</div>
                    <div class="value">${assumptions.growth_rates[4]}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">FCF Margin</div>
                    <div class="value">${assumptions.fcf_margin}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">WACC</div>
                    <div class="value">${assumptions.wacc}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">Terminal Growth</div>
                    <div class="value">${assumptions.terminal_growth}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">Intrinsic Value</div>
                    <div class="value" style="color: #00d4aa;">$${valuation.intrinsic_value.toFixed(2)}</div>
                </div>
            `;

            updateDCFDisplay();
        };

        function renderHistoricalGrowth() {
            const growth = dcfData.historical_growth;
            const selectedSource = growth.growth_rate_source;
            const grid = document.getElementById('growthGrid');

            const metrics = [
                { key: 'revenue_3yr_cagr', label: 'Revenue 3Y' },
                { key: 'revenue_5yr_cagr', label: 'Revenue 5Y' },
                { key: 'eps_3yr_cagr', label: 'EPS 3Y' },
                { key: 'eps_5yr_cagr', label: 'EPS 5Y' },
                { key: 'equity_3yr_cagr', label: 'Equity 3Y' },
                { key: 'equity_5yr_cagr', label: 'Equity 5Y' },
                { key: 'fcf_3yr_cagr', label: 'FCF 3Y' },
                { key: 'fcf_5yr_cagr', label: 'FCF 5Y' }
            ];

            grid.innerHTML = metrics.map(m => {
                const rate = growth[m.key];
                const isSelected = m.key === selectedSource;
                const colorClass = rate >= 0 ? 'positive' : 'negative';
                return `
                    <div class="growth-item ${isSelected ? 'selected' : ''}">
                        <div class="metric">${m.label}</div>
                        <div class="rate ${colorClass}">${rate >= 0 ? '+' : ''}${rate.toFixed(1)}%</div>
                    </div>
                `;
            }).join('');
        }

        function renderSensitivityMatrix() {
            const sens = dcfData.sensitivity;
            const table = document.getElementById('sensitivityMatrix');
            const currentPrice = dcfData.current_price;

            let html = '<tr><th>WACC \\ Term G</th>';
            sens.terminal_growth_range.forEach(tg => {
                html += `<th>${tg}%</th>`;
            });
            html += '</tr>';

            sens.wacc_range.forEach((wacc, i) => {
                html += `<tr><th>${wacc}%</th>`;
                sens.matrix[i].forEach((val, j) => {
                    const isHighlight = wacc === dcfData.assumptions.base.wacc &&
                                       sens.terminal_growth_range[j] === dcfData.assumptions.base.terminal_growth;
                    const colorClass = val >= currentPrice ? 'above-current' : 'below-current';
                    html += `<td class="${isHighlight ? 'highlight' : colorClass}">$${val}</td>`;
                });
                html += '</tr>';
            });

            table.innerHTML = html;
        }

        // Initialize
        renderKPIs();
        renderGuidance();
        initDCF();

        // Bind slider events
        (function() {
            var growthSlider = document.getElementById('growthSlider');
            var waccSlider = document.getElementById('waccSlider');
            var terminalSlider = document.getElementById('terminalSlider');

            if (growthSlider) {
                growthSlider.oninput = window.updateDCFDisplay;
                growthSlider.onchange = window.updateDCFDisplay;
            }
            if (waccSlider) {
                waccSlider.oninput = window.updateDCFDisplay;
                waccSlider.onchange = window.updateDCFDisplay;
            }
            if (terminalSlider) {
                terminalSlider.oninput = window.updateDCFDisplay;
                terminalSlider.onchange = window.updateDCFDisplay;
            }
        })();
    </script>
</body>
</html>
