<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASML Holding N.V. (ASML) Financial Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        .header h1 {
            font-size: 2.5rem;
            background: linear-gradient(90deg, #00d4aa, #00b894);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        .header p {
            color: #888;
            font-size: 1.1rem;
        }
        .header .monopoly-badge {
            display: inline-block;
            background: rgba(0, 212, 170, 0.15);
            border: 1px solid #00d4aa;
            border-radius: 20px;
            padding: 8px 16px;
            font-size: 0.9rem;
            color: #00d4aa;
            margin-top: 10px;
        }

        /* Investment Overview Section */
        .overview-section {
            max-width: 1400px;
            margin: 0 auto 30px;
        }
        .overview-toggle {
            width: 100%;
            background: rgba(0, 212, 170, 0.1);
            border: 1px solid rgba(0, 212, 170, 0.3);
            border-radius: 12px;
            padding: 16px 24px;
            color: #00d4aa;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
        }
        .overview-toggle:hover {
            background: rgba(0, 212, 170, 0.2);
        }
        .overview-toggle .arrow {
            transition: transform 0.3s ease;
        }
        .overview-toggle.active .arrow {
            transform: rotate(180deg);
        }
        .overview-content {
            display: none;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-top: none;
            border-radius: 0 0 12px 12px;
            padding: 30px;
            margin-top: -12px;
        }
        .overview-content.active {
            display: block;
        }
        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
        }
        .overview-card {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .overview-card h3 {
            color: #00d4aa;
            font-size: 1.1rem;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .overview-card p {
            margin-bottom: 12px;
            line-height: 1.6;
        }
        .overview-card ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .overview-card li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            line-height: 1.5;
        }
        .overview-card li:last-child {
            border-bottom: none;
        }
        .overview-card.bull h3 { color: #00d4aa; }
        .overview-card.bear h3 { color: #ff6b6b; }
        .overview-card.risks h3 { color: #fdcb6e; }
        .risk-high { color: #ff6b6b; font-weight: 600; }
        .risk-moderate { color: #fdcb6e; font-weight: 600; }
        .risk-low { color: #00d4aa; font-weight: 600; }
        .revenue-stream {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .revenue-stream .percent {
            color: #00d4aa;
            font-weight: 600;
        }
        .trend-growing { color: #00d4aa; }
        .trend-stable { color: #888; }
        .trend-declining { color: #ff6b6b; }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
        }
        .kpi-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 212, 170, 0.2);
        }
        .kpi-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #00d4aa;
            margin-bottom: 5px;
        }
        .kpi-label {
            font-size: 0.85rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .kpi-change {
            font-size: 0.9rem;
            margin-top: 5px;
        }
        .kpi-change.positive { color: #00d4aa; }
        .kpi-change.negative { color: #ff6b6b; }

        /* Guidance Section */
        .guidance-section {
            max-width: 1400px;
            margin: 0 auto 30px;
        }
        .guidance-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .guidance-header h3 {
            color: #fff;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .guidance-header h3::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 20px;
            background: linear-gradient(180deg, #00d4aa, #00b894);
            border-radius: 2px;
        }
        .guidance-meta {
            font-size: 0.85rem;
            color: #888;
        }
        .guidance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .guidance-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 18px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.2s ease;
        }
        .guidance-card:hover {
            transform: translateY(-2px);
        }
        .guidance-metric {
            font-size: 0.8rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }
        .guidance-target {
            font-size: 1.4rem;
            font-weight: 600;
            color: #00d4aa;
            margin-bottom: 6px;
        }
        .guidance-period {
            font-size: 0.85rem;
            color: #e0e0e0;
            margin-bottom: 8px;
        }
        .guidance-vs-prior {
            display: inline-block;
            font-size: 0.75rem;
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: 500;
        }
        .guidance-vs-prior.raised {
            background: rgba(0, 212, 170, 0.15);
            color: #00d4aa;
        }
        .guidance-vs-prior.lowered {
            background: rgba(255, 107, 107, 0.15);
            color: #ff6b6b;
        }
        .guidance-vs-prior.maintained {
            background: rgba(255, 255, 255, 0.1);
            color: #888;
        }
        .guidance-vs-prior.new {
            background: rgba(99, 102, 241, 0.15);
            color: #818cf8;
        }
        .guidance-notes {
            font-size: 0.8rem;
            color: #666;
            margin-top: 8px;
            line-height: 1.4;
        }
        .guidance-commentary {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            padding: 16px 20px;
            border-left: 3px solid #00d4aa;
            font-style: italic;
            color: #b0b0b0;
            line-height: 1.6;
        }
        .guidance-commentary::before {
            content: '"';
            font-size: 1.5rem;
            color: #00d4aa;
            margin-right: 4px;
        }

        .section-title {
            font-size: 1.5rem;
            color: #fff;
            margin: 40px auto 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(0, 212, 170, 0.3);
            max-width: 1400px;
        }
        .charts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 25px;
            max-width: 1400px;
            margin: 0 auto;
        }
        .chart-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .chart-card.full-width {
            grid-column: 1 / -1;
        }
        .chart-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .chart-header h3 {
            color: #fff;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .chart-header h3::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 20px;
            background: linear-gradient(180deg, #00d4aa, #00b894);
            border-radius: 2px;
        }
        .help-btn {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: rgba(0, 212, 170, 0.2);
            border: 1px solid #00d4aa;
            color: #00d4aa;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        .help-btn:hover {
            background: #00d4aa;
            color: #1a1a2e;
        }
        .chart-wrapper {
            position: relative;
            height: 300px;
        }

        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .modal-overlay.active { display: flex; }
        .modal {
            background: linear-gradient(135deg, #1e2a4a 0%, #16213e 100%);
            border-radius: 16px;
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid rgba(0, 212, 170, 0.3);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }
        .modal-header {
            padding: 20px 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .modal-header h3 {
            color: #00d4aa;
            font-size: 1.4rem;
            margin: 0;
        }
        .modal-close {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid #ff6b6b;
            color: #ff6b6b;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-close:hover {
            background: #ff6b6b;
            color: #fff;
        }
        .modal-body {
            padding: 25px;
            line-height: 1.7;
        }
        .modal-body p { margin-bottom: 15px; }
        .modal-body strong { color: #00d4aa; }
        .modal-body ul { margin: 15px 0; padding-left: 20px; }
        .modal-body li { margin-bottom: 8px; }
        .metric-highlight {
            background: rgba(0, 212, 170, 0.1);
            border-left: 3px solid #00d4aa;
            padding: 12px 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        /* DCF Valuation Section */
        .dcf-section {
            max-width: 1400px;
            margin: 0 auto 40px;
        }
        .dcf-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .dcf-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease;
        }
        .dcf-card:hover {
            transform: translateY(-3px);
        }
        .dcf-card.highlight {
            background: rgba(0, 212, 170, 0.1);
            border-color: rgba(0, 212, 170, 0.3);
        }
        .dcf-label {
            font-size: 0.85rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }
        .dcf-value {
            font-size: 2.2rem;
            font-weight: bold;
            color: #00d4aa;
        }
        .dcf-card:not(.highlight) .dcf-value {
            color: #fff;
        }
        .dcf-change {
            font-size: 1rem;
            margin-top: 8px;
            font-weight: 600;
        }
        .dcf-change.positive { color: #00d4aa; }
        .dcf-change.negative { color: #ff6b6b; }
        .dcf-sublabel {
            font-size: 0.8rem;
            color: #666;
            margin-top: 8px;
        }
        .dcf-warning {
            background: rgba(253, 203, 110, 0.15);
            border: 1px solid rgba(253, 203, 110, 0.4);
            border-radius: 8px;
            padding: 12px 16px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #fdcb6e;
        }
        .warning-icon {
            font-size: 1.2rem;
        }
        .dcf-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .slider-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .slider-group label {
            font-size: 0.95rem;
            color: #e0e0e0;
            display: flex;
            justify-content: space-between;
        }
        .slider-group label span {
            color: #00d4aa;
            font-weight: 600;
        }
        .slider-group input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: rgba(255, 255, 255, 0.1);
            outline: none;
        }
        .slider-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #00d4aa;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .slider-group input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }
        .slider-group input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #00d4aa;
            cursor: pointer;
            border: none;
        }
        .slider-hint {
            font-size: 0.8rem;
            color: #666;
        }
        .scenario-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .scenario-tab {
            padding: 10px 24px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: transparent;
            color: #888;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.2s;
        }
        .scenario-tab:hover {
            border-color: rgba(0, 212, 170, 0.5);
            color: #e0e0e0;
        }
        .scenario-tab.active {
            background: rgba(0, 212, 170, 0.15);
            border-color: #00d4aa;
            color: #00d4aa;
        }
        .scenario-details {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .scenario-details h4 {
            color: #00d4aa;
            margin-bottom: 15px;
        }
        .assumption-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        .assumption-item {
            text-align: center;
        }
        .assumption-item .label {
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 4px;
        }
        .assumption-item .value {
            font-size: 1.1rem;
            color: #e0e0e0;
            font-weight: 500;
        }
        .sensitivity-section {
            margin-bottom: 30px;
        }
        .sensitivity-section h4 {
            color: #e0e0e0;
            margin-bottom: 15px;
        }
        .sensitivity-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            overflow: hidden;
        }
        .sensitivity-table th,
        .sensitivity-table td {
            padding: 12px 16px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .sensitivity-table th {
            background: rgba(0, 212, 170, 0.1);
            color: #00d4aa;
            font-weight: 600;
        }
        .sensitivity-table td {
            color: #e0e0e0;
        }
        .sensitivity-table td.highlight {
            background: rgba(0, 212, 170, 0.15);
            color: #00d4aa;
            font-weight: 600;
        }
        .sensitivity-table td.below-current {
            color: #ff6b6b;
        }
        .sensitivity-table td.above-current {
            color: #00d4aa;
        }
        .historical-growth {
            margin-bottom: 30px;
        }
        .historical-growth h4 {
            color: #e0e0e0;
            margin-bottom: 15px;
        }
        .growth-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
        }
        .growth-item {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .growth-item .metric {
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 6px;
        }
        .growth-item .rate {
            font-size: 1.2rem;
            font-weight: 600;
        }
        .growth-item .rate.positive { color: #00d4aa; }
        .growth-item .rate.negative { color: #ff6b6b; }
        .growth-item.selected {
            border-color: #00d4aa;
            background: rgba(0, 212, 170, 0.1);
        }
        .dcf-download {
            text-align: center;
            margin-top: 30px;
        }
        .download-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 14px 28px;
            background: rgba(0, 212, 170, 0.15);
            border: 1px solid #00d4aa;
            border-radius: 8px;
            color: #00d4aa;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.2s;
        }
        .download-btn:hover {
            background: #00d4aa;
            color: #1a1a2e;
        }
        .download-icon {
            font-size: 1.2rem;
        }

        @media (max-width: 768px) {
            .charts-container { grid-template-columns: 1fr; }
            .overview-grid { grid-template-columns: 1fr; }
            .header h1 { font-size: 1.8rem; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ASML Holding N.V.</h1>
        <p>ASML &bull; Semiconductor Equipment &bull; EUR millions</p>
        <div class="monopoly-badge">100% EUV Monopoly &bull; AI Enabler</div>
    </div>

    <!-- Investment Overview Section -->
    <div class="overview-section">
        <button class="overview-toggle" onclick="toggleOverview()">
            <span>Investment Overview & Analysis</span>
            <span class="arrow">▼</span>
        </button>
        <div class="overview-content" id="overviewContent">
            <div class="overview-grid">
                <!-- Company Overview -->
                <div class="overview-card">
                    <h3>Company Overview</h3>
                    <p>ASML is a Dutch semiconductor equipment company and the world's sole supplier of extreme ultraviolet (EUV) lithography systems, which are critical for manufacturing advanced chips at 7nm and below. The company holds a 100% monopoly in EUV technology, positioning it as an indispensable enabler in the AI revolution and advanced semiconductor production. ASML operates globally with major customers including TSMC, Samsung, and Intel.</p>
                </div>

                <!-- Business Model -->
                <div class="overview-card">
                    <h3>Business Model</h3>
                    <p>ASML generates revenue through two primary streams: net system sales (approximately 65% of revenue) including EUV and DUV lithography equipment, and Installed Base Management (approximately 35% of revenue) covering service, upgrades, and field options. The business model features high barriers to entry, customer lock-in through proprietary technology, and recurring service revenue.</p>
                    <ul>
                        <li class="revenue-stream">
                            <span><span class="trend-growing">▲</span> EUV Systems</span>
                            <span class="percent">45%</span>
                        </li>
                        <li style="font-size: 0.85rem; color: #888; padding: 4px 0;">Extreme ultraviolet lithography systems for advanced chip production at 7nm and below. Expected to grow 30% YoY in 2025.</li>
                        <li class="revenue-stream">
                            <span><span class="trend-declining">▼</span> DUV Systems</span>
                            <span class="percent">20%</span>
                        </li>
                        <li style="font-size: 0.85rem; color: #888; padding: 4px 0;">Deep ultraviolet lithography systems for mature nodes. Expected to remain flat in 2025 and decline in 2026 as China sales normalize.</li>
                        <li class="revenue-stream">
                            <span><span class="trend-stable">●</span> Installed Base Management</span>
                            <span class="percent">35%</span>
                        </li>
                        <li style="font-size: 0.85rem; color: #888; padding: 4px 0;">High-margin recurring revenue from service contracts, upgrades, spare parts, and field options.</li>
                    </ul>
                    <p style="margin-top: 12px;"><strong>Geography:</strong> Taiwan ~34%, Korea ~25%, China ~20-25% (declining to mid-teens), Europe ~15%, Americas ~10%</p>
                </div>

                <!-- Competitive Position -->
                <div class="overview-card">
                    <h3>Competitive Position</h3>
                    <p><strong>Market Position:</strong> 100% monopoly in EUV lithography; 90%+ market share in advanced lithography overall</p>
                    <p><strong>Competitors:</strong> Canon (DUV only), Nikon (DUV only), xLight (emerging US competitor), China state-backed EUV (10-15 years behind)</p>
                    <p><strong>Moat Factors:</strong></p>
                    <ul>
                        <li><strong>Technological monopoly (Very Strong):</strong> 30 years and $9B in R&D. No competitor has replicated EUV capability.</li>
                        <li><strong>Supply chain control (Very Strong):</strong> Controls Zeiss lenses, Cymer lasers, decades of operational data.</li>
                        <li><strong>Customer switching costs (Very Strong):</strong> Billions invested in ASML-compatible processes.</li>
                        <li><strong>Installed base lock-in (Strong):</strong> $300B order backlog, multi-year lead times, each machine costs $150-400M.</li>
                    </ul>
                    <p><strong>Weaknesses:</strong> Heavy customer concentration (TSMC ~33%, top 3 >70%), geopolitical vulnerability, China export restrictions limiting ~20-25% of historical market.</p>
                </div>

                <!-- Growth Drivers -->
                <div class="overview-card">
                    <h3>Growth Drivers</h3>
                    <ul>
                        <li>AI-driven semiconductor demand: TSMC's 37% capex increase to $56B in 2026</li>
                        <li>High-NA EUV adoption: Next-generation systems enabling sub-2nm chips, 300,000+ wafers processed</li>
                        <li>Memory market surge: 186% increase in memory orders in Q3 2025 driven by advanced DRAM and HBM</li>
                        <li>Leading-edge logic expansion: Continued 3nm, 2nm, and sub-2nm node transitions requiring more EUV layers</li>
                        <li>Installed base growth: Growing installed base drives recurring high-margin service revenue (35% of total)</li>
                        <li>Market expansion: Semiconductor equipment market projected to double from $26B (2024) to $50B+ (2028)</li>
                        <li>Technology intensity: Each node shrink requires more EUV exposure steps per chip</li>
                    </ul>
                </div>

                <!-- Key Risks -->
                <div class="overview-card risks">
                    <h3>Key Risks</h3>
                    <ul>
                        <li><span class="risk-high">HIGH:</span> Customer concentration - TSMC 33%, top 3 >70% of revenue</li>
                        <li><span class="risk-high">HIGH:</span> Semiconductor cyclicality - Revenue can swing 20-30% year-over-year</li>
                        <li><span class="risk-high">HIGH:</span> China export restrictions - Revenue expected to decline 48% in 2026</li>
                        <li><span class="risk-high">HIGH:</span> Geopolitical tensions - Stock is real-time barometer of US-China tech war</li>
                        <li><span class="risk-moderate">MODERATE:</span> High valuation - 48x forward P/E demands flawless execution</li>
                        <li><span class="risk-moderate">MODERATE:</span> DUV loophole exploitation - Chinese chipmakers using multipatterning with older equipment</li>
                        <li><span class="risk-moderate">MODERATE:</span> High-NA transition execution risk - Critical for 2026-2027 growth</li>
                        <li><span class="risk-low">LOW:</span> Technology competition - xLight and China EUV efforts are 5-15 years from commercial viability</li>
                    </ul>
                </div>

                <!-- Bull Case -->
                <div class="overview-card bull">
                    <h3>Bull Case</h3>
                    <ul>
                        <li>Irreplaceable monopoly: 100% market share in EUV with 30-year technology lead and $300B backlog. No viable competitor for at least 5-10 years creates pricing power.</li>
                        <li>AI semiconductor supercycle: TSMC's 37% capex increase to $56B in 2026 reflects structural AI-driven demand. Semiconductor equipment market doubling from $26B to $50B+ (2028).</li>
                        <li>High-NA inflection: Next-generation EUV systems already ahead of maturity curve. Technology transition drives both unit growth and ASP expansion.</li>
                        <li>Margin expansion runway: Path to 56-60% gross margins by 2030 from 52% today driven by High-NA mix shift and operating leverage.</li>
                        <li>Conservative management: Track record of under-promising and over-delivering. Morgan Stanley bull case sees €2,000 share price (70% upside).</li>
                        <li>China risk largely priced in: Stock already reflects export control impact. Taiwan, Korea, US demand growth more than compensates.</li>
                    </ul>
                </div>

                <!-- Bear Case -->
                <div class="overview-card bear">
                    <h3>Bear Case</h3>
                    <ul>
                        <li>Extreme valuation requires perfection: 48x forward P/E with €526B market cap demands flawless execution. Any guidance miss could trigger significant multiple compression.</li>
                        <li>Semiconductor cyclicality risk: Industry capex can swing 20-30% year-over-year. Post-2027 demand visibility limited.</li>
                        <li>Geopolitical trapped: Stock is real-time barometer of US-China tensions. Further export restrictions possible.</li>
                        <li>Customer concentration vulnerability: TSMC (33%) and top 3 (>70%) create binary risk. Intel foundry struggles or any TSMC capex reduction would materially impact ASML.</li>
                        <li>China revenue cliff in 2026: Expected 48% decline in China revenue as it normalizes from 20-25% to mid-teens of total.</li>
                        <li>Emerging competition timeline risk: xLight (US $150M investment) targeting 30-40% cost advantage in laser technology. China EUV prototype in testing phase.</li>
                    </ul>
                </div>

                <!-- Recent Developments -->
                <div class="overview-card">
                    <h3>Recent Developments</h3>
                    <ul>
                        <li><strong>2025-Q3:</strong> Strong Q3 earnings: €7.5B revenue, €2.1B net income, 51.6% gross margin. Net bookings of €5.4B driven by EUV demand.</li>
                        <li><strong>2025-Q3:</strong> Memory orders surged 186% to €2.54B, driven by advanced DRAM and HBM demand for AI applications.</li>
                        <li><strong>2025-Q3:</strong> High-NA EUV progress: 300,000+ wafers processed, SK hynix installing first production tool. Maturity ahead of Low-NA at similar stage.</li>
                        <li><strong>December 2025:</strong> Netherlands joined US 'Pax Silica' strategic alliance, aligning Dutch export policy with US interests.</li>
                        <li><strong>December 2025:</strong> Stock gained nearly 50% in 2025 with 56.5% annual return, outperforming semiconductor peers.</li>
                        <li><strong>2025:</strong> TSMC announced $56B capex budget for 2026, up 37% from 2025. Intel and Samsung also expanding capacity.</li>
                        <li><strong>2025:</strong> China DUV sales reached 70% of DUVi systems sold in 2024 as Chinese chipmakers exploited export control loopholes.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- KPI Cards -->
    <div class="kpi-grid" id="kpiGrid"></div>

    <!-- Management Guidance Section -->
    <div class="guidance-section" id="guidanceSection">
        <div class="guidance-header">
            <h3>Management Guidance</h3>
            <span class="guidance-meta">As of <span id="guidanceAsOf">Q3 2025 Earnings (October 2025)</span> | <span id="guidanceFY">FY2025 and FY2026</span></span>
        </div>
        <div class="guidance-grid" id="guidanceGrid"></div>
        <div class="guidance-commentary" id="guidanceCommentary"></div>
    </div>

    <!-- Charts Section -->
    <h2 class="section-title">Financial Performance</h2>
    <div class="charts-container">
        <div class="chart-card">
            <div class="chart-header">
                <h3>Revenue Growth</h3>
                <button class="help-btn" onclick="openModal('revenue')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="revenueChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Margin Trends</h3>
                <button class="help-btn" onclick="openModal('margins')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="marginsChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>EPS Growth</h3>
                <button class="help-btn" onclick="openModal('eps')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="epsChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Free Cash Flow</h3>
                <button class="help-btn" onclick="openModal('fcf')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="fcfChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Systems Sold</h3>
                <button class="help-btn" onclick="openModal('systems')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="systemsChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Net Bookings</h3>
                <button class="help-btn" onclick="openModal('bookings')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="bookingsChart"></canvas>
            </div>
        </div>

        <div class="chart-card full-width">
            <div class="chart-header">
                <h3>Quarterly Revenue Trend (Q1 2021 - Q1 2025)</h3>
                <button class="help-btn" onclick="openModal('quarterly')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="quarterlyChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Profitability Breakdown</h3>
                <button class="help-btn" onclick="openModal('profitability')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="profitabilityChart"></canvas>
            </div>
        </div>
    </div>

    <!-- DCF Valuation Section -->
    <h2 class="section-title">DCF Valuation</h2>
    <div class="dcf-section">
        <!-- Valuation Summary Cards -->
        <div class="dcf-summary">
            <div class="dcf-card highlight">
                <div class="dcf-label">Intrinsic Value</div>
                <div class="dcf-value" id="dcfIV">$569</div>
                <div class="dcf-change negative" id="dcfUpside">-12% downside</div>
            </div>
            <div class="dcf-card">
                <div class="dcf-label">Entry Price (15% CAGR)</div>
                <div class="dcf-value" id="dcfEntry">$325</div>
                <div class="dcf-sublabel">Buy below for 15% annual return</div>
            </div>
            <div class="dcf-card">
                <div class="dcf-label">Current Price</div>
                <div class="dcf-value" id="dcfCurrent">$646</div>
            </div>
            <div class="dcf-card">
                <div class="dcf-label">Prob-Weighted IV</div>
                <div class="dcf-value" id="dcfWeighted">$572</div>
                <div class="dcf-sublabel">30% Bull / 50% Base / 20% Bear</div>
            </div>
        </div>

        <!-- Growth Rate Warning -->
        <div class="dcf-warning" id="growthWarning">
            <span class="warning-icon">&#9888;</span>
            <span id="warningText">Equity growth highly volatile due to share buybacks and one-time items. Using revenue growth as more stable indicator. FCF 3yr negative due to 2023 working capital build. Selected 16% base growth reflects FY2025 guidance of 15% revenue growth.</span>
        </div>

        <!-- Interactive Sliders -->
        <div class="dcf-controls">
            <div class="slider-group">
                <label>Growth Rate: <span id="growthValue">16%</span></label>
                <input type="range" id="growthSlider" min="0" max="30" value="16" step="1">
                <div class="slider-hint" id="growthHint">Based on blended revenue CAGR</div>
            </div>
            <div class="slider-group">
                <label>WACC: <span id="waccValue">10%</span></label>
                <input type="range" id="waccSlider" min="6" max="18" value="10" step="0.5">
            </div>
            <div class="slider-group">
                <label>Terminal Growth: <span id="terminalValue">3%</span></label>
                <input type="range" id="terminalSlider" min="0" max="5" value="3" step="0.5">
            </div>
        </div>

        <!-- Scenario Tabs -->
        <div class="scenario-tabs">
            <button class="scenario-tab active" data-scenario="base" onclick="switchScenario('base')">Base Case</button>
            <button class="scenario-tab" data-scenario="bull" onclick="switchScenario('bull')">Bull Case</button>
            <button class="scenario-tab" data-scenario="bear" onclick="switchScenario('bear')">Bear Case</button>
        </div>

        <!-- Scenario Details -->
        <div class="scenario-details" id="scenarioDetails">
            <div class="scenario-assumptions">
                <h4>Assumptions</h4>
                <div class="assumption-grid" id="assumptionGrid"></div>
            </div>
        </div>

        <!-- Sensitivity Table -->
        <div class="sensitivity-section">
            <h4>Sensitivity Analysis: Intrinsic Value by WACC & Terminal Growth (USD)</h4>
            <table class="sensitivity-table" id="sensitivityMatrix"></table>
        </div>

        <!-- Historical Growth Rates -->
        <div class="historical-growth">
            <h4>Historical Growth Rates (CAGR)</h4>
            <div class="growth-grid" id="growthGrid"></div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal-overlay" id="modalOverlay" onclick="closeModal(event)">
        <div class="modal">
            <div class="modal-header">
                <h3 id="modalTitle"></h3>
                <button class="modal-close" onclick="closeModal()">×</button>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

    <script>
        // EMBEDDED DATA - CSV
        const csvData = `Period,Revenue,GrossProfit,GrossMargin,OperatingIncome,OperatingMargin,NetIncome,NetMargin,EPSBasic,EPSDiluted,FreeCashFlow,ShareholdersEquity,TotalDebt,CashAndEquivalents,SharesOutstanding,SystemsSold,NetBookings,InstalledBaseSales,EUVSales,DUVSales
Q1 2021,4364.0,2352.0,53.9,1561.0,35.8,1331.0,30.5,3.21,3.20,-1139.0,13629.0,,4656.0,414.6,76,4740,1235.0,,,
Q2 2021,4020.0,2045.0,50.9,1239.0,30.8,1038.0,25.8,2.52,2.52,3322.0,12093.0,,5374.0,411.8,72,8271,,,
Q3 2021,5241.0,2711.0,51.7,1919.0,36.6,1740.0,33.2,4.27,4.26,1597.0,11502.0,,4456.0,408.0,79,6179,,,
Q4 2021,4986.0,2701.0,54.2,2031.0,40.7,1774.0,35.6,4.39,4.38,6126.0,10141.0,,7590.0,404.1,82,7050,,,
Q1 2022,3534.0,1731.0,49.0,784.0,22.2,695.0,19.7,1.73,1.73,-838.0,8810.0,,4723.0,401.7,62,6977,1247.0,,,
Q2 2022,5431.0,2665.0,49.1,1653.0,30.4,1411.0,26.0,3.54,3.54,2315.0,7649.0,,4402.0,398.6,91,8461,1290.0,,,
Q3 2022,5778.0,2994.0,51.8,1939.0,33.5,1701.0,29.4,4.29,4.29,805.0,7955.0,,3363.0,396.5,86,8920,1523.0,,,
Q4 2022,6430.0,3311.0,51.5,2125.0,33.0,1817.0,28.2,4.60,4.60,4885.0,8811.0,,7376.0,395.2,106,6316,1682.0,,,
Q1 2023,6746.0,3413.0,50.6,2205.0,32.7,1956.0,29.0,4.96,4.95,194.0,9787.0,,6653.0,393.8,100,3752,1404.0,,,
Q2 2023,6902.0,3544.0,51.3,2263.0,32.8,1942.0,28.1,4.93,4.93,-161.0,10605.0,,6346.0,393.9,113,4500,1358.0,,,
Q3 2023,6673.0,3462.0,51.9,2182.0,32.7,1893.0,28.4,4.81,4.81,618.0,11995.0,,4981.0,393.3,112,2602,1365.0,,,
Q4 2023,7237.0,3717.0,51.4,2392.0,33.1,2048.0,28.3,5.21,5.20,2595.0,13452.0,4631.5,7010.0,393.1,124,9186,1554.0,,,
Q1 2024,5290.0,2697.0,51.0,1392.0,26.3,1224.0,23.1,3.11,3.11,-676.0,13794.0,,5406.0,393.5,70,3611,1324.0,,,
Q2 2024,6243.0,3212.0,51.5,1834.0,29.4,1578.0,25.3,4.01,4.01,386.0,14711.0,,5019.0,393.5,100,5567,1482.0,,,
Q3 2024,7467.0,3793.0,50.8,2441.0,32.7,2077.0,27.8,5.28,5.28,534.0,16151.0,,4985.0,393.4,116,2633,1541.0,,,
Q4 2024,9263.0,4790.0,51.7,3356.0,36.2,2693.0,29.1,6.85,6.84,8839.0,18477.0,3677.3,12741.0,393.0,132,7088,2116.0,,,
Q1 2025,7742.0,4180.0,54.0,2738.0,35.4,2355.0,30.4,6.00,6.00,-475.0,17501.0,,9104.0,392.5,77,3936,2002.0,,,
FY2015,6287.0,2896.0,46.1,,,1387.0,22.1,3.22,3.21,,,,,430.0,,,,
FY2016,6795.0,3044.0,44.8,,,1472.0,21.7,3.46,3.45,,,,,425.0,,,,
FY2017,9053.0,4077.0,45.0,,,2119.0,23.4,4.93,4.92,,,,3288.0,430.0,,,,
FY2018,10944.0,5029.0,46.0,2965.0,27.1,2592.0,23.7,6.10,6.08,2463.0,11641.0,,4034.0,424.9,224,8181,2685.0,,,
FY2019,11820.0,5280.0,44.7,2791.0,23.6,2592.0,21.9,6.16,6.15,2391.0,12592.0,,4718.0,420.8,229,11740,2824.0,,,
FY2020,13979.0,6798.0,48.6,4051.0,29.0,3554.0,25.4,8.49,8.48,3627.0,13865.0,,7352.0,418.9,258,11292,3662.0,,,
FY2021,18611.0,9809.0,52.7,6750.0,36.3,5883.0,31.6,14.36,14.34,9906.0,10141.0,,7590.0,410.1,309,26240,4958.0,6252.0,7401.0
FY2022,21173.0,10700.0,50.5,6501.0,30.7,5624.0,26.6,14.14,14.13,7168.0,8811.0,,7376.0,397.8,345,30674,5743.0,7017.0,7753.0
FY2023,27559.0,14136.0,51.3,9042.0,32.8,7839.0,28.4,19.91,19.89,3247.0,13452.0,4631.5,7010.0,393.8,449,20040,5620.0,9125.0,12278.0
FY2024,28263.0,14492.0,51.3,9022.0,31.9,7572.0,26.8,19.25,19.24,9083.0,18477.0,3677.3,12741.0,393.4,418,18899,6494.0,8322.0,12801.0`;

        // EMBEDDED DATA - Analysis JSON
        const analysis = {
  "ticker": "ASML",
  "company_name": "ASML Holding N.V.",
  "analysis_date": "2026-01-22",
  "overview": "ASML is a Dutch semiconductor equipment company and the world's sole supplier of extreme ultraviolet (EUV) lithography systems, which are critical for manufacturing advanced chips at 7nm and below. The company holds a 100% monopoly in EUV technology, positioning it as an indispensable enabler in the AI revolution and advanced semiconductor production. ASML operates globally with major customers including TSMC, Samsung, and Intel.",
  "business_model": {
    "summary": "ASML generates revenue through two primary streams: net system sales (approximately 65% of revenue) including EUV and DUV lithography equipment, and Installed Base Management (approximately 35% of revenue) covering service, upgrades, and field options. The business model features high barriers to entry, customer lock-in through proprietary technology, and recurring service revenue.",
    "revenue_streams": [
      {
        "name": "EUV Systems",
        "percent": 45,
        "trend": "growing",
        "description": "Extreme ultraviolet lithography systems for advanced chip production at 7nm and below. Expected to grow 30% YoY in 2025, with High-NA EUV systems beginning to ship."
      },
      {
        "name": "DUV Systems",
        "percent": 20,
        "trend": "declining",
        "description": "Deep ultraviolet lithography systems for mature and some advanced nodes. Expected to remain flat in 2025 and decline in 2026 as China sales normalize."
      },
      {
        "name": "Installed Base Management",
        "percent": 35,
        "trend": "stable",
        "description": "High-margin recurring revenue from service contracts, upgrades, spare parts, and field options for installed equipment base."
      }
    ],
    "customer_type": "B2B - Major semiconductor manufacturers and foundries",
    "geographic_mix": "Taiwan ~34%, Korea ~25%, China ~20-25% (declining to mid-teens), Europe ~15%, Americas ~10%"
  },
  "competitive_position": {
    "main_competitors": [
      "Canon (DUV only)",
      "Nikon (DUV only)",
      "xLight (emerging US competitor in laser technology)",
      "China state-backed EUV development (10-15 years behind)"
    ],
    "market_position": "100% monopoly in EUV lithography; 90%+ market share in advanced lithography overall",
    "moat_factors": [
      {
        "factor": "Technological monopoly",
        "strength": "very strong",
        "description": "30 years and $9 billion in R&D to develop EUV technology that fires lasers at molten tin droplets 50,000 times per second in near-perfect vacuum. No competitor has replicated this capability."
      },
      {
        "factor": "Supply chain control",
        "strength": "very strong",
        "description": "Controls critical ecosystem including Zeiss high-precision lenses, Cymer laser sources, and decades of operational data. Competitors cannot access these components even if they replicate machine design."
      },
      {
        "factor": "Customer switching costs",
        "strength": "very strong",
        "description": "Customers have invested billions in ASML-compatible manufacturing processes, infrastructure, and training. Migration to alternative technology would require complete retooling of fabs."
      },
      {
        "factor": "Installed base lock-in",
        "strength": "strong",
        "description": "$300 billion order backlog and multi-year lead times create visibility and recurring service revenue. Each machine costs $150-400 million."
      },
      {
        "factor": "Regulatory barriers",
        "strength": "moderate",
        "description": "Export controls create competitive advantage in non-restricted markets but also limit addressable market in China."
      }
    ],
    "weaknesses": [
      "Heavy customer concentration (TSMC ~33%, top 3 customers >70% of revenue)",
      "Geopolitical vulnerability as Dutch company caught between US-China tensions",
      "China export restrictions limiting ~20-25% of historical market",
      "Cyclicality tied to semiconductor capital expenditure cycles"
    ]
  },
  "growth_drivers": [
    "AI-driven semiconductor demand: AI infrastructure spending driving TSMC's 37% capex increase to $56B in 2026",
    "High-NA EUV adoption: Next-generation systems enabling sub-2nm chips, with SK hynix already installing production tools and 300,000+ wafers processed",
    "Memory market surge: Advanced DRAM and HBM for AI applications driving 186% increase in memory orders in Q3 2025",
    "Leading-edge logic expansion: Continued 3nm, 2nm, and sub-2nm node transitions requiring more EUV layers per chip",
    "Installed base growth: Growing installed base drives recurring high-margin service revenue (35% of total revenue)",
    "Market expansion: Semiconductor equipment market projected to double from $26B in 2024 to $50B+ by 2028",
    "Technology intensity: Each node shrink requires more EUV exposure steps, increasing tool demand per wafer capacity"
  ],
  "risks": {
    "business": [
      {
        "risk": "Customer concentration",
        "severity": "high",
        "description": "TSMC represents ~33% of revenue, top 3 customers >70%. Any reduction in their capex spending directly impacts ASML revenue."
      },
      {
        "risk": "Semiconductor cyclicality",
        "severity": "high",
        "description": "Revenue tied to industry capex cycles which can swing 20-30% year-over-year. 2024 saw -14% EUV revenue decline before 2025 recovery."
      },
      {
        "risk": "DUV loophole exploitation",
        "severity": "moderate",
        "description": "Chinese chipmakers using multipatterning techniques with older DUV equipment to produce near-cutting-edge chips, reducing long-term EUV demand from China."
      }
    ],
    "financial": [
      {
        "risk": "High valuation",
        "severity": "moderate",
        "description": "Trading at 48x forward P/E with €526B market cap demands flawless execution. Any guidance miss or margin compression could trigger significant multiple contraction."
      },
      {
        "risk": "Margin pressure",
        "severity": "moderate",
        "description": "Gross margin target of 52% in 2025, expanding to 56-60% by 2030 depends on High-NA mix shift and operational leverage. Product transitions and competitive dynamics could pressure margins."
      }
    ],
    "regulatory": [
      {
        "risk": "China export restrictions",
        "severity": "high",
        "description": "US-led export controls limiting EUV and advanced DUV sales to China. China revenue expected to decline 48% in 2026 as it normalizes from 25% to mid-teens percentage of total sales."
      },
      {
        "risk": "Dutch government alignment",
        "severity": "moderate",
        "description": "Netherlands joined US 'Pax Silica' alliance in December 2025, fully aligning Dutch policy with US restrictions and potentially expanding future controls."
      },
      {
        "risk": "Rare earth countermeasures",
        "severity": "low",
        "description": "China imposed export controls on rare earth materials (holmium, thulium, ytterbium) but ASML has stockpiles and long lead times to mitigate impact."
      }
    ],
    "macro": [
      {
        "risk": "Geopolitical tensions",
        "severity": "high",
        "description": "ASML caught in US-China tech war as key battleground. Stock has become real-time barometer of trade tensions, with sharp drops on restriction announcements."
      },
      {
        "risk": "Technology competition",
        "severity": "low",
        "description": "US investing $150M in xLight to develop rival laser technology with 30-40% cost advantage. China EUV prototype in testing phase. However, both efforts are 5-15 years from commercial viability."
      },
      {
        "risk": "Customer consolidation risk",
        "severity": "moderate",
        "description": "Intel's foundry struggles and potential market consolidation could reduce number of leading-edge customers, increasing concentration risk."
      }
    ],
    "execution": [
      {
        "risk": "High-NA transition",
        "severity": "moderate",
        "description": "Successful commercialization of High-NA EUV critical for 2026-2027 growth and margin expansion targets. Technology complexity creates execution risk."
      },
      {
        "risk": "Post-2027 demand visibility",
        "severity": "moderate",
        "description": "Strong growth trajectory through 2027 well-supported, but visibility beyond 2027 depends on AI capex sustainability and new node transitions."
      }
    ]
  },
  "macro_factors": {
    "industry_outlook": "Semiconductor equipment market projected to grow from $26B (2024) to $50B+ (2028) driven by AI infrastructure. Advanced logic and memory segments showing strongest growth.",
    "cyclicality": "High - Revenue tied to semiconductor capex cycles. Industry can swing 20-30% year-over-year based on chip demand, memory pricing, and macro conditions.",
    "interest_rate_sensitivity": "Moderate - Customer capex decisions influenced by cost of capital. High interest rates can delay fab investments, though strategic importance of AI mitigates impact.",
    "currency_exposure": "Moderate - Revenue primarily denominated in US dollars and euros, with customers across Asia. Strong dollar can impact customer purchasing power and regional demand mix.",
    "key_input_costs": [
      "Precision optics (Zeiss lenses)",
      "Laser systems (Cymer)",
      "Rare earth materials (now subject to Chinese export controls but stockpiled)",
      "Advanced engineering talent",
      "R&D investment (critical for maintaining technological lead)"
    ]
  },
  "recent_developments": [
    {
      "date": "2025-Q3",
      "event": "Strong Q3 earnings: €7.5B revenue, €2.1B net income, 51.6% gross margin. Net bookings of €5.4B driven by EUV demand.",
      "impact": "Confirmed strong AI-driven demand recovery"
    },
    {
      "date": "2025-Q3",
      "event": "Memory orders surged 186% to €2.54B, driven by advanced DRAM and HBM demand for AI applications.",
      "impact": "Validates diversification beyond logic into memory segment"
    },
    {
      "date": "2025-Q3",
      "event": "High-NA EUV progress: 300,000+ wafers processed, SK hynix installing first production tool. Maturity ahead of Low-NA at similar stage.",
      "impact": "De-risks technology transition and supports 2026-2027 growth"
    },
    {
      "date": "December 2025",
      "event": "Netherlands joined US 'Pax Silica' strategic alliance, aligning Dutch export policy with US interests.",
      "impact": "Reduces policy uncertainty but confirms China restrictions will persist"
    },
    {
      "date": "December 2025",
      "event": "Stock gained nearly 50% in 2025 with 56.5% annual return, outperforming semiconductor peers.",
      "impact": "Reflects market confidence in AI-driven growth trajectory"
    },
    {
      "date": "2025",
      "event": "TSMC announced $56B capex budget for 2026, up 37% from 2025. Intel and Samsung also expanding capacity.",
      "impact": "Provides strong visibility for 2026 EUV demand"
    },
    {
      "date": "2025",
      "event": "China DUV sales reached 70% of DUVi systems sold in 2024 as Chinese chipmakers exploited export control loopholes.",
      "impact": "Highlights ongoing tension between restrictions and commercial interests"
    }
  ],
  "guidance": {
    "as_of": "Q3 2025 Earnings (October 2025)",
    "fiscal_year": "FY2025 and FY2026",
    "items": [
      {
        "metric": "Q4 2025 Revenue",
        "target": "€9.2-9.8B",
        "period": "Q4 2025",
        "vs_prior": "new",
        "notes": "Reflects continued strong EUV demand"
      },
      {
        "metric": "FY2025 Revenue",
        "target": "€32.5B",
        "period": "FY2025",
        "vs_prior": "maintained",
        "notes": "Implies ~15% growth vs FY2024"
      },
      {
        "metric": "FY2025 Gross Margin",
        "target": "~52%",
        "period": "FY2025",
        "vs_prior": "maintained",
        "notes": "Reflects product mix shift toward higher-margin EUV"
      },
      {
        "metric": "EUV Revenue Growth",
        "target": "~30% YoY",
        "period": "FY2025",
        "vs_prior": "maintained",
        "notes": "Driven by increased Low-NA capacity and initial High-NA shipments"
      },
      {
        "metric": "DUV Revenue",
        "target": "flat",
        "period": "FY2025",
        "vs_prior": "maintained",
        "notes": "Stable demand offset by China normalization beginning"
      },
      {
        "metric": "FY2026 Revenue",
        "target": "not expected to be below 2025",
        "period": "FY2026",
        "vs_prior": "new",
        "notes": "Conservative phrasing suggests flat to modest growth despite China headwinds"
      },
      {
        "metric": "FY2026 China Revenue",
        "target": "significant decline",
        "period": "FY2026",
        "vs_prior": "lowered",
        "notes": "Expected to normalize from 20-25% to mid-teens percentage of total revenue, implying ~48% YoY decline in absolute terms"
      },
      {
        "metric": "FY2026 EUV Revenue",
        "target": "up YoY",
        "period": "FY2026",
        "vs_prior": "maintained",
        "notes": "Growth driven by advanced DRAM and leading-edge logic, partially offset by China restrictions"
      },
      {
        "metric": "FY2026 DUV Revenue",
        "target": "down YoY",
        "period": "FY2026",
        "vs_prior": "maintained",
        "notes": "Expected decline due to China normalization and EUV substitution"
      },
      {
        "metric": "FY2030 Revenue",
        "target": "€44-60B",
        "period": "FY2030",
        "vs_prior": "long-term target",
        "notes": "Implies 35-85% growth from 2025 levels"
      },
      {
        "metric": "FY2030 Gross Margin",
        "target": "56-60%",
        "period": "FY2030",
        "vs_prior": "long-term target",
        "notes": "400-800 bps expansion from 2025 driven by High-NA mix shift and operational leverage"
      }
    ],
    "management_commentary": "CEO Christophe Fouquet emphasized confidence in AI-driven demand sustainability and High-NA progress ahead of schedule. Management highlighted that demand from Taiwan, US, and Korea customers will more than offset China normalization in 2026. CFO noted that 2026 guidance of 'not below 2025' reflects conservative approach given geopolitical uncertainties, but underlying demand trends remain strong. Consensus analyst expectations call for 11% revenue CAGR and 18% EPS CAGR from 2024-2027, with earnings potentially doubling by 2027 to ~€46 per share."
  },
  "bull_case": [
    "Irreplaceable monopoly: 100% market share in EUV with 30-year technology lead and $300B backlog. No viable competitor for at least 5-10 years creates pricing power and visibility.",
    "AI semiconductor supercycle: TSMC's 37% capex increase to $56B in 2026 reflects structural AI-driven demand. Semiconductor equipment market doubling from $26B (2024) to $50B+ (2028) with ASML as primary beneficiary.",
    "High-NA inflection: Next-generation EUV systems enabling sub-2nm chips already ahead of maturity curve with 300,000 wafers processed. Technology transition drives both unit growth and ASP expansion with improved margins.",
    "Margin expansion runway: Path to 56-60% gross margins by 2030 from 52% today driven by High-NA mix shift and operating leverage. Installed Base Management (35% of revenue) provides stable high-margin recurring revenue.",
    "Conservative management: Track record of under-promising and over-delivering creates upside surprise potential. 2026 'not below 2025' guidance likely conservative given customer capex commitments. Morgan Stanley bull case sees €2,000 share price (70% upside).",
    "China risk largely priced in: Stock already reflects export control impact with China revenue normalizing to mid-teens. Taiwan, Korea, US demand growth more than compensates, and any restriction relaxation is pure upside."
  ],
  "bear_case": [
    "Extreme valuation requires perfection: 48x forward P/E with €526B market cap demands flawless execution. Any guidance miss, margin disappointment, or customer capex cut could trigger significant multiple compression. Early 2026 volatility expected.",
    "Semiconductor cyclicality risk: Industry capex can swing 20-30% year-over-year. Post-2027 demand visibility limited and depends on AI capex sustainability. Historical cycles suggest downturn risk even with structural AI tailwinds.",
    "Geopolitical trapped: Stock is real-time barometer of US-China tensions. Further export restrictions could impact additional segments or customers. Netherlands' alignment with US in 'Pax Silica' alliance suggests more restrictions possible, not fewer.",
    "Customer concentration vulnerability: TSMC (33% of revenue) and top 3 customers (>70%) create binary risk. Intel foundry struggles, Samsung's competitive position, or any TSMC capex reduction would materially impact ASML. Industry consolidation could further concentrate customer base.",
    "China revenue cliff in 2026: Expected 48% decline in China revenue as it normalizes from 20-25% to mid-teens of total. DUV loophole exploitation (70% of DUVi systems sold to China in 2024) shows customer adaptation reducing long-term dependency.",
    "Emerging competition timeline risk: xLight (US $150M investment) targeting 30-40% cost advantage in laser technology, and China EUV prototype in testing phase. While 5-15 years from commercial viability, government-backed efforts reduce certainty of permanent monopoly. ASML's moat depends on continued massive R&D investment to maintain technology lead."
  ]
};

        // EMBEDDED DATA - DCF JSON
        const dcfData = {
  "ticker": "ASML",
  "company_name": "ASML Holding N.V.",
  "valuation_date": "2026-01-22",
  "current_price": 645.50,
  "currency": "USD",
  "note": "Financial data in EUR millions; stock price in USD (NASDAQ listing)",

  "inputs": {
    "shares_outstanding": 393.0,
    "total_debt": 3677.3,
    "cash_and_equivalents": 12741.0,
    "net_debt": -9063.7,
    "last_fcf": 9083.0,
    "currency": "EUR",
    "units": "millions"
  },

  "historical_growth": {
    "revenue_3yr_cagr": 14.94,
    "revenue_4yr_cagr": 19.24,
    "eps_3yr_cagr": 10.29,
    "eps_4yr_cagr": 22.73,
    "equity_3yr_cagr": 22.14,
    "equity_4yr_cagr": 7.44,
    "fcf_3yr_cagr": -2.85,
    "fcf_4yr_cagr": 25.80,
    "selected_growth_rate": 16.0,
    "growth_rate_source": "blended_revenue_cagr",
    "growth_divergence_warning": "Equity growth highly volatile due to share buybacks and one-time items. Using revenue growth as more stable indicator. FCF 3yr negative due to 2023 working capital build. Selected 16% base growth reflects FY2025 guidance of 15% revenue growth."
  },

  "assumptions": {
    "base": {
      "description": "Management guidance of 15% FY2025 growth, moderating to long-term sustainable rate",
      "growth_rates": [16.0, 14.0, 12.0, 10.0, 8.0],
      "fcf_margin": 32.0,
      "wacc": 10.0,
      "terminal_growth": 3.0,
      "rationale": "Based on FY2025 guidance of €32.5B revenue (15% growth), decelerating toward terminal. FCF margin of 32% reflects historical average (2024: 32.1%, 2021: 53%)."
    },
    "bull": {
      "description": "AI semiconductor supercycle with sustained High-NA adoption and margin expansion",
      "growth_rates": [25.0, 22.0, 18.0, 15.0, 12.0],
      "fcf_margin": 38.0,
      "wacc": 9.0,
      "terminal_growth": 4.0,
      "rationale": "EUV growth of 30% YoY, High-NA inflection, margin expansion to 56-60% by 2030 per management targets. AI supercycle drives sustained equipment spending."
    },
    "bear": {
      "description": "China headwinds, semiconductor downturn, and customer concentration risk materialize",
      "growth_rates": [5.0, 3.0, 2.0, 1.0, 0.0],
      "fcf_margin": 25.0,
      "wacc": 12.0,
      "terminal_growth": 2.0,
      "rationale": "China revenue down 48% in 2026, customer capex cuts, cyclical downturn. Margins compressed by competitive pressure and High-NA transition costs."
    }
  },

  "projections": {
    "base": {
      "years": ["Y1", "Y2", "Y3", "Y4", "Y5"],
      "revenue": [32769, 37357, 41840, 46024, 49706],
      "fcf": [10486, 11954, 13389, 14728, 15906],
      "discount_factors": [0.9091, 0.8264, 0.7513, 0.6830, 0.6209],
      "pv_fcf": [9533, 9878, 10057, 10057, 9875]
    },
    "bull": {
      "years": ["Y1", "Y2", "Y3", "Y4", "Y5"],
      "revenue": [35329, 43101, 50859, 58488, 65507],
      "fcf": [13425, 16378, 19326, 22226, 24893],
      "discount_factors": [0.9174, 0.8417, 0.7722, 0.7084, 0.6499],
      "pv_fcf": [12316, 13785, 14923, 15748, 16179]
    },
    "bear": {
      "years": ["Y1", "Y2", "Y3", "Y4", "Y5"],
      "revenue": [29676, 30567, 31178, 31490, 31490],
      "fcf": [7419, 7642, 7795, 7873, 7873],
      "discount_factors": [0.8929, 0.7972, 0.7118, 0.6355, 0.5674],
      "pv_fcf": [6623, 6092, 5548, 5002, 4467]
    }
  },

  "valuation": {
    "base": {
      "sum_pv_fcf": 49400,
      "terminal_fcf": 16383,
      "terminal_value": 234043,
      "pv_terminal": 145324,
      "enterprise_value": 194724,
      "equity_value": 203787,
      "intrinsic_value_eur": 518.55,
      "intrinsic_value_usd": 569.41,
      "upside": -11.8,
      "fx_rate_eur_usd": 1.098
    },
    "bull": {
      "sum_pv_fcf": 72951,
      "terminal_fcf": 25889,
      "terminal_value": 517786,
      "pv_terminal": 336472,
      "enterprise_value": 409423,
      "equity_value": 418487,
      "intrinsic_value_eur": 1064.78,
      "intrinsic_value_usd": 1169.13,
      "upside": 81.1
    },
    "bear": {
      "sum_pv_fcf": 27732,
      "terminal_fcf": 8031,
      "terminal_value": 80305,
      "pv_terminal": 45565,
      "enterprise_value": 73297,
      "equity_value": 82361,
      "intrinsic_value_eur": 209.54,
      "intrinsic_value_usd": 230.08,
      "upside": -64.4
    }
  },

  "entry_price": {
    "base": {
      "terminal_value_per_share_eur": 595.53,
      "terminal_value_per_share_usd": 653.89,
      "years_to_terminal": 5,
      "target_cagr": 15.0,
      "entry_price_eur": 295.97,
      "entry_price_usd": 325.05,
      "entry_discount_from_current": -49.6
    },
    "bull": {
      "terminal_value_per_share_eur": 1317.68,
      "terminal_value_per_share_usd": 1447.21,
      "years_to_terminal": 5,
      "target_cagr": 15.0,
      "entry_price_eur": 654.97,
      "entry_price_usd": 719.23,
      "entry_discount_from_current": 11.4
    },
    "bear": {
      "terminal_value_per_share_eur": 204.34,
      "terminal_value_per_share_usd": 224.37,
      "years_to_terminal": 5,
      "target_cagr": 15.0,
      "entry_price_eur": 101.54,
      "entry_price_usd": 111.50,
      "entry_discount_from_current": -82.7
    }
  },

  "sensitivity": {
    "wacc_range": [8.0, 9.0, 10.0, 11.0, 12.0],
    "terminal_growth_range": [2.0, 2.5, 3.0, 3.5, 4.0],
    "matrix_eur": [
      [682.45, 743.51, 821.35, 922.13, 1059.81],
      [595.27, 641.88, 699.93, 774.29, 872.54],
      [527.55, 562.89, 605.80, 658.61, 724.68],
      [473.39, 500.29, 532.47, 571.25, 618.35],
      [429.32, 450.71, 475.94, 505.86, 541.73]
    ],
    "matrix_usd": [
      [749.41, 816.38, 902.00, 1012.50, 1163.67],
      [653.57, 704.90, 768.73, 850.25, 958.11],
      [579.25, 618.13, 665.17, 723.15, 795.70],
      [519.74, 549.32, 584.65, 627.31, 678.88],
      [471.39, 494.88, 522.50, 555.43, 594.78]
    ],
    "note": "Matrix shows intrinsic value per share across different WACC and terminal growth rate assumptions"
  },

  "probability_weighted": {
    "weights": {
      "bull": 0.30,
      "base": 0.50,
      "bear": 0.20
    },
    "weighted_iv_eur": 520.58,
    "weighted_iv_usd": 571.60,
    "weighted_upside": -11.4,
    "rationale": "Higher bull weighting (30%) given strong FY2025 guidance, TSMC 37% capex increase, and High-NA progress. Bear case (20%) reflects geopolitical risks and China headwinds already well-telegraphed."
  },

  "key_metrics": {
    "current_market_cap_eur": 235900,
    "current_market_cap_usd": 253618,
    "current_pe_ratio": 33.6,
    "forward_pe_ratio": 14.0,
    "fcf_yield": 3.6,
    "ev_to_fcf": 25.0,
    "price_to_book": 13.7,
    "note": "Forward P/E based on consensus 2025 EPS estimate of ~€46; current price €587 (€645.50 USD / 1.098)"
  },

  "summary": {
    "investment_thesis": "ASML is the sole supplier of EUV lithography systems with a 100% monopoly in technology critical for advanced semiconductor manufacturing. The company benefits from irreplaceable positioning in the AI-driven semiconductor supercycle, with TSMC increasing capex 37% to $56B in 2026. Strong FY2025 guidance (€32.5B revenue, 15% growth) and successful High-NA EUV adoption provide near-term visibility.",
    "valuation_assessment": "At $645.50, ASML trades at a 12% discount to base case intrinsic value of $569 and 11% below probability-weighted fair value of $572. However, the stock requires strong execution to justify its 34x P/E multiple. Entry price for 15% CAGR target is $325 (50% discount), suggesting current levels offer moderate value but not a margin of safety.",
    "primary_risks": "High customer concentration (TSMC 33%, top 3 >70%), China revenue cliff in 2026 (expected down 48%), semiconductor cyclicality, and geopolitical tensions. Stock has become a real-time barometer of US-China trade relations. Valuation depends on sustained AI capex spending and successful High-NA transition.",
    "recommendation": "HOLD at current prices. Stock is fairly valued in base case but lacks compelling margin of safety. Accumulate on pullbacks toward $500-550 range. Bull case offers 81% upside if AI supercycle sustains and margins expand as guided. Monitor Q4 2025 earnings (late January) for FY2025 confirmation and 2026 guidance detail."
  }
};

        // Parse CSV
        function parseCSV(csv) {
            const lines = csv.trim().split('\n');
            const headers = lines[0].split(',');
            return lines.slice(1).map(line => {
                const values = line.split(',');
                const obj = {};
                headers.forEach((h, i) => obj[h.trim()] = values[i]?.trim());
                return obj;
            });
        }

        const data = parseCSV(csvData);

        // Sort data chronologically (oldest first)
        data.sort((a, b) => {
            const parseDate = (p) => {
                const year = parseInt(p.match(/\d{4}/)?.[0] || '0');
                const isQ1 = p.includes('Q1');
                const isQ2 = p.includes('Q2');
                const isQ3 = p.includes('Q3');
                const isQ4 = p.includes('Q4');
                const isH1 = p.includes('H1');
                const isH2 = p.includes('H2');
                const isFY = p.startsWith('FY');
                const subOrder = isQ1 ? 1 : isQ2 ? 2 : isH1 ? 3 : isQ3 ? 4 : isQ4 ? 5 : isH2 ? 6 : isFY ? 7 : 0;
                return year * 10 + subOrder;
            };
            return parseDate(a.Period) - parseDate(b.Period);
        });

        // Filter for annual data (FY periods)
        const fyData = data.filter(d => d.Period.startsWith('FY'));

        // Filter for quarterly data (Q1 2021 - Q1 2025)
        const quarterlyData = data.filter(d => d.Period.match(/^Q\d \d{4}$/));

        // Toggle overview
        function toggleOverview() {
            const btn = document.querySelector('.overview-toggle');
            const content = document.getElementById('overviewContent');
            btn.classList.toggle('active');
            content.classList.toggle('active');
        }

        // YoY calculation
        function calcYoYChange(current, previous) {
            if (!previous || !current || previous === '' || current === '') return null;
            const curr = parseFloat(current);
            const prev = parseFloat(previous);
            if (isNaN(curr) || isNaN(prev) || prev === 0) return null;
            return ((curr - prev) / Math.abs(prev) * 100).toFixed(1);
        }

        // Format number
        function formatNumber(num) {
            if (!num || num === '') return 'N/A';
            const n = parseFloat(num);
            if (isNaN(n)) return 'N/A';
            if (n >= 1000) return '€' + (n / 1000).toFixed(1) + 'B';
            return '€' + n.toFixed(0) + 'M';
        }

        // Render KPI cards
        function renderKPIs() {
            const latest = fyData[fyData.length - 1];
            const previous = fyData[fyData.length - 2];

            const kpis = [
                { label: 'Revenue', value: formatNumber(latest.Revenue), change: calcYoYChange(latest.Revenue, previous.Revenue) },
                { label: 'Gross Margin', value: latest.GrossMargin + '%', change: calcYoYChange(latest.GrossMargin, previous.GrossMargin) },
                { label: 'Operating Income', value: formatNumber(latest.OperatingIncome), change: calcYoYChange(latest.OperatingIncome, previous.OperatingIncome) },
                { label: 'Net Income', value: formatNumber(latest.NetIncome), change: calcYoYChange(latest.NetIncome, previous.NetIncome) },
                { label: 'EPS (Diluted)', value: '€' + parseFloat(latest.EPSDiluted).toFixed(2), change: calcYoYChange(latest.EPSDiluted, previous.EPSDiluted) },
                { label: 'Free Cash Flow', value: formatNumber(latest.FreeCashFlow), change: calcYoYChange(latest.FreeCashFlow, previous.FreeCashFlow) },
                { label: 'Systems Sold', value: latest.SystemsSold, change: calcYoYChange(latest.SystemsSold, previous.SystemsSold) },
                { label: 'Net Bookings', value: formatNumber(latest.NetBookings), change: calcYoYChange(latest.NetBookings, previous.NetBookings) }
            ];

            const grid = document.getElementById('kpiGrid');
            grid.innerHTML = kpis.map(kpi => {
                const changeClass = kpi.change ? (parseFloat(kpi.change) >= 0 ? 'positive' : 'negative') : '';
                const changeText = kpi.change ? `${parseFloat(kpi.change) >= 0 ? '+' : ''}${kpi.change}% YoY` : '';
                return `
                    <div class="kpi-card">
                        <div class="kpi-value">${kpi.value}</div>
                        <div class="kpi-label">${kpi.label}</div>
                        ${changeText ? `<div class="kpi-change ${changeClass}">${changeText}</div>` : ''}
                    </div>
                `;
            }).join('');
        }

        // Render guidance
        function renderGuidance() {
            const guidance = analysis.guidance;
            if (!guidance || !guidance.items || guidance.items.length === 0) {
                document.getElementById('guidanceSection').style.display = 'none';
                return;
            }

            document.getElementById('guidanceAsOf').textContent = guidance.as_of || '';
            document.getElementById('guidanceFY').textContent = guidance.fiscal_year || '';

            const grid = document.getElementById('guidanceGrid');
            grid.innerHTML = guidance.items.map(item => {
                const vsClass = item.vs_prior ? item.vs_prior.toLowerCase().replace(/\s+/g, '-').replace('guidance', '').trim() : 'new';
                const vsLabel = item.vs_prior ? item.vs_prior.charAt(0).toUpperCase() + item.vs_prior.slice(1) : 'New';
                return `
                    <div class="guidance-card">
                        <div class="guidance-metric">${item.metric}</div>
                        <div class="guidance-target">${item.target}</div>
                        <div class="guidance-period">${item.period}</div>
                        <span class="guidance-vs-prior ${vsClass}">${vsLabel}</span>
                        ${item.notes ? `<div class="guidance-notes">${item.notes}</div>` : ''}
                    </div>
                `;
            }).join('');

            const commentary = document.getElementById('guidanceCommentary');
            if (guidance.management_commentary) {
                commentary.textContent = guidance.management_commentary;
                commentary.style.display = 'block';
            } else {
                commentary.style.display = 'none';
            }
        }

        // Chart defaults
        const chartDefaults = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { labels: { color: '#e0e0e0', font: { size: 11 } } }
            },
            scales: {
                x: { ticks: { color: '#888' }, grid: { color: 'rgba(255,255,255,0.05)' } },
                y: { ticks: { color: '#888' }, grid: { color: 'rgba(255,255,255,0.05)' } }
            }
        };

        const colors = {
            primary: '#00d4aa',
            secondary: '#00b894',
            tertiary: '#0984e3',
            quaternary: '#6c5ce7',
            warning: '#fdcb6e',
            danger: '#ff6b6b'
        };

        // Revenue Chart
        new Chart(document.getElementById('revenueChart'), {
            type: 'bar',
            data: {
                labels: fyData.map(d => d.Period),
                datasets: [{
                    label: 'Revenue (€M)',
                    data: fyData.map(d => parseFloat(d.Revenue)),
                    backgroundColor: colors.primary,
                    borderRadius: 6
                }]
            },
            options: chartDefaults
        });

        // Margins Chart
        new Chart(document.getElementById('marginsChart'), {
            type: 'line',
            data: {
                labels: fyData.map(d => d.Period),
                datasets: [
                    {
                        label: 'Gross Margin',
                        data: fyData.map(d => parseFloat(d.GrossMargin)),
                        borderColor: colors.primary,
                        backgroundColor: 'rgba(0, 212, 170, 0.1)',
                        tension: 0.3
                    },
                    {
                        label: 'Operating Margin',
                        data: fyData.map(d => parseFloat(d.OperatingMargin)),
                        borderColor: colors.tertiary,
                        backgroundColor: 'rgba(9, 132, 227, 0.1)',
                        tension: 0.3
                    },
                    {
                        label: 'Net Margin',
                        data: fyData.map(d => parseFloat(d.NetMargin)),
                        borderColor: colors.quaternary,
                        backgroundColor: 'rgba(108, 92, 231, 0.1)',
                        tension: 0.3
                    }
                ]
            },
            options: {
                ...chartDefaults,
                scales: {
                    ...chartDefaults.scales,
                    y: {
                        ...chartDefaults.scales.y,
                        ticks: { ...chartDefaults.scales.y.ticks, callback: value => value + '%' }
                    }
                }
            }
        });

        // EPS Chart
        new Chart(document.getElementById('epsChart'), {
            type: 'bar',
            data: {
                labels: fyData.map(d => d.Period),
                datasets: [{
                    label: 'EPS Diluted (€)',
                    data: fyData.map(d => parseFloat(d.EPSDiluted)),
                    backgroundColor: colors.tertiary,
                    borderRadius: 6
                }]
            },
            options: chartDefaults
        });

        // FCF Chart
        new Chart(document.getElementById('fcfChart'), {
            type: 'bar',
            data: {
                labels: fyData.map(d => d.Period),
                datasets: [{
                    label: 'Free Cash Flow (€M)',
                    data: fyData.map(d => parseFloat(d.FreeCashFlow)),
                    backgroundColor: colors.quaternary,
                    borderRadius: 6
                }]
            },
            options: chartDefaults
        });

        // Systems Sold Chart
        new Chart(document.getElementById('systemsChart'), {
            type: 'bar',
            data: {
                labels: fyData.map(d => d.Period),
                datasets: [{
                    label: 'Systems Sold',
                    data: fyData.map(d => parseFloat(d.SystemsSold)),
                    backgroundColor: colors.warning,
                    borderRadius: 6
                }]
            },
            options: chartDefaults
        });

        // Net Bookings Chart
        new Chart(document.getElementById('bookingsChart'), {
            type: 'bar',
            data: {
                labels: fyData.map(d => d.Period),
                datasets: [{
                    label: 'Net Bookings (€M)',
                    data: fyData.map(d => parseFloat(d.NetBookings)),
                    backgroundColor: colors.danger,
                    borderRadius: 6
                }]
            },
            options: chartDefaults
        });

        // Quarterly Revenue Chart
        new Chart(document.getElementById('quarterlyChart'), {
            type: 'line',
            data: {
                labels: quarterlyData.map(d => d.Period),
                datasets: [{
                    label: 'Quarterly Revenue (€M)',
                    data: quarterlyData.map(d => parseFloat(d.Revenue)),
                    borderColor: colors.primary,
                    backgroundColor: 'rgba(0, 212, 170, 0.1)',
                    tension: 0.3,
                    fill: true
                }]
            },
            options: chartDefaults
        });

        // Profitability Breakdown Chart
        new Chart(document.getElementById('profitabilityChart'), {
            type: 'bar',
            data: {
                labels: fyData.map(d => d.Period),
                datasets: [
                    {
                        label: 'Cost of Sales %',
                        data: fyData.map(d => 100 - parseFloat(d.GrossMargin)),
                        backgroundColor: colors.danger,
                        stack: 'stack1'
                    },
                    {
                        label: 'OpEx %',
                        data: fyData.map(d => parseFloat(d.GrossMargin) - parseFloat(d.OperatingMargin)),
                        backgroundColor: colors.warning,
                        stack: 'stack1'
                    },
                    {
                        label: 'Net Income %',
                        data: fyData.map(d => parseFloat(d.NetMargin)),
                        backgroundColor: colors.primary,
                        stack: 'stack1'
                    }
                ]
            },
            options: {
                ...chartDefaults,
                scales: {
                    ...chartDefaults.scales,
                    x: { ...chartDefaults.scales.x, stacked: true },
                    y: {
                        ...chartDefaults.scales.y,
                        stacked: true,
                        ticks: { ...chartDefaults.scales.y.ticks, callback: value => value + '%' }
                    }
                }
            }
        });

        // Metric descriptions for modals
        const metricDescriptions = {
            revenue: {
                title: "Revenue",
                content: `
                    <p><strong>Revenue</strong> is ASML's total income from system sales (EUV and DUV lithography equipment) and Installed Base Management (service, upgrades, spare parts).</p>
                    <div class="metric-highlight">
                        <strong>For ASML:</strong> Revenue is divided into ~65% systems (45% EUV, 20% DUV) and ~35% Installed Base Management. Each EUV system costs $150-400M, while DUV systems cost $50-100M.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>EUV revenue growth: Target of 30% YoY in 2025, driven by AI chip demand and High-NA adoption</li>
                        <li>China revenue mix: Expected to decline from 20-25% to mid-teens in 2026 due to export restrictions</li>
                        <li>Installed Base Management growth: High-margin recurring revenue from growing installed base</li>
                        <li>Customer concentration: TSMC represents ~33% of revenue, top 3 customers >70%</li>
                    </ul>
                `
            },
            margins: {
                title: "Margin Trends",
                content: `
                    <p><strong>Gross Margin:</strong> Revenue minus cost of goods sold, showing pricing power and operational efficiency.</p>
                    <p><strong>Operating Margin:</strong> Operating income as % of revenue, after deducting R&D and SG&A expenses.</p>
                    <p><strong>Net Margin:</strong> Net income as % of revenue, after all expenses including taxes and interest.</p>
                    <div class="metric-highlight">
                        <strong>For ASML:</strong> Gross margin target is ~52% in 2025, expanding to 56-60% by 2030 driven by High-NA EUV mix shift and operational leverage. Installed Base Management carries higher margins than system sales.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Product mix impact: Higher EUV and Installed Base Management mix improves margins</li>
                        <li>High-NA transition: Next-generation EUV systems command premium pricing and better margins</li>
                        <li>R&D intensity: ASML invests ~15% of revenue in R&D to maintain technology lead</li>
                        <li>Operating leverage: Fixed cost absorption as revenue scales</li>
                    </ul>
                `
            },
            eps: {
                title: "EPS Growth",
                content: `
                    <p><strong>Earnings Per Share (EPS)</strong> measures net income divided by shares outstanding. Diluted EPS accounts for stock options and convertible securities.</p>
                    <div class="metric-highlight">
                        <strong>For ASML:</strong> FY2024 EPS was €19.24, with consensus estimates calling for doubling to ~€46 by 2027. This implies 18% EPS CAGR from 2024-2027, driven by revenue growth and margin expansion.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>EPS growth vs. revenue growth: Operating leverage should drive faster EPS growth</li>
                        <li>Share buyback impact: ASML returns cash to shareholders, reducing share count</li>
                        <li>Tax rate: Effective tax rate impacts net income and EPS</li>
                        <li>Forward P/E valuation: Currently trading at ~34x FY2024 EPS, 14x forward (2025E) EPS</li>
                    </ul>
                `
            },
            fcf: {
                title: "Free Cash Flow",
                content: `
                    <p><strong>Free Cash Flow (FCF)</strong> is cash generated from operations minus capital expenditures. It represents cash available for dividends, buybacks, debt repayment, or acquisitions.</p>
                    <div class="metric-highlight">
                        <strong>For ASML:</strong> FY2024 FCF was €9.1B (32% FCF margin). 2023 saw working capital build due to strong bookings, temporarily compressing FCF. Long-term target is to sustain 30-35% FCF margins as revenue scales.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>FCF conversion: Target ratio of FCF to net income should be 90-100%</li>
                        <li>Working capital volatility: Large system orders create timing differences between revenue and cash collection</li>
                        <li>Capex intensity: ASML invests in R&D facilities and manufacturing capacity</li>
                        <li>Capital allocation: FCF funds dividends (~30% payout ratio) and share buybacks</li>
                    </ul>
                `
            },
            systems: {
                title: "Systems Sold",
                content: `
                    <p><strong>Systems Sold</strong> is the total number of lithography systems (EUV + DUV) shipped to customers in a period.</p>
                    <div class="metric-highlight">
                        <strong>For ASML:</strong> FY2024 sold 418 systems (down from 449 in FY2023 due to China restrictions). Mix is shifting toward higher-value EUV systems. High-NA EUV systems are beginning to ship, commanding premium pricing ($350-400M vs. $150-200M for Low-NA EUV).
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>EUV vs. DUV mix: EUV systems have higher ASP and margins, so mix matters more than total units</li>
                        <li>High-NA adoption: SK hynix installing first production tools in 2025; Intel and TSMC to follow</li>
                        <li>China impact: DUV sales to China represented 70% of DUVi systems sold in 2024, but expected to decline</li>
                        <li>Lead times: Multi-year order backlog ($300B) provides strong visibility despite quarterly volatility</li>
                    </ul>
                `
            },
            bookings: {
                title: "Net Bookings",
                content: `
                    <p><strong>Net Bookings</strong> represents new orders received during the period, indicating future demand and revenue visibility.</p>
                    <div class="metric-highlight">
                        <strong>For ASML:</strong> FY2024 net bookings were €18.9B (down from €20.0B in 2023). Q3 2025 saw strong bookings of €5.4B driven by EUV demand. Memory segment bookings surged 186% in Q3 2025 to €2.54B, driven by HBM and advanced DRAM for AI.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Book-to-bill ratio: >1.0 indicates growing backlog, <1.0 indicates backlog consumption</li>
                        <li>Customer segment mix: Logic (TSMC, Intel, Samsung) vs. Memory (SK hynix, Micron) demand cycles</li>
                        <li>Lead times: Bookings today typically convert to revenue 12-18 months later</li>
                        <li>Backlog coverage: $300B backlog provides multi-year revenue visibility</li>
                        <li>Cancellation risk: Long lead times create risk if customers delay or cancel orders during downturns</li>
                    </ul>
                `
            },
            quarterly: {
                title: "Quarterly Revenue Trend",
                content: `
                    <p><strong>Quarterly revenue</strong> shows the sequential trend and seasonality in ASML's business over time.</p>
                    <div class="metric-highlight">
                        <strong>For ASML:</strong> Q4 is typically the strongest quarter due to year-end customer budget cycles. Q1 is often weakest due to Chinese New Year and factory shutdowns. Recent trend shows recovery from 2023 working capital build, with Q4 2024 revenue of €9.3B setting quarterly record.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Seasonality patterns: Q4 strength vs. Q1 weakness is normal</li>
                        <li>Year-over-year trends: Compare Q1 2025 (€7.7B) to Q1 2024 (€5.3B) for +46% growth</li>
                        <li>Quarterly volatility: Large system shipments create lumpiness in quarterly results</li>
                        <li>China exposure: Monitor quarterly revenue concentration from China customers</li>
                        <li>Guidance accuracy: ASML typically provides quarterly guidance; track beats/misses</li>
                    </ul>
                `
            },
            profitability: {
                title: "Profitability Breakdown",
                content: `
                    <p><strong>Profitability breakdown</strong> shows how each revenue euro is allocated between cost of sales, operating expenses, and net income.</p>
                    <div class="metric-highlight">
                        <strong>For ASML:</strong> FY2024 breakdown: ~49% cost of sales, ~19% operating expenses (R&D + SG&A), ~27% net income. Target is to expand net margin to 30%+ by 2027 through gross margin expansion and operating leverage.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Gross margin expansion: High-NA mix shift and Installed Base Management growth should reduce COGS %</li>
                        <li>R&D spending: ASML invests ~15% of revenue in R&D; essential for maintaining technology lead</li>
                        <li>SG&A leverage: Should decline as % of revenue as company scales</li>
                        <li>Net margin target: 30%+ by 2027, 35%+ long-term as High-NA becomes dominant product</li>
                    </ul>
                `
            }
        };

        // Modal functions
        function openModal(key) {
            document.getElementById('modalTitle').textContent = metricDescriptions[key].title;
            document.getElementById('modalBody').innerHTML = metricDescriptions[key].content;
            document.getElementById('modalOverlay').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(event) {
            if (event && event.target !== document.getElementById('modalOverlay') && event.target.className !== 'modal-close') return;
            document.getElementById('modalOverlay').classList.remove('active');
            document.body.style.overflow = '';
        }

        document.addEventListener('keydown', e => { if (e.key === 'Escape') closeModal(); });

        // DCF Functions
        let currentScenario = 'base';

        function initDCF() {
            if (!dcfData || !dcfData.valuation) return;

            document.getElementById('dcfCurrent').textContent = '$' + dcfData.current_price.toFixed(0);

            if (dcfData.historical_growth.growth_divergence_warning) {
                document.getElementById('growthWarning').style.display = 'flex';
                document.getElementById('warningText').textContent = dcfData.historical_growth.growth_divergence_warning;
            }

            const base = dcfData.assumptions.base;
            document.getElementById('growthSlider').value = dcfData.historical_growth.selected_growth_rate;
            document.getElementById('waccSlider').value = base.wacc;
            document.getElementById('terminalSlider').value = base.terminal_growth;

            document.getElementById('growthValue').textContent = dcfData.historical_growth.selected_growth_rate + '%';
            document.getElementById('waccValue').textContent = base.wacc + '%';
            document.getElementById('terminalValue').textContent = base.terminal_growth + '%';

            document.getElementById('growthHint').textContent = 'Based on ' + dcfData.historical_growth.growth_rate_source.replace(/_/g, ' ');

            renderHistoricalGrowth();
            renderSensitivityMatrix();
            updateDCFDisplay();
            switchScenario('base');
        }

        function calculateDCF(growthRate, wacc, terminalGrowth) {
            const years = 5;
            const fcf = dcfData.inputs.last_fcf;
            let pvFCF = 0;
            let projectedFCF = fcf;

            for (let i = 0; i < years; i++) {
                projectedFCF *= (1 + growthRate / 100);
                pvFCF += projectedFCF / Math.pow(1 + wacc/100, i + 1);
            }

            const terminalFCF = projectedFCF * (1 + terminalGrowth/100);
            const terminalValue = terminalFCF / (wacc/100 - terminalGrowth/100);
            const pvTerminal = terminalValue / Math.pow(1 + wacc/100, years);

            const enterpriseValue = pvFCF + pvTerminal;
            const equityValue = enterpriseValue - dcfData.inputs.net_debt;
            const ivEur = equityValue / dcfData.inputs.shares_outstanding;
            const ivUsd = ivEur * dcfData.valuation.base.fx_rate_eur_usd;

            const terminalPerShareUsd = (terminalValue / dcfData.inputs.shares_outstanding) * dcfData.valuation.base.fx_rate_eur_usd;
            const entryPrice = terminalPerShareUsd / Math.pow(1.15, years);

            return {
                iv: ivUsd,
                entryPrice: entryPrice,
                terminalPerShare: terminalPerShareUsd,
                pvFCF: pvFCF,
                pvTerminal: pvTerminal,
                enterpriseValue: enterpriseValue
            };
        }

        window.updateDCFDisplay = function() {
            const growth = parseFloat(document.getElementById('growthSlider').value);
            const wacc = parseFloat(document.getElementById('waccSlider').value);
            const terminal = parseFloat(document.getElementById('terminalSlider').value);

            document.getElementById('growthValue').textContent = growth + '%';
            document.getElementById('waccValue').textContent = wacc + '%';
            document.getElementById('terminalValue').textContent = terminal + '%';

            const result = calculateDCF(growth, wacc, terminal);

            document.getElementById('dcfIV').textContent = '$' + result.iv.toFixed(0);
            document.getElementById('dcfEntry').textContent = '$' + result.entryPrice.toFixed(0);

            const upside = ((result.iv - dcfData.current_price) / dcfData.current_price * 100);
            const upsideEl = document.getElementById('dcfUpside');
            upsideEl.textContent = (upside >= 0 ? '+' : '') + upside.toFixed(0) + '% ' + (upside >= 0 ? 'upside' : 'downside');
            upsideEl.className = 'dcf-change ' + (upside >= 0 ? 'positive' : 'negative');

            document.getElementById('dcfWeighted').textContent = '$' + dcfData.probability_weighted.weighted_iv_usd.toFixed(0);

            const grid = document.getElementById('assumptionGrid');
            if (grid) {
                grid.innerHTML = `
                    <div class="assumption-item">
                        <div class="label">Growth Rate</div>
                        <div class="value">${growth}%</div>
                    </div>
                    <div class="assumption-item">
                        <div class="label">WACC</div>
                        <div class="value">${wacc}%</div>
                    </div>
                    <div class="assumption-item">
                        <div class="label">Terminal Growth</div>
                        <div class="value">${terminal}%</div>
                    </div>
                    <div class="assumption-item">
                        <div class="label">Intrinsic Value</div>
                        <div class="value" style="color: #00d4aa;">$${result.iv.toFixed(0)}</div>
                    </div>
                    <div class="assumption-item">
                        <div class="label">Entry Price</div>
                        <div class="value" style="color: #00d4aa;">$${result.entryPrice.toFixed(0)}</div>
                    </div>
                `;
            }
        };

        window.switchScenario = function(scenario) {
            currentScenario = scenario;

            document.querySelectorAll('.scenario-tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.scenario === scenario);
            });

            const assumptions = dcfData.assumptions[scenario];
            const valuation = dcfData.valuation[scenario];

            document.getElementById('growthSlider').value = assumptions.growth_rates[0];
            document.getElementById('waccSlider').value = assumptions.wacc;
            document.getElementById('terminalSlider').value = assumptions.terminal_growth;

            const grid = document.getElementById('assumptionGrid');
            grid.innerHTML = `
                <div class="assumption-item">
                    <div class="label">Year 1 Growth</div>
                    <div class="value">${assumptions.growth_rates[0]}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">Year 5 Growth</div>
                    <div class="value">${assumptions.growth_rates[4]}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">FCF Margin</div>
                    <div class="value">${assumptions.fcf_margin}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">WACC</div>
                    <div class="value">${assumptions.wacc}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">Terminal Growth</div>
                    <div class="value">${assumptions.terminal_growth}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">Intrinsic Value</div>
                    <div class="value" style="color: #00d4aa;">$${valuation.intrinsic_value_usd.toFixed(0)}</div>
                </div>
            `;

            updateDCFDisplay();
        };

        function renderHistoricalGrowth() {
            const growth = dcfData.historical_growth;
            const selectedSource = growth.growth_rate_source;
            const grid = document.getElementById('growthGrid');

            const metrics = [
                { key: 'revenue_3yr_cagr', label: 'Revenue 3Y' },
                { key: 'revenue_4yr_cagr', label: 'Revenue 4Y' },
                { key: 'eps_3yr_cagr', label: 'EPS 3Y' },
                { key: 'eps_4yr_cagr', label: 'EPS 4Y' },
                { key: 'equity_3yr_cagr', label: 'Equity 3Y' },
                { key: 'equity_4yr_cagr', label: 'Equity 4Y' },
                { key: 'fcf_3yr_cagr', label: 'FCF 3Y' },
                { key: 'fcf_4yr_cagr', label: 'FCF 4Y' }
            ];

            grid.innerHTML = metrics.map(m => {
                const rate = growth[m.key];
                const isSelected = m.key === selectedSource;
                const colorClass = rate >= 0 ? 'positive' : 'negative';
                return `
                    <div class="growth-item ${isSelected ? 'selected' : ''}">
                        <div class="metric">${m.label}</div>
                        <div class="rate ${colorClass}">${rate >= 0 ? '+' : ''}${rate.toFixed(1)}%</div>
                    </div>
                `;
            }).join('');
        }

        function renderSensitivityMatrix() {
            const sens = dcfData.sensitivity;
            const table = document.getElementById('sensitivityMatrix');
            const currentPrice = dcfData.current_price;

            let html = '<tr><th>WACC \\ Term G</th>';
            sens.terminal_growth_range.forEach(tg => {
                html += `<th>${tg}%</th>`;
            });
            html += '</tr>';

            sens.wacc_range.forEach((wacc, i) => {
                html += `<tr><th>${wacc}%</th>`;
                sens.matrix_usd[i].forEach((val, j) => {
                    const isHighlight = wacc === dcfData.assumptions.base.wacc &&
                                       sens.terminal_growth_range[j] === dcfData.assumptions.base.terminal_growth;
                    const colorClass = val >= currentPrice ? 'above-current' : 'below-current';
                    html += `<td class="${isHighlight ? 'highlight' : colorClass}">$${val.toFixed(0)}</td>`;
                });
                html += '</tr>';
            });

            table.innerHTML = html;
        }

        initDCF();

        (function() {
            var growthSlider = document.getElementById('growthSlider');
            var waccSlider = document.getElementById('waccSlider');
            var terminalSlider = document.getElementById('terminalSlider');

            if (growthSlider) {
                growthSlider.oninput = window.updateDCFDisplay;
                growthSlider.onchange = window.updateDCFDisplay;
            }
            if (waccSlider) {
                waccSlider.oninput = window.updateDCFDisplay;
                waccSlider.onchange = window.updateDCFDisplay;
            }
            if (terminalSlider) {
                terminalSlider.oninput = window.updateDCFDisplay;
                terminalSlider.onchange = window.updateDCFDisplay;
            }
        })();

        // Initialize dashboard
        renderKPIs();
        renderGuidance();
    </script>
</body>
</html>
