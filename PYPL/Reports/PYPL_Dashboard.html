<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PayPal Holdings, Inc. (PYPL) Financial Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        .header h1 {
            font-size: 2.5rem;
            background: linear-gradient(90deg, #00d4aa, #00b894);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        .header p {
            color: #888;
            font-size: 1.1rem;
        }
        .overview-section {
            max-width: 1400px;
            margin: 0 auto 30px;
        }
        .overview-toggle {
            width: 100%;
            background: rgba(0, 212, 170, 0.1);
            border: 1px solid rgba(0, 212, 170, 0.3);
            border-radius: 12px;
            padding: 16px 24px;
            color: #00d4aa;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
        }
        .overview-toggle:hover {
            background: rgba(0, 212, 170, 0.2);
        }
        .overview-toggle .arrow {
            transition: transform 0.3s ease;
        }
        .overview-toggle.active .arrow {
            transform: rotate(180deg);
        }
        .overview-content {
            display: none;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-top: none;
            border-radius: 0 0 12px 12px;
            padding: 30px;
            margin-top: -12px;
        }
        .overview-content.active {
            display: block;
        }
        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
        }
        .overview-card {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .overview-card h3 {
            color: #00d4aa;
            font-size: 1.1rem;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .overview-card p {
            margin-bottom: 12px;
            line-height: 1.6;
        }
        .overview-card ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .overview-card li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            line-height: 1.5;
        }
        .overview-card li:last-child {
            border-bottom: none;
        }
        .overview-card.bull h3 { color: #00d4aa; }
        .overview-card.bear h3 { color: #ff6b6b; }
        .overview-card.risks h3 { color: #fdcb6e; }
        .risk-high { color: #ff6b6b; }
        .risk-moderate { color: #fdcb6e; }
        .risk-low { color: #00d4aa; }
        .revenue-stream {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .revenue-stream .percent {
            color: #00d4aa;
            font-weight: 600;
        }
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
        }
        .kpi-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 212, 170, 0.2);
        }
        .kpi-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #00d4aa;
            margin-bottom: 5px;
        }
        .kpi-label {
            font-size: 0.85rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .kpi-change {
            font-size: 0.9rem;
            margin-top: 5px;
        }
        .kpi-change.positive { color: #00d4aa; }
        .kpi-change.negative { color: #ff6b6b; }
        .guidance-section {
            max-width: 1400px;
            margin: 0 auto 30px;
        }
        .guidance-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .guidance-header h3 {
            color: #fff;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .guidance-header h3::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 20px;
            background: linear-gradient(180deg, #00d4aa, #00b894);
            border-radius: 2px;
        }
        .guidance-meta {
            font-size: 0.85rem;
            color: #888;
        }
        .guidance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .guidance-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 18px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.2s ease;
        }
        .guidance-card:hover {
            transform: translateY(-2px);
        }
        .guidance-metric {
            font-size: 0.8rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }
        .guidance-target {
            font-size: 1.4rem;
            font-weight: 600;
            color: #00d4aa;
            margin-bottom: 6px;
        }
        .guidance-period {
            font-size: 0.85rem;
            color: #e0e0e0;
            margin-bottom: 8px;
        }
        .guidance-vs-prior {
            display: inline-block;
            font-size: 0.75rem;
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: 500;
        }
        .guidance-vs-prior.raised {
            background: rgba(0, 212, 170, 0.15);
            color: #00d4aa;
        }
        .guidance-vs-prior.lowered {
            background: rgba(255, 107, 107, 0.15);
            color: #ff6b6b;
        }
        .guidance-vs-prior.maintained {
            background: rgba(255, 255, 255, 0.1);
            color: #888;
        }
        .guidance-vs-prior.new {
            background: rgba(99, 102, 241, 0.15);
            color: #818cf8;
        }
        .guidance-notes {
            font-size: 0.8rem;
            color: #666;
            margin-top: 8px;
            line-height: 1.4;
        }
        .guidance-commentary {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            padding: 16px 20px;
            border-left: 3px solid #00d4aa;
            font-style: italic;
            color: #b0b0b0;
            line-height: 1.6;
        }
        .guidance-commentary::before {
            content: '"';
            font-size: 1.5rem;
            color: #00d4aa;
            margin-right: 4px;
        }
        .section-title {
            font-size: 1.5rem;
            color: #fff;
            margin: 40px auto 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(0, 212, 170, 0.3);
            max-width: 1400px;
        }
        .charts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 25px;
            max-width: 1400px;
            margin: 0 auto;
        }
        .chart-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .chart-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .chart-header h3 {
            color: #fff;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .chart-header h3::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 20px;
            background: linear-gradient(180deg, #00d4aa, #00b894);
            border-radius: 2px;
        }
        .help-btn {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: rgba(0, 212, 170, 0.2);
            border: 1px solid #00d4aa;
            color: #00d4aa;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        .help-btn:hover {
            background: #00d4aa;
            color: #1a1a2e;
        }
        .chart-wrapper {
            position: relative;
            height: 300px;
        }
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .modal-overlay.active { display: flex; }
        .modal {
            background: linear-gradient(135deg, #1e2a4a 0%, #16213e 100%);
            border-radius: 16px;
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid rgba(0, 212, 170, 0.3);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }
        .modal-header {
            padding: 20px 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .modal-header h3 {
            color: #00d4aa;
            font-size: 1.4rem;
            margin: 0;
        }
        .modal-close {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid #ff6b6b;
            color: #ff6b6b;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-close:hover {
            background: #ff6b6b;
            color: #fff;
        }
        .modal-body {
            padding: 25px;
            line-height: 1.7;
        }
        .modal-body p { margin-bottom: 15px; }
        .modal-body strong { color: #00d4aa; }
        .modal-body ul { margin: 15px 0; padding-left: 20px; }
        .modal-body li { margin-bottom: 8px; }
        .metric-highlight {
            background: rgba(0, 212, 170, 0.1);
            border-left: 3px solid #00d4aa;
            padding: 12px 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        /* DCF Valuation Section */
        .dcf-section {
            max-width: 1400px;
            margin: 0 auto 40px;
        }
        .dcf-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .dcf-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease;
        }
        .dcf-card:hover {
            transform: translateY(-3px);
        }
        .dcf-card.highlight {
            background: rgba(0, 212, 170, 0.1);
            border-color: rgba(0, 212, 170, 0.3);
        }
        .dcf-label {
            font-size: 0.85rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }
        .dcf-value {
            font-size: 2.2rem;
            font-weight: bold;
            color: #00d4aa;
        }
        .dcf-card:not(.highlight) .dcf-value {
            color: #fff;
        }
        .dcf-change {
            font-size: 1rem;
            margin-top: 8px;
            font-weight: 600;
        }
        .dcf-change.positive { color: #00d4aa; }
        .dcf-change.negative { color: #ff6b6b; }
        .dcf-sublabel {
            font-size: 0.8rem;
            color: #666;
            margin-top: 8px;
        }
        .dcf-warning {
            background: rgba(253, 203, 110, 0.15);
            border: 1px solid rgba(253, 203, 110, 0.4);
            border-radius: 8px;
            padding: 12px 16px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #fdcb6e;
        }
        .warning-icon {
            font-size: 1.2rem;
        }
        .dcf-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .slider-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .slider-group label {
            font-size: 0.95rem;
            color: #e0e0e0;
            display: flex;
            justify-content: space-between;
        }
        .slider-group label span {
            color: #00d4aa;
            font-weight: 600;
        }
        .slider-group input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: rgba(255, 255, 255, 0.1);
            outline: none;
        }
        .slider-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #00d4aa;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .slider-group input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }
        .slider-group input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #00d4aa;
            cursor: pointer;
            border: none;
        }
        .slider-hint {
            font-size: 0.8rem;
            color: #666;
        }
        .scenario-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .scenario-tab {
            padding: 10px 24px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: transparent;
            color: #888;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.2s;
        }
        .scenario-tab:hover {
            border-color: rgba(0, 212, 170, 0.5);
            color: #e0e0e0;
        }
        .scenario-tab.active {
            background: rgba(0, 212, 170, 0.15);
            border-color: #00d4aa;
            color: #00d4aa;
        }
        .scenario-details {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .scenario-details h4 {
            color: #00d4aa;
            margin-bottom: 15px;
        }
        .assumption-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        .assumption-item {
            text-align: center;
        }
        .assumption-item .label {
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 4px;
        }
        .assumption-item .value {
            font-size: 1.1rem;
            color: #e0e0e0;
            font-weight: 500;
        }
        .sensitivity-section {
            margin-bottom: 30px;
        }
        .sensitivity-section h4 {
            color: #e0e0e0;
            margin-bottom: 15px;
        }
        .sensitivity-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            overflow: hidden;
        }
        .sensitivity-table th,
        .sensitivity-table td {
            padding: 12px 16px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .sensitivity-table th {
            background: rgba(0, 212, 170, 0.1);
            color: #00d4aa;
            font-weight: 600;
        }
        .sensitivity-table td {
            color: #e0e0e0;
        }
        .sensitivity-table td.highlight {
            background: rgba(0, 212, 170, 0.15);
            color: #00d4aa;
            font-weight: 600;
        }
        .sensitivity-table td.below-current {
            color: #ff6b6b;
        }
        .sensitivity-table td.above-current {
            color: #00d4aa;
        }
        .historical-growth {
            margin-bottom: 30px;
        }
        .historical-growth h4 {
            color: #e0e0e0;
            margin-bottom: 15px;
        }
        .growth-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
        }
        .growth-item {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .growth-item .metric {
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 6px;
        }
        .growth-item .rate {
            font-size: 1.2rem;
            font-weight: 600;
        }
        .growth-item .rate.positive { color: #00d4aa; }
        .growth-item .rate.negative { color: #ff6b6b; }
        .growth-item.selected {
            border-color: #00d4aa;
            background: rgba(0, 212, 170, 0.1);
        }
        .dcf-download {
            text-align: center;
            margin-top: 30px;
        }
        .download-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 14px 28px;
            background: rgba(0, 212, 170, 0.15);
            border: 1px solid #00d4aa;
            border-radius: 8px;
            color: #00d4aa;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.2s;
        }
        .download-btn:hover {
            background: #00d4aa;
            color: #1a1a2e;
        }
        .download-icon {
            font-size: 1.2rem;
        }
        @media (max-width: 768px) {
            .charts-container { grid-template-columns: 1fr; }
            .overview-grid { grid-template-columns: 1fr; }
            .header h1 { font-size: 1.8rem; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>PayPal Holdings, Inc. (PYPL)</h1>
        <p>Digital Payments Platform Financial Dashboard</p>
    </div>

    <!-- Investment Overview Section -->
    <div class="overview-section">
        <button class="overview-toggle" onclick="toggleOverview()">
            <span>Investment Overview & Analysis</span>
            <span class="arrow">▼</span>
        </button>
        <div class="overview-content" id="overviewContent">
            <div class="overview-grid">
                <!-- Company Overview -->
                <div class="overview-card">
                    <h3>Company Overview</h3>
                    <p>PayPal is a global digital payments platform operating a two-sided network connecting 434 million active accounts across approximately 200 markets. The company facilitates online and offline transactions through branded checkout solutions (PayPal, Venmo), unbranded payment processing (Braintree, PayPal Complete Payments), buy now pay later products, merchant financing, and person-to-person payment services.</p>
                </div>

                <!-- Business Model -->
                <div class="overview-card">
                    <h3>Business Model</h3>
                    <p>PayPal generates revenue primarily from transaction fees charged to merchants and consumers for payment processing, supplemented by value-added services including lending, currency conversion, and partnerships. The company processed $1.68 trillion in total payment volume in 2024, up 10% year-over-year.</p>
                    <ul>
                        <li class="revenue-stream">
                            <span>Transaction Revenues</span>
                            <span class="percent">92%</span>
                        </li>
                        <li class="revenue-stream">
                            <span>Other Value Added Services</span>
                            <span class="percent">8%</span>
                        </li>
                    </ul>
                </div>

                <!-- Competitive Position -->
                <div class="overview-card">
                    <h3>Competitive Position</h3>
                    <p><strong>Market Position:</strong> Leading online payment services provider with 47.4% market share, though facing intensifying competition from digital wallets and payment processors.</p>
                    <p><strong>Main Competitors:</strong> Apple Pay (14.2%), Stripe (8.1%), Google Pay, Block/Square, Adyen, Affirm</p>
                    <p><strong>Key Moat Factors:</strong></p>
                    <ul>
                        <li>Network Effects (strong): 434M+ active accounts create two-sided value</li>
                        <li>Brand Recognition & Trust (strong): Decades of consumer trust</li>
                        <li>Data & Technology (moderate-strong): Transaction Graph AI platform</li>
                        <li>Scale & Global Reach (strong): 200 markets, $1.68T TPV</li>
                    </ul>
                </div>

                <!-- Growth Drivers -->
                <div class="overview-card">
                    <h3>Growth Drivers</h3>
                    <ul>
                        <li>Fastlane accelerated checkout: 50% better conversion, expanding via partnerships</li>
                        <li>Venmo monetization: 20% revenue growth, expanding beyond P2P</li>
                        <li>BNPL expansion: targeting $40B+ TPV for 2025, growing 20%+ YoY</li>
                        <li>PYUSD stablecoin: supply grew from $500M to $3.9B in 2025</li>
                        <li>AI-driven personalization via Transaction Graph platform</li>
                        <li>Strategic partnerships: Google, Coinbase, J.P. Morgan</li>
                    </ul>
                </div>

                <!-- Key Risks -->
                <div class="overview-card risks">
                    <h3>Key Risks</h3>
                    <ul>
                        <li><span class="risk-high">HIGH:</span> Competition from Apple Pay/Google Pay eroding branded checkout share</li>
                        <li><span class="risk-high">HIGH:</span> Active account growth stagnation (2% YoY vs historical double-digit)</li>
                        <li><span class="risk-high">HIGH:</span> Extensive regulatory oversight across multiple jurisdictions</li>
                        <li><span class="risk-high">HIGH:</span> Cybersecurity and fraud exposure</li>
                        <li><span class="risk-moderate">MODERATE:</span> Declining take rates and margin pressure</li>
                        <li><span class="risk-moderate">MODERATE:</span> Currency exposure from global operations</li>
                    </ul>
                </div>

                <!-- Bull Case -->
                <div class="overview-card bull">
                    <h3>Bull Case</h3>
                    <ul>
                        <li>Turnaround momentum under CEO Alex Chriss: +15-16% EPS growth guidance</li>
                        <li>Valuation disconnect: ~10x forward P/E despite strong FCF generation</li>
                        <li>Aggressive capital return: $6B buybacks + new dividend</li>
                        <li>Fastlane breakthrough potential with 50% conversion improvement</li>
                        <li>Venmo monetization inflection: 20% revenue growth in 2025</li>
                        <li>PYUSD stablecoin uniquely positions PayPal in crypto payments</li>
                        <li>AI-driven revenue opportunities from Transaction Graph platform</li>
                    </ul>
                </div>

                <!-- Bear Case -->
                <div class="overview-card bear">
                    <h3>Bear Case</h3>
                    <ul>
                        <li>Structural decline in branded checkout from Apple/Google Pay integration</li>
                        <li>Active account growth stalled (2% YoY) signals market saturation</li>
                        <li>Execution risk: multiple simultaneous initiatives create complexity</li>
                        <li>Stripe growing faster (12.3% TPV vs PayPal's 6.1%)</li>
                        <li>Regulatory overhang across 200 markets increases compliance costs</li>
                        <li>Limited offline penetration vs card-based competitors</li>
                        <li>Macro headwinds: consumer spending slowdown, e-commerce normalization</li>
                    </ul>
                </div>

                <!-- Recent Developments -->
                <div class="overview-card">
                    <h3>Recent Developments</h3>
                    <ul>
                        <li><strong>Q3 2025:</strong> Earnings beat, raised guidance to $5.35-5.39 EPS (+15-16%)</li>
                        <li><strong>Q3 2025:</strong> First-ever quarterly dividend ($0.14/share) + $6B buyback</li>
                        <li><strong>Oct 2025:</strong> Agentic Commerce Protocol adoption for ChatGPT payments</li>
                        <li><strong>Jun 2025:</strong> PYUSD expansion to Stellar network announced</li>
                        <li><strong>Feb 2025:</strong> J.P. Morgan partnership for Fastlane in UK/Europe</li>
                        <li><strong>Late 2024:</strong> Launched Transaction Graph AI platform</li>
                        <li><strong>Late 2023:</strong> CEO transition to Alex Chriss from Intuit</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- KPI Cards -->
    <div class="kpi-grid" id="kpiGrid"></div>

    <!-- Management Guidance Section -->
    <div class="guidance-section" id="guidanceSection">
        <div class="guidance-header">
            <h3>Management Guidance</h3>
            <span class="guidance-meta">As of <span id="guidanceAsOf">Q3 2025 Earnings</span> | <span id="guidanceFY">FY2025</span></span>
        </div>
        <div class="guidance-grid" id="guidanceGrid"></div>
        <div class="guidance-commentary" id="guidanceCommentary"></div>
    </div>

    <!-- Financial Performance Charts -->
    <h2 class="section-title">Financial Performance</h2>
    <div class="charts-container">
        <div class="chart-card">
            <div class="chart-header">
                <h3>Revenue & Growth</h3>
                <button class="help-btn" onclick="openModal('revenue')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="revenueChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Quarterly Revenue Trend</h3>
                <button class="help-btn" onclick="openModal('quarterlyRevenue')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="quarterlyRevenueChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Operating & Net Margins</h3>
                <button class="help-btn" onclick="openModal('margins')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="marginsChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Net Income & EPS</h3>
                <button class="help-btn" onclick="openModal('netIncome')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="netIncomeChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Free Cash Flow</h3>
                <button class="help-btn" onclick="openModal('fcf')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="fcfChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Quarterly EPS Trend</h3>
                <button class="help-btn" onclick="openModal('quarterlyEPS')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="quarterlyEPSChart"></canvas>
            </div>
        </div>
    </div>

    <!-- Payment Platform Metrics -->
    <h2 class="section-title">Payment Platform Metrics</h2>
    <div class="charts-container">
        <div class="chart-card">
            <div class="chart-header">
                <h3>Total Payment Volume (TPV)</h3>
                <button class="help-btn" onclick="openModal('tpv')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="tpvChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Take Rate Trend</h3>
                <button class="help-btn" onclick="openModal('takeRate')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="takeRateChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Active Accounts</h3>
                <button class="help-btn" onclick="openModal('activeAccounts')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="activeAccountsChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Transactions per Active Account</h3>
                <button class="help-btn" onclick="openModal('transactionsPerAccount')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="transactionsPerAccountChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Payment Transactions</h3>
                <button class="help-btn" onclick="openModal('transactions')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="transactionsChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Quarterly TPV Trend</h3>
                <button class="help-btn" onclick="openModal('quarterlyTPV')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="quarterlyTPVChart"></canvas>
            </div>
        </div>
    </div>

    <!-- DCF Valuation Section -->
    <h2 class="section-title">DCF Valuation</h2>
    <div class="dcf-section">
        <!-- Valuation Summary Cards -->
        <div class="dcf-summary">
            <div class="dcf-card highlight">
                <div class="dcf-label">Intrinsic Value</div>
                <div class="dcf-value" id="dcfIV">$132</div>
                <div class="dcf-change positive" id="dcfUpside">+50% upside</div>
            </div>
            <div class="dcf-card">
                <div class="dcf-label">Entry Price (15% CAGR)</div>
                <div class="dcf-value" id="dcfEntry">$77</div>
                <div class="dcf-sublabel">Buy below for 15% annual return</div>
            </div>
            <div class="dcf-card">
                <div class="dcf-label">Current Price</div>
                <div class="dcf-value" id="dcfCurrent">$88</div>
            </div>
            <div class="dcf-card">
                <div class="dcf-label">Prob-Weighted IV</div>
                <div class="dcf-value" id="dcfWeighted">$132</div>
                <div class="dcf-sublabel">25% Bull / 50% Base / 25% Bear</div>
            </div>
        </div>

        <!-- Growth Rate Warning -->
        <div class="dcf-warning" id="growthWarning">
            <span class="warning-icon">&#9888;</span>
            <span id="warningText">Equity CAGR is negative/low due to share buybacks reducing book value. Using revenue/FCF as primary growth indicator.</span>
        </div>

        <!-- Interactive Sliders -->
        <div class="dcf-controls">
            <div class="slider-group">
                <label>Growth Rate: <span id="growthValue">7.5%</span></label>
                <input type="range" id="growthSlider" min="0" max="30" value="7.5" step="0.5">
                <div class="slider-hint" id="growthHint">Based on blended revenue/FCF</div>
            </div>
            <div class="slider-group">
                <label>WACC: <span id="waccValue">9.0%</span></label>
                <input type="range" id="waccSlider" min="6" max="18" value="9.0" step="0.5">
            </div>
            <div class="slider-group">
                <label>Terminal Growth: <span id="terminalValue">3.0%</span></label>
                <input type="range" id="terminalSlider" min="0" max="5" value="3.0" step="0.5">
            </div>
        </div>

        <!-- Scenario Tabs -->
        <div class="scenario-tabs">
            <button class="scenario-tab active" data-scenario="base" onclick="switchScenario('base')">Base Case</button>
            <button class="scenario-tab" data-scenario="bull" onclick="switchScenario('bull')">Bull Case</button>
            <button class="scenario-tab" data-scenario="bear" onclick="switchScenario('bear')">Bear Case</button>
        </div>

        <!-- Scenario Details -->
        <div class="scenario-details" id="scenarioDetails">
            <div class="scenario-assumptions">
                <h4>Assumptions</h4>
                <div class="assumption-grid" id="assumptionGrid"></div>
            </div>
        </div>

        <!-- Sensitivity Table -->
        <div class="sensitivity-section">
            <h4>Sensitivity Analysis: Intrinsic Value by WACC & Terminal Growth</h4>
            <table class="sensitivity-table" id="sensitivityMatrix"></table>
        </div>

        <!-- Historical Growth Rates -->
        <div class="historical-growth">
            <h4>Historical Growth Rates (CAGR)</h4>
            <div class="growth-grid" id="growthGrid"></div>
        </div>

        <!-- Download Button -->
        <div class="dcf-download">
            <a href="PYPL_DCF_Model.xlsx" class="download-btn" download>
                <span class="download-icon">&#8681;</span> Download Excel Model
            </a>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal-overlay" id="modalOverlay" onclick="closeModal(event)">
        <div class="modal">
            <div class="modal-header">
                <h3 id="modalTitle"></h3>
                <button class="modal-close" onclick="closeModal()">×</button>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

    <script>
        // EMBEDDED CSV DATA
        const csvData = `Period,Revenue,OperatingIncome,NetIncome,EPS,FreeCashFlow,TPV,PaymentTransactions,ActiveAccounts,TransactionsPerActiveAccount,TakeRate,ShareholdersEquity,TotalDebt,CashAndEquivalents,SharesOutstanding,RevenueGrowthYoY,NetIncomeGrowthYoY,OperatingMargin,NetMargin
FY2015,9248,1461,1228,1.00,1478,282,4.9,179,27.4,3.28,12529,,,1228,,,15.8,13.3
FY2016,10842,1586,1401,1.15,2025,354,6.1,197,31.0,3.06,,,,1220,17.2,14.1,14.6,12.9
FY2017,13094,2050,1795,1.47,2886,451,7.6,227,33.5,2.90,16012,2427,5722,1222,20.8,28.1,15.7,13.7
FY2018,15451,2230,2057,1.71,4310,578,9.5,267,35.6,2.67,,,,1202,18.0,14.6,14.4,13.3
FY2019,17772,2340,2459,2.07,4787,712,11.8,305,38.7,2.50,,,,1188,15.0,19.5,13.2,13.8
FY2020,21454,2639,4202,3.54,5859,936,15.4,377,40.9,2.29,,,,1188,20.7,70.9,12.3,19.6
FY2021,25371,3924,4169,3.52,5416,1254,19.3,426,45.3,2.02,21727,,,1184,18.2,-0.8,15.5,16.4
FY2022,27518,3837,2419,2.09,4443,1360,22.3,435,51.3,2.02,20274,,,1158,8.5,-42.0,13.9,8.8
FY2023,29771,5028,4246,3.84,4220,1529,24.9,426,58.4,1.95,21051,9676,14060,1107,8.2,75.5,16.9,14.3
FY2024,31797,5325,4147,3.99,6767,1680,26.3,434,60.6,1.89,20417,10574,10823,1039,6.8,-2.3,16.7,13.0
FY2025E,34137,6535,5385,5.48,5574,1750,28.6,435,65.7,1.95,,,,,7.4,29.9,19.1,15.8
Q1 2020,4618,398,84,0.07,,191,3.3,325,,2.42,,,,,12.3,-87.1,8.6,1.8
Q2 2020,5258,731,1513,1.29,,222,3.7,346,,2.37,,,,,22.2,,,13.9,28.8
Q3 2020,5459,977,1021,0.86,,247,4.0,361,,2.21,,,,,24.7,,17.9,18.7
Q1 2021,6033,1058,1098,0.92,,285,4.4,392,,2.12,,,,,30.6,1207.1,17.5,18.2
Q2 2021,6238,1151,1183,1.00,,311,4.7,403,,2.01,,,,,18.6,-21.8,18.5,19.0
Q3 2021,6182,1158,1144,0.96,,310,4.9,416,,1.99,,,,,13.2,12.0,18.7,18.5
Q1 2022,6483,855,509,0.44,,323,5.3,429,,2.01,,,,,7.5,-53.6,13.2,7.9
Q2 2022,6806,929,865,0.76,,340,5.8,433,,2.00,,,,,9.1,-26.9,13.7,12.7
Q3 2022,6850,779,559,0.49,,337,6.0,432,,2.03,,,,,10.8,-51.2,11.4,8.2
Q1 2023,7040,1024,1105,1.01,,355,6.0,433,,1.98,,,,,8.6,117.1,14.5,15.7
Q2 2023,7287,1262,1031,0.94,,377,5.9,428,,1.93,,,,,7.1,19.2,17.3,14.1
Q3 2023,7418,1312,1020,0.93,,387,6.3,428,,1.92,,,,,8.3,82.5,17.7,13.7
Q1 2024,7699,1248,1199,1.17,,391,6.5,427,,1.97,,,,,9.4,8.5,16.2,15.6
Q2 2024,7885,1444,1128,1.10,,401,6.6,429,,1.97,,,,,8.2,9.4,18.3,14.3
Q3 2024,7847,1391,1015,1.00,,423,6.5,432,,1.86,,,,,5.8,-0.5,17.7,12.9
Q1 2025,8301,1558,1324,1.32,964,421,6.8,432,,1.97,,,,,7.8,10.4,18.8,15.9
Q2 2025,8348,1630,1344,1.36,692,424,6.8,431,,1.97,,,,,5.9,19.1,19.5,16.1
Q3 2025,8538,1647,1367,1.40,1718,435,7.0,433,,1.96,,,,,8.8,34.7,19.3,16.0`;

        // EMBEDDED ANALYSIS JSON
        const analysis = {
  "ticker": "PYPL",
  "company_name": "PayPal Holdings, Inc.",
  "analysis_date": "2026-01-22",
  "overview": "PayPal is a global digital payments platform operating a two-sided network connecting 434 million active accounts across approximately 200 markets. The company facilitates online and offline transactions through branded checkout solutions (PayPal, Venmo), unbranded payment processing (Braintree, PayPal Complete Payments), buy now pay later products, merchant financing, and person-to-person payment services. PayPal earns revenue primarily from transaction fees, with additional income from value-added services including currency conversion, instant transfers, cryptocurrency transactions, consumer and merchant credit products, and interest on customer balances.",
  "business_model": {
    "summary": "PayPal generates revenue primarily from transaction fees charged to merchants and consumers for payment processing, supplemented by value-added services including lending, currency conversion, and partnerships. The company processed $1.68 trillion in total payment volume in 2024, up 10% year-over-year.",
    "revenue_streams": [
      {
        "name": "Transaction Revenues",
        "percent": 92,
        "trend": "stable",
        "description": "Fees charged for completing payment transactions based on volume processed, primary revenue driver"
      },
      {
        "name": "Other Value Added Services",
        "percent": 8,
        "trend": "growing",
        "description": "Partnership revenue, interest and fees from consumer/merchant credit products, interest on customer balances, subscription fees, gateway services"
      }
    ],
    "key_products": [
      "PayPal branded checkout",
      "Venmo (P2P and merchant payments)",
      "Braintree (unbranded payment processing)",
      "PayPal Pay Later (BNPL)",
      "Xoom (international remittance)",
      "Zettle (point-of-sale)",
      "PayPal Working Capital & Business Loans",
      "PYUSD stablecoin",
      "Fastlane (accelerated guest checkout)"
    ],
    "customer_type": "Two-sided platform serving both consumers (B2C) and merchants (B2B) of all sizes",
    "geographic_mix": "Global presence in approximately 200 markets; U.S. remains largest market with significant operations in Europe and Asia-Pacific"
  },
  "competitive_position": {
    "market_position": "Leading online payment services provider with 47.4% market share, though facing intensifying competition from digital wallets (Apple Pay, Google Pay), payment processors (Stripe, Adyen), and embedded finance solutions",
    "moat_factors": [
      {
        "factor": "Network Effects",
        "strength": "strong",
        "description": "Two-sided platform with 434M+ active accounts creates value for both consumers and merchants; more merchants attract more consumers and vice versa"
      },
      {
        "factor": "Brand Recognition & Trust",
        "strength": "strong",
        "description": "PayPal, Venmo, and Braintree are well-recognized trusted brands with decades of consumer trust in digital payments and buyer/seller protection programs"
      },
      {
        "factor": "Data & Proprietary Technology",
        "strength": "moderate-strong",
        "description": "Transaction data from both sides of platform enables fraud detection, risk management, personalization, and product innovation (Transaction Graph AI platform)"
      },
      {
        "factor": "Regulatory Licenses",
        "strength": "moderate",
        "description": "Holds money transmitter licenses across U.S. states and regulatory approvals in international markets; Luxembourg credit institution license for EU operations"
      },
      {
        "factor": "Scale & Global Reach",
        "strength": "strong",
        "description": "Operates in 200 markets, processes payments in 140 currencies, handles $1.68T annual TPV with established infrastructure"
      },
      {
        "factor": "Ecosystem Lock-in",
        "strength": "moderate",
        "description": "PayPal/Venmo account balances, stored payment methods, transaction history, and integrated merchant relationships create switching costs, though lower than platform ecosystems like Apple"
      }
    ],
    "competitors": [
      "Apple Pay (digital wallet, 14.2% market share)",
      "Google Pay (digital wallet)",
      "Stripe (payment processor, 8.1% market share, growing faster)",
      "Block/Square (merchant services, Cash App)",
      "Adyen (global payment processor)",
      "Affirm (BNPL specialist)",
      "Traditional payment networks (Visa, Mastercard)",
      "Banks and financial institutions",
      "Emerging embedded finance players"
    ],
    "weaknesses": [
      "Losing branded checkout share to Apple Pay and integrated wallets at point of sale",
      "Braintree/unbranded growth comes at lower margins than branded checkout",
      "Active account growth has stalled (2% YoY vs historical double-digit growth)",
      "Declining take rates due to competitive pressure and shift to lower-margin unbranded processing",
      "Limited offline presence compared to card-based competitors",
      "Venmo monetization still below potential despite strong user engagement"
    ]
  },
  "growth_drivers": [
    "Fastlane accelerated checkout showing 50% better conversion rates and 35% faster checkout times, expanding via partnerships (J.P. Morgan, Adyen)",
    "Venmo monetization acceleration with 20% revenue growth in 2025; expanding use cases beyond P2P to merchant payments and debit card usage",
    "BNPL expansion: targeting $40B+ in TPV for 2025, growing 20%+ YoY; integrated into branded checkout experiences",
    "PYUSD stablecoin growth: supply increased from $500M to $3.9B in 2025; expanding to Stellar network for cross-border payments and 'PayFi' working capital solutions",
    "AI-driven personalization via Transaction Graph platform launched late 2025 to predict purchases and enable targeted merchant discounts",
    "International expansion and localization efforts in key markets",
    "Strategic partnerships including Google (agentic commerce), Coinbase (stablecoin adoption), and expanded merchant acquirer relationships",
    "Merchant services ecosystem including risk management, fraud protection, and business financing to deepen merchant engagement"
  ],
  "risks": {
    "business": [
      {
        "risk": "Intense competition from Apple Pay, Google Pay, and embedded finance eroding branded checkout share",
        "severity": "high",
        "description": "Digital wallets integrated into smartphones and browsers provide frictionless checkout experiences that threaten PayPal's value proposition, particularly for offline and in-app purchases"
      },
      {
        "risk": "Active account growth stagnation",
        "severity": "high",
        "description": "Active accounts grew only 2% in 2024 vs. historical double-digit growth, signaling market saturation in developed markets and challenges attracting new users"
      },
      {
        "risk": "Declining take rates and margin pressure",
        "severity": "moderate-high",
        "description": "Mix shift toward lower-margin unbranded processing (Braintree) and competitive pricing pressure on transaction fees threatening profitability"
      },
      {
        "risk": "eBay relationship wind-down",
        "severity": "moderate",
        "description": "Historical dependence on eBay has diminished but legacy relationship changes continue to impact comparisons"
      },
      {
        "risk": "Venmo monetization challenges",
        "severity": "moderate",
        "description": "Despite strong engagement, converting P2P usage to profitable merchant payments and services has been slower than expected"
      }
    ],
    "financial": [
      {
        "risk": "Currency exposure",
        "severity": "moderate",
        "description": "Global operations expose company to FX fluctuations; strong dollar has created headwinds to international revenue growth"
      },
      {
        "risk": "Credit risk from BNPL and lending products",
        "severity": "moderate",
        "description": "Expansion of buy now pay later and merchant financing creates exposure to consumer and merchant credit losses, particularly in economic downturn"
      }
    ],
    "regulatory": [
      {
        "risk": "Extensive regulatory oversight across multiple jurisdictions",
        "severity": "high",
        "description": "Subject to money transmitter regulations, AML/KYC requirements, consumer protection laws, and data privacy regulations globally; complexity increases with geographic expansion"
      },
      {
        "risk": "BNPL regulatory uncertainty",
        "severity": "moderate",
        "description": "Evolving regulatory treatment of buy now pay later products could impose new compliance costs or product restrictions; CFPB withdrew BNPL rule in May 2025 but future regulation remains uncertain"
      },
      {
        "risk": "PYUSD stablecoin regulation",
        "severity": "moderate",
        "description": "Cryptocurrency and stablecoin regulatory frameworks continue to evolve; expansion to Stellar requires NYDFS approval and ongoing compliance"
      },
      {
        "risk": "Interchange fee regulation",
        "severity": "moderate",
        "description": "EU caps on interchange fees and potential similar regulations in other markets could impact revenue from card-based transactions"
      }
    ],
    "macro": [
      {
        "risk": "Consumer spending sensitivity",
        "severity": "moderate",
        "description": "Transaction volume and payment frequency correlate with consumer spending patterns; economic downturn would reduce TPV growth"
      },
      {
        "risk": "E-commerce growth slowdown",
        "severity": "moderate",
        "description": "Post-pandemic normalization has slowed e-commerce growth rates; PayPal's revenue tied to online commerce volumes"
      }
    ],
    "execution": [
      {
        "risk": "Technology transformation and platform modernization",
        "severity": "moderate",
        "description": "Ongoing investments in 'One PayPal platform' and system upgrades are costly, complex, and carry execution risk while diverting resources from product innovation"
      },
      {
        "risk": "Cybersecurity and fraud",
        "severity": "high",
        "description": "As a payment platform handling sensitive financial data, PayPal is a high-value target for cyberattacks; any breach could result in significant financial and reputational damage"
      }
    ]
  },
  "macro_factors": {
    "industry_outlook": "Digital payments continue to grow globally as cash and check usage declines, though growth rates have normalized post-pandemic; increasing competition from tech giants and fintech disruptors",
    "cyclicality": "Moderate cyclicality tied to consumer spending and e-commerce volumes; discretionary purchases and transaction frequency decline in recessions",
    "interest_rate_sensitivity": "Moderate sensitivity: higher rates benefit interest income on customer balances and merchant/consumer credit products but may reduce consumer spending and TPV growth",
    "key_input_costs": [
      "Transaction processing fees",
      "Cloud infrastructure and data center costs",
      "Customer acquisition and marketing",
      "Technology development and talent"
    ]
  },
  "recent_developments": [
    {
      "date": "2025-Q3",
      "event": "Q3 2025 earnings beat: Revenue $8.42B (+7% YoY), EPS $1.34 (+12% YoY); raised full-year guidance to $5.35-5.39 EPS (+15-16%)"
    },
    {
      "date": "2025-Q3",
      "event": "Announced first-ever quarterly dividend ($0.14/share) and $6B share buyback program for FY2025"
    },
    {
      "date": "2025-10-28",
      "event": "Announced adoption of Agentic Commerce Protocol (ACP) to enable PayPal payments inside ChatGPT"
    },
    {
      "date": "2025-06-11",
      "event": "PYUSD stablecoin expansion to Stellar network announced (pending NYDFS approval) for cross-border payments and PayFi use cases"
    },
    {
      "date": "2025-02-25",
      "event": "Expanded partnership with J.P. Morgan Payments to launch Fastlane in UK and European markets and expand merchant acquiring"
    },
    {
      "date": "2025-01-08",
      "event": "Venmo partnership with Bilt announced to add rent, mortgage, and neighborhood merchant payments"
    },
    {
      "date": "2025-01-06",
      "event": "Launched new advertising analytics tools leveraging Transaction Graph AI platform"
    },
    {
      "date": "2024-12-15",
      "event": "Filed applications to establish PayPal Bank, a Utah-chartered industrial loan company for small business lending"
    },
    {
      "date": "2024-Late",
      "event": "Launched Transaction Graph AI platform using proprietary transaction data to predict customer purchases and personalize offers"
    },
    {
      "date": "2023-Late",
      "event": "CEO transition: Alex Chriss (from Intuit) replaced Dan Schulman, initiating strategic pivot toward profitability over growth"
    }
  ],
  "guidance": {
    "as_of": "Q3 2025 Earnings (October 28, 2025)",
    "fiscal_year": "FY2025",
    "items": [
      {
        "metric": "Non-GAAP EPS",
        "target": "$5.35 - $5.39",
        "period": "FY2025",
        "vs_prior": "raised",
        "notes": "Implies 15-16% YoY growth; raised from prior guidance due to Q3 beat and operational efficiency gains"
      },
      {
        "metric": "Transaction Margin",
        "target": "$15.45B - $15.55B",
        "period": "FY2025",
        "vs_prior": "raised",
        "notes": "Expects 5-6% YoY growth in transaction margin"
      },
      {
        "metric": "BNPL TPV",
        "target": "~$40B",
        "period": "FY2025",
        "vs_prior": "maintained",
        "notes": "Growing at over 20% YoY"
      },
      {
        "metric": "Share Repurchases",
        "target": "~$6B",
        "period": "FY2025",
        "vs_prior": "maintained",
        "notes": "Aggressive capital return program; approximately $6B in buybacks for fiscal year 2025"
      },
      {
        "metric": "Quarterly Dividend",
        "target": "$0.14/share",
        "period": "Quarterly",
        "vs_prior": "new",
        "notes": "First-ever dividend initiated in 2025"
      }
    ],
    "management_commentary": "CEO Alex Chriss emphasized diversified growth strategy across branded checkout, unbranded processing, and value-added services. Focus on profitability and operational efficiency under new leadership vs. prior focus on user growth. Company highlighting AI initiatives (Transaction Graph), Fastlane momentum, and PYUSD expansion as key 2026 priorities. CFO noted Braintree TPV growth turning positive in Q3 after merchant renegotiation headwinds."
  },
  "bull_case": [
    "Turnaround momentum under new CEO Alex Chriss: shifting focus from user growth to profitability driving margin expansion and strong EPS growth (+15-16% guidance for FY2025)",
    "Valuation disconnect: Trading at only ~10x forward P/E despite 15% EPS growth and $6B+ annual free cash flow generation; significant upside if multiple re-rates to market average",
    "Aggressive capital return: $6B buybacks in 2025 plus new dividend provide attractive shareholder returns and reduce share count by ~10%+ annually",
    "Fastlane breakthrough: Early results showing 50% conversion improvement and 35% faster checkout; partnerships with Adyen and J.P. Morgan could scale distribution rapidly and recapture checkout share from Apple/Google Pay",
    "Venmo monetization inflection: 20% revenue growth in 2025 with expanding merchant acceptance, debit card usage, and partnership with Bilt for rent/mortgage payments unlocking large addressable market",
    "PYUSD stablecoin potential: Supply growth from $500M to $3.9B in 2025 positions PayPal uniquely in crypto payments; Stellar expansion enables cross-border remittances and PayFi working capital at scale",
    "AI-driven revenue opportunities: Transaction Graph platform and advertising tools create new high-margin revenue streams from merchant data monetization",
    "Defensive moat remains strong: 434M active accounts, trusted brand, regulatory licenses, and two-sided network effects provide durable competitive advantages despite new competition"
  ],
  "bear_case": [
    "Structural decline in branded checkout: Apple Pay, Google Pay, and browser autofill eroding PayPal button usage; shift to unbranded Braintree processing dilutes margins and weakens brand moat",
    "Active account growth stalled: Only 2% YoY growth signals market saturation and difficulty competing for new users against integrated wallet solutions; declining engagement per account",
    "Execution risk on multiple fronts: Simultaneous platform modernization, AI integration, Fastlane scaling, PYUSD expansion, and international growth create operational complexity and resource constraints",
    "Competitive intensity accelerating: Stripe growing faster (12.3% TPV growth vs PayPal's 6.1%) with superior developer experience and lower pricing; embedded finance reducing need for third-party payment processors",
    "Regulatory overhang: Extensive compliance requirements across 200 markets increase costs; BNPL, stablecoin, and data privacy regulations create uncertainty and potential restrictions",
    "Limited offline penetration: Despite debit/credit card offerings, PayPal lags competitors in point-of-sale acceptance where consumer payment behavior is shifting",
    "Macro headwinds: Consumer spending slowdown, e-commerce normalization, and FX headwinds pressure TPV growth; BNPL credit losses could spike in recession",
    "Venmo monetization slower than expected: Despite years of effort, revenue contribution remains modest relative to user base; merchant adoption challenged by entrenched competitors and low interchange fees"
  ],
  "key_metrics_to_watch": [
    "Active account growth rate (currently 2% YoY, need acceleration to signal renewed user acquisition momentum)",
    "Monthly active accounts (new metric emphasizing engagement over total accounts)",
    "Transaction margin and take rate trends (indicators of pricing power and product mix)",
    "Branded checkout vs. unbranded processing mix (shift to Braintree dilutes margins)",
    "Venmo revenue growth and percentage of total revenue",
    "Fastlane merchant adoption and conversion rate improvements",
    "BNPL TPV growth and credit loss rates",
    "PYUSD stablecoin supply and transaction volumes",
    "Free cash flow conversion and capital allocation (buybacks, dividend growth)",
    "Customer acquisition costs and retention rates"
  ]
};

        // EMBEDDED DCF JSON
        const dcfData = {
  "ticker": "PYPL",
  "valuation_date": "2026-01-22",
  "current_price": 57.15,
  "inputs": {
    "shares_outstanding": 1039,
    "net_debt": -249,
    "total_debt": 10574,
    "cash": 10823,
    "last_fcf": 6767,
    "last_revenue": 31797,
    "currency": "USD",
    "units": "millions"
  },
  "historical_growth": {
    "revenue_3yr_cagr": 7.8,
    "revenue_5yr_cagr": 12.3,
    "eps_3yr_cagr": 4.3,
    "eps_5yr_cagr": 14.0,
    "equity_3yr_cagr": -2.1,
    "equity_7yr_cagr": 3.5,
    "fcf_3yr_cagr": 7.7,
    "fcf_5yr_cagr": 7.2,
    "selected_growth_rate": 7.5,
    "growth_rate_source": "blended_revenue_fcf",
    "growth_divergence_warning": "Equity CAGR is negative/low due to share buybacks reducing book value. Using revenue/FCF as primary growth indicator."
  },
  "assumptions": {
    "base": {
      "growth_rates": [
        7.0,
        6.5,
        6.0,
        5.0,
        4.0
      ],
      "fcf_margin": 21.3,
      "wacc": 9.0,
      "terminal_growth": 3.0
    },
    "bull": {
      "growth_rates": [
        10.0,
        9.0,
        8.0,
        7.0,
        6.0
      ],
      "fcf_margin": 21.3,
      "wacc": 8.5,
      "terminal_growth": 3.5
    },
    "bear": {
      "growth_rates": [
        4.0,
        3.5,
        3.0,
        2.5,
        2.0
      ],
      "fcf_margin": 21.3,
      "wacc": 10.0,
      "terminal_growth": 2.5
    }
  },
  "projections": {
    "base": {
      "description": "Conservative baseline with gradual margin improvement",
      "years": [
        "Y1",
        "Y2",
        "Y3",
        "Y4",
        "Y5"
      ],
      "revenue": [
        34023,
        36234,
        38408,
        40329,
        41942
      ],
      "fcf": [
        7247,
        7827,
        8411,
        8913,
        9353
      ],
      "discount_factors": [
        0.9174,
        0.8417,
        0.7722,
        0.7084,
        0.6499
      ],
      "pv_fcf": [
        6649.0,
        6588.0,
        6495.0,
        6314.0,
        6079.0
      ]
    },
    "bull": {
      "description": "Successful turnaround with Fastlane momentum and margin expansion",
      "years": [
        "Y1",
        "Y2",
        "Y3",
        "Y4",
        "Y5"
      ],
      "revenue": [
        34977,
        38125,
        41175,
        44057,
        46700
      ],
      "fcf": [
        7625,
        8502,
        9388,
        10177,
        10928
      ],
      "discount_factors": [
        0.9217,
        0.8495,
        0.7829,
        0.7216,
        0.665
      ],
      "pv_fcf": [
        7028.0,
        7222.0,
        7350.0,
        7343.0,
        7268.0
      ]
    },
    "bear": {
      "description": "Competitive pressure and market share loss",
      "years": [
        "Y1",
        "Y2",
        "Y3",
        "Y4",
        "Y5"
      ],
      "revenue": [
        33069,
        34226,
        35253,
        36134,
        36857
      ],
      "fcf": [
        6878,
        6948,
        7051,
        7227,
        7371
      ],
      "discount_factors": [
        0.9091,
        0.8264,
        0.7513,
        0.683,
        0.6209
      ],
      "pv_fcf": [
        6253.0,
        5742.0,
        5298.0,
        4936.0,
        4577.0
      ]
    }
  },
  "valuation": {
    "base": {
      "sum_pv_fcf": 32124.0,
      "terminal_fcf": 9634.0,
      "terminal_value": 160560.0,
      "pv_terminal": 104353.0,
      "enterprise_value": 136477.0,
      "equity_value": 136726.0,
      "intrinsic_value": 131.59,
      "upside": 130.2,
      "assumptions": {
        "revenue_growth_rates": [
          7.0,
          6.5,
          6.0,
          5.0,
          4.0
        ],
        "fcf_margin_start": 21.3,
        "fcf_margin_end": 22.3,
        "wacc": 9.0,
        "terminal_growth": 3.0
      }
    },
    "bull": {
      "sum_pv_fcf": 36211.0,
      "terminal_fcf": 11310.0,
      "terminal_value": 226210.0,
      "pv_terminal": 150440.0,
      "enterprise_value": 186650.0,
      "equity_value": 186899.0,
      "intrinsic_value": 179.88,
      "upside": 214.8,
      "assumptions": {
        "revenue_growth_rates": [
          10.0,
          9.0,
          8.0,
          7.0,
          6.0
        ],
        "fcf_margin_start": 21.3,
        "fcf_margin_end": 23.4,
        "wacc": 8.5,
        "terminal_growth": 3.5
      }
    },
    "bear": {
      "sum_pv_fcf": 26805.0,
      "terminal_fcf": 7555.0,
      "terminal_value": 100737.0,
      "pv_terminal": 62550.0,
      "enterprise_value": 89355.0,
      "equity_value": 89604.0,
      "intrinsic_value": 86.24,
      "upside": 50.9,
      "assumptions": {
        "revenue_growth_rates": [
          4.0,
          3.5,
          3.0,
          2.5,
          2.0
        ],
        "fcf_margin_start": 21.3,
        "fcf_margin_end": 20.0,
        "wacc": 10.0,
        "terminal_growth": 2.5
      }
    }
  },
  "entry_price": {
    "base": {
      "terminal_value_per_share": 154.53,
      "years_to_terminal": 5,
      "target_cagr": 15.0,
      "entry_price": 76.83,
      "entry_discount_from_current": 34.4
    }
  },
  "sensitivity": {
    "wacc_range": [
      7.5,
      8.5,
      9.0,
      9.5,
      10.5
    ],
    "terminal_growth_range": [
      2.0,
      2.5,
      3.0,
      3.5,
      4.0
    ],
    "matrix": [
      [
        148.74,
        161.0,
        175.98,
        194.7,
        218.78
      ],
      [
        125.53,
        133.85,
        143.7,
        155.51,
        169.94
      ],
      [
        116.41,
        123.42,
        131.59,
        141.26,
        152.85
      ],
      [
        108.51,
        114.48,
        121.36,
        129.38,
        138.87
      ],
      [
        95.51,
        99.95,
        104.98,
        110.73,
        117.37
      ]
    ]
  },
  "probability_weighted": {
    "weights": {
      "bull": 0.25,
      "base": 0.5,
      "bear": 0.25
    },
    "weighted_iv": 132.32
  }
};

        // Parse CSV
        function parseCSV(csv) {
            const lines = csv.trim().split('\n');
            const headers = lines[0].split(',');
            return lines.slice(1).map(line => {
                const values = line.split(',');
                const obj = {};
                headers.forEach((h, i) => obj[h.trim()] = values[i]?.trim());
                return obj;
            });
        }

        const data = parseCSV(csvData);

        // Sort data chronologically (oldest first)
        data.sort((a, b) => {
            const parseDate = (p) => {
                const year = parseInt(p.match(/\d{4}/)?.[0] || '0');
                const isQ1 = p.includes('Q1');
                const isQ2 = p.includes('Q2');
                const isQ3 = p.includes('Q3');
                const isQ4 = p.includes('Q4');
                const isH1 = p.includes('H1');
                const isH2 = p.includes('H2');
                const isFY = p.startsWith('FY');
                const subOrder = isQ1 ? 1 : isQ2 ? 2 : isH1 ? 3 : isQ3 ? 4 : isQ4 ? 5 : isH2 ? 6 : isFY ? 7 : 0;
                return year * 10 + subOrder;
            };
            return parseDate(a.Period) - parseDate(b.Period);
        });

        // Filter for annual and quarterly data
        const fyData = data.filter(d => d.Period.startsWith('FY'));
        const quarterlyData = data.filter(d => d.Period.startsWith('Q'));

        // Helper functions
        function calcYoYChange(current, previous) {
            if (!previous || !current) return null;
            return ((parseFloat(current) - parseFloat(previous)) / Math.abs(parseFloat(previous)) * 100).toFixed(1);
        }

        function formatNumber(num, decimals = 0) {
            if (!num || num === '') return 'N/A';
            const n = parseFloat(num);
            if (n >= 1000) return (n / 1000).toFixed(decimals) + 'T';
            return n.toFixed(decimals) + 'B';
        }

        // Toggle overview
        function toggleOverview() {
            const btn = document.querySelector('.overview-toggle');
            const content = document.getElementById('overviewContent');
            btn.classList.toggle('active');
            content.classList.toggle('active');
        }

        // Render KPI cards
        function renderKPIs() {
            const latest = fyData[fyData.length - 1];
            const previous = fyData[fyData.length - 2];

            const kpis = [
                {
                    label: 'Revenue',
                    value: '$' + formatNumber(latest.Revenue, 1),
                    change: calcYoYChange(latest.Revenue, previous.Revenue)
                },
                {
                    label: 'TPV',
                    value: '$' + formatNumber(latest.TPV, 2),
                    change: calcYoYChange(latest.TPV, previous.TPV)
                },
                {
                    label: 'Active Accounts',
                    value: latest.ActiveAccounts + 'M',
                    change: calcYoYChange(latest.ActiveAccounts, previous.ActiveAccounts)
                },
                {
                    label: 'Take Rate',
                    value: latest.TakeRate + '%',
                    change: calcYoYChange(latest.TakeRate, previous.TakeRate)
                },
                {
                    label: 'Operating Margin',
                    value: latest.OperatingMargin + '%',
                    change: calcYoYChange(latest.OperatingMargin, previous.OperatingMargin)
                },
                {
                    label: 'Free Cash Flow',
                    value: '$' + formatNumber(latest.FreeCashFlow, 1),
                    change: calcYoYChange(latest.FreeCashFlow, previous.FreeCashFlow)
                },
                {
                    label: 'Transactions',
                    value: latest.PaymentTransactions + 'B',
                    change: calcYoYChange(latest.PaymentTransactions, previous.PaymentTransactions)
                },
                {
                    label: 'Trans/Account',
                    value: latest.TransactionsPerActiveAccount,
                    change: calcYoYChange(latest.TransactionsPerActiveAccount, previous.TransactionsPerActiveAccount)
                }
            ];

            const grid = document.getElementById('kpiGrid');
            grid.innerHTML = kpis.map(kpi => {
                const changeClass = kpi.change && parseFloat(kpi.change) >= 0 ? 'positive' : 'negative';
                const changePrefix = kpi.change && parseFloat(kpi.change) >= 0 ? '+' : '';
                return `
                    <div class="kpi-card">
                        <div class="kpi-value">${kpi.value}</div>
                        <div class="kpi-label">${kpi.label}</div>
                        ${kpi.change ? `<div class="kpi-change ${changeClass}">${changePrefix}${kpi.change}% YoY</div>` : ''}
                    </div>
                `;
            }).join('');
        }

        // Render guidance section
        function renderGuidance() {
            if (!analysis.guidance || !analysis.guidance.items || analysis.guidance.items.length === 0) {
                document.getElementById('guidanceSection').style.display = 'none';
                return;
            }

            const guidance = analysis.guidance;
            document.getElementById('guidanceAsOf').textContent = guidance.as_of || '';
            document.getElementById('guidanceFY').textContent = guidance.fiscal_year || '';

            const grid = document.getElementById('guidanceGrid');
            grid.innerHTML = guidance.items.map(item => {
                const vsClass = item.vs_prior ? item.vs_prior.toLowerCase() : 'new';
                const vsLabel = item.vs_prior ? item.vs_prior.charAt(0).toUpperCase() + item.vs_prior.slice(1) : 'New';
                return `
                    <div class="guidance-card">
                        <div class="guidance-metric">${item.metric}</div>
                        <div class="guidance-target">${item.target}</div>
                        <div class="guidance-period">${item.period}</div>
                        <span class="guidance-vs-prior ${vsClass}">${vsLabel}</span>
                        ${item.notes ? `<div class="guidance-notes">${item.notes}</div>` : ''}
                    </div>
                `;
            }).join('');

            const commentary = document.getElementById('guidanceCommentary');
            if (guidance.management_commentary) {
                commentary.textContent = guidance.management_commentary;
                commentary.style.display = 'block';
            } else {
                commentary.style.display = 'none';
            }
        }

        // Chart defaults
        const chartDefaults = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { labels: { color: '#e0e0e0', font: { size: 11 } } }
            },
            scales: {
                x: { ticks: { color: '#888' }, grid: { color: 'rgba(255,255,255,0.05)' } },
                y: { ticks: { color: '#888' }, grid: { color: 'rgba(255,255,255,0.05)' } }
            }
        };

        const colors = {
            primary: '#00d4aa',
            secondary: '#00b894',
            tertiary: '#0984e3',
            quaternary: '#6c5ce7',
            warning: '#fdcb6e',
            danger: '#ff6b6b'
        };

        // Create charts
        function createCharts() {
            // Revenue & Growth
            new Chart(document.getElementById('revenueChart'), {
                type: 'bar',
                data: {
                    labels: fyData.map(d => d.Period),
                    datasets: [{
                        label: 'Revenue ($B)',
                        data: fyData.map(d => parseFloat(d.Revenue)),
                        backgroundColor: colors.primary,
                        yAxisID: 'y'
                    }, {
                        label: 'Growth %',
                        data: fyData.map(d => parseFloat(d.RevenueGrowthYoY)),
                        type: 'line',
                        borderColor: colors.warning,
                        backgroundColor: 'transparent',
                        yAxisID: 'y1'
                    }]
                },
                options: {
                    ...chartDefaults,
                    scales: {
                        x: chartDefaults.scales.x,
                        y: { ...chartDefaults.scales.y, position: 'left' },
                        y1: { ...chartDefaults.scales.y, position: 'right', grid: { display: false } }
                    }
                }
            });

            // Quarterly Revenue
            new Chart(document.getElementById('quarterlyRevenueChart'), {
                type: 'line',
                data: {
                    labels: quarterlyData.map(d => d.Period),
                    datasets: [{
                        label: 'Revenue ($B)',
                        data: quarterlyData.map(d => parseFloat(d.Revenue)),
                        borderColor: colors.primary,
                        backgroundColor: 'rgba(0, 212, 170, 0.1)',
                        fill: true
                    }]
                },
                options: chartDefaults
            });

            // Margins
            new Chart(document.getElementById('marginsChart'), {
                type: 'line',
                data: {
                    labels: fyData.map(d => d.Period),
                    datasets: [{
                        label: 'Operating Margin %',
                        data: fyData.map(d => parseFloat(d.OperatingMargin)),
                        borderColor: colors.primary,
                        backgroundColor: 'transparent'
                    }, {
                        label: 'Net Margin %',
                        data: fyData.map(d => parseFloat(d.NetMargin)),
                        borderColor: colors.tertiary,
                        backgroundColor: 'transparent'
                    }]
                },
                options: chartDefaults
            });

            // Net Income & EPS
            new Chart(document.getElementById('netIncomeChart'), {
                type: 'bar',
                data: {
                    labels: fyData.map(d => d.Period),
                    datasets: [{
                        label: 'Net Income ($B)',
                        data: fyData.map(d => parseFloat(d.NetIncome)),
                        backgroundColor: colors.primary,
                        yAxisID: 'y'
                    }, {
                        label: 'EPS ($)',
                        data: fyData.map(d => parseFloat(d.EPS)),
                        type: 'line',
                        borderColor: colors.warning,
                        backgroundColor: 'transparent',
                        yAxisID: 'y1'
                    }]
                },
                options: {
                    ...chartDefaults,
                    scales: {
                        x: chartDefaults.scales.x,
                        y: { ...chartDefaults.scales.y, position: 'left' },
                        y1: { ...chartDefaults.scales.y, position: 'right', grid: { display: false } }
                    }
                }
            });

            // Free Cash Flow
            new Chart(document.getElementById('fcfChart'), {
                type: 'bar',
                data: {
                    labels: fyData.map(d => d.Period),
                    datasets: [{
                        label: 'Free Cash Flow ($B)',
                        data: fyData.map(d => parseFloat(d.FreeCashFlow)),
                        backgroundColor: colors.primary
                    }]
                },
                options: chartDefaults
            });

            // Quarterly EPS
            new Chart(document.getElementById('quarterlyEPSChart'), {
                type: 'line',
                data: {
                    labels: quarterlyData.map(d => d.Period),
                    datasets: [{
                        label: 'EPS ($)',
                        data: quarterlyData.map(d => parseFloat(d.EPS)),
                        borderColor: colors.primary,
                        backgroundColor: 'rgba(0, 212, 170, 0.1)',
                        fill: true
                    }]
                },
                options: chartDefaults
            });

            // TPV
            new Chart(document.getElementById('tpvChart'), {
                type: 'bar',
                data: {
                    labels: fyData.map(d => d.Period),
                    datasets: [{
                        label: 'Total Payment Volume ($B)',
                        data: fyData.map(d => parseFloat(d.TPV)),
                        backgroundColor: colors.tertiary
                    }]
                },
                options: chartDefaults
            });

            // Take Rate
            new Chart(document.getElementById('takeRateChart'), {
                type: 'line',
                data: {
                    labels: fyData.map(d => d.Period),
                    datasets: [{
                        label: 'Take Rate %',
                        data: fyData.map(d => parseFloat(d.TakeRate)),
                        borderColor: colors.danger,
                        backgroundColor: 'rgba(255, 107, 107, 0.1)',
                        fill: true
                    }]
                },
                options: chartDefaults
            });

            // Active Accounts
            new Chart(document.getElementById('activeAccountsChart'), {
                type: 'bar',
                data: {
                    labels: fyData.map(d => d.Period),
                    datasets: [{
                        label: 'Active Accounts (M)',
                        data: fyData.map(d => parseFloat(d.ActiveAccounts)),
                        backgroundColor: colors.quaternary
                    }]
                },
                options: chartDefaults
            });

            // Transactions per Account
            new Chart(document.getElementById('transactionsPerAccountChart'), {
                type: 'line',
                data: {
                    labels: fyData.map(d => d.Period),
                    datasets: [{
                        label: 'Transactions per Active Account',
                        data: fyData.map(d => parseFloat(d.TransactionsPerActiveAccount)),
                        borderColor: colors.primary,
                        backgroundColor: 'rgba(0, 212, 170, 0.1)',
                        fill: true
                    }]
                },
                options: chartDefaults
            });

            // Payment Transactions
            new Chart(document.getElementById('transactionsChart'), {
                type: 'bar',
                data: {
                    labels: fyData.map(d => d.Period),
                    datasets: [{
                        label: 'Payment Transactions (B)',
                        data: fyData.map(d => parseFloat(d.PaymentTransactions)),
                        backgroundColor: colors.secondary
                    }]
                },
                options: chartDefaults
            });

            // Quarterly TPV
            const quarterlyTPVData = quarterlyData.filter(d => d.TPV && d.TPV !== '');
            new Chart(document.getElementById('quarterlyTPVChart'), {
                type: 'line',
                data: {
                    labels: quarterlyTPVData.map(d => d.Period),
                    datasets: [{
                        label: 'TPV ($B)',
                        data: quarterlyTPVData.map(d => parseFloat(d.TPV)),
                        borderColor: colors.tertiary,
                        backgroundColor: 'rgba(9, 132, 227, 0.1)',
                        fill: true
                    }]
                },
                options: chartDefaults
            });
        }

        // Metric descriptions
        const metricDescriptions = {
            revenue: {
                title: "Revenue",
                content: `
                    <p><strong>Revenue</strong> is PayPal's total income from transaction fees and value-added services.</p>
                    <div class="metric-highlight">
                        <strong>For PayPal:</strong> 92% comes from transaction fees charged to merchants and consumers based on payment volume processed. The remaining 8% comes from value-added services including currency conversion, instant transfers, interest on customer balances, and merchant/consumer credit products.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Revenue growth deceleration: From 20%+ historically to single-digits reflects market maturation and competitive pressure</li>
                        <li>Mix shift impact: Braintree (unbranded) growth dilutes revenue per transaction vs branded PayPal checkout</li>
                        <li>Venmo monetization progress: Still small contributor despite large user base</li>
                    </ul>
                `
            },
            quarterlyRevenue: {
                title: "Quarterly Revenue Trend",
                content: `
                    <p><strong>Quarterly revenue</strong> shows PayPal's quarter-over-quarter performance and seasonal patterns.</p>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Q4 typically strongest due to holiday shopping season</li>
                        <li>YoY growth stabilizing in mid-to-high single digits under new CEO's profitability focus</li>
                        <li>Sequential growth patterns indicating momentum or deceleration</li>
                    </ul>
                `
            },
            margins: {
                title: "Operating & Net Margins",
                content: `
                    <p><strong>Operating margin</strong> measures profitability before interest and taxes. <strong>Net margin</strong> shows bottom-line profitability after all expenses.</p>
                    <div class="metric-highlight">
                        <strong>For PayPal:</strong> Operating margins have improved under CEO Alex Chriss's focus on efficiency (16-17% range in 2024-2025 vs ~12-13% in 2020-2022). Net margins fluctuate with one-time items and tax impacts.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Margin expansion from operational efficiency and automation offsetting pricing pressure</li>
                        <li>Impact of product mix: branded checkout has higher margins than unbranded Braintree</li>
                        <li>Investment in AI, Fastlane, and platform modernization pressuring near-term margins</li>
                    </ul>
                `
            },
            netIncome: {
                title: "Net Income & EPS",
                content: `
                    <p><strong>Net Income</strong> is PayPal's profit after all expenses. <strong>EPS (Earnings Per Share)</strong> divides net income by shares outstanding.</p>
                    <div class="metric-highlight">
                        <strong>For PayPal:</strong> Net income volatility in 2020-2022 reflected pandemic boom/normalization and restructuring charges. EPS growth accelerating in 2025 (+15-16% guidance) due to margin improvement and aggressive buybacks reducing share count.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>EPS growth from buybacks: $6B annual repurchases reduce shares ~10%/year at current price</li>
                        <li>Sustainability of margin expansion and whether it can offset revenue deceleration</li>
                        <li>One-time items and restructuring charges impacting comparability</li>
                    </ul>
                `
            },
            fcf: {
                title: "Free Cash Flow",
                content: `
                    <p><strong>Free Cash Flow (FCF)</strong> is cash generated after capital expenditures, available for dividends, buybacks, and debt repayment.</p>
                    <div class="metric-highlight">
                        <strong>For PayPal:</strong> Strong FCF generation ($6.8B in FY2024, 21% FCF margin) funds aggressive capital return. FCF spike in FY2024 reflects working capital improvements and operational efficiency.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>FCF conversion rate: FCF as % of net income (healthy above 100%)</li>
                        <li>Capital allocation: balance between buybacks, dividend growth, and strategic investments</li>
                        <li>Sustainability of FCF margins as company invests in platform modernization</li>
                    </ul>
                `
            },
            quarterlyEPS: {
                title: "Quarterly EPS Trend",
                content: `
                    <p><strong>Quarterly EPS</strong> shows earnings per share progression each quarter.</p>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Acceleration trend: Q3 2025 EPS $1.40 (+35% YoY) shows strong momentum</li>
                        <li>Impact of share buybacks: reducing denominator boosts EPS even with flat earnings</li>
                        <li>Seasonality: Q4 typically strongest due to holiday shopping</li>
                    </ul>
                `
            },
            tpv: {
                title: "Total Payment Volume (TPV)",
                content: `
                    <p><strong>Total Payment Volume (TPV)</strong> is the gross dollar value of all transactions processed through PayPal's platform, including branded and unbranded flows.</p>
                    <div class="metric-highlight">
                        <strong>For PayPal:</strong> TPV is a scale indicator. PayPal processed $1.68 trillion in FY2024 (+10% YoY), making it one of the world's largest payment processors. However, TPV growth has decelerated from 30%+ during pandemic to high single digits.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>TPV growth vs revenue growth: divergence indicates take rate compression</li>
                        <li>Branded vs unbranded mix: Braintree TPV grows faster but generates lower revenue per dollar</li>
                        <li>Compare to Stripe's 12.3% TPV growth - PayPal losing share to faster-growing competitors</li>
                    </ul>
                `
            },
            takeRate: {
                title: "Take Rate",
                content: `
                    <p><strong>Take Rate</strong> is revenue divided by TPV, representing PayPal's effective fee rate across all transactions.</p>
                    <div class="metric-highlight">
                        <strong>For PayPal:</strong> Take rate declining from 3.28% (2015) to 1.89% (2024) is a critical metric. Decline driven by: (1) shift to lower-margin unbranded Braintree processing, (2) competitive pricing pressure from Stripe/Adyen, (3) mix toward larger merchants who negotiate lower rates.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Rate of decline: slowing decline signals stabilization; accelerating decline is bearish</li>
                        <li>Branded vs unbranded take rates: branded ~2.5-3%, unbranded ~1.0-1.5%</li>
                        <li>Offset opportunities: value-added services (BNPL, ads, lending) can partially offset pressure</li>
                        <li>This is PayPal's single biggest long-term challenge for profitability</li>
                    </ul>
                `
            },
            activeAccounts: {
                title: "Active Accounts",
                content: `
                    <p><strong>Active Accounts</strong> are users who transacted at least once in the last 12 months (includes both consumers and merchants).</p>
                    <div class="metric-highlight">
                        <strong>For PayPal:</strong> 434M active accounts as of FY2024. Growth stalled at only 2% YoY vs historical double-digit growth. This signals market saturation in developed markets and difficulty competing against Apple Pay/Google Pay for new users.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Growth inflection: management shifting focus to "monthly active accounts" (engagement) vs total accounts</li>
                        <li>Account quality: engagement and revenue per account matter more than absolute count</li>
                        <li>International growth potential: emerging markets could reignite account growth</li>
                        <li>Venmo conversion: turning P2P users into merchant payment users</li>
                    </ul>
                `
            },
            transactionsPerAccount: {
                title: "Transactions per Active Account",
                content: `
                    <p><strong>Transactions per Active Account</strong> measures engagement and frequency of use.</p>
                    <div class="metric-highlight">
                        <strong>For PayPal:</strong> Growing from 27 (2015) to 61 (2024) is a positive sign - existing users transacting more frequently. This partially offsets slowing account growth and indicates sticky usage patterns.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Continued growth shows platform stickiness despite competitive threats</li>
                        <li>Venmo contributing to growth: users increasingly using PayPal for everyday purchases vs just online checkout</li>
                        <li>Fastlane potential: faster checkout could drive more impulse purchases and higher frequency</li>
                    </ul>
                `
            },
            transactions: {
                title: "Payment Transactions",
                content: `
                    <p><strong>Payment Transactions</strong> is the total number of payments processed (in billions).</p>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Transaction growth (5-6% YoY) exceeds account growth, indicating increasing engagement</li>
                        <li>Combination of more accounts and higher frequency drives transaction volume</li>
                        <li>26.3B transactions in FY2024 shows massive scale advantage</li>
                    </ul>
                `
            },
            quarterlyTPV: {
                title: "Quarterly TPV Trend",
                content: `
                    <p><strong>Quarterly TPV</strong> shows payment volume progression each quarter.</p>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li>Q4 seasonal spike from holiday shopping (highest TPV quarter)</li>
                        <li>Acceleration/deceleration trends signaling market share changes</li>
                        <li>Impact of Braintree merchant wins/losses on total volume</li>
                    </ul>
                `
            }
        };

        // Modal functions
        function openModal(key) {
            document.getElementById('modalTitle').textContent = metricDescriptions[key].title;
            document.getElementById('modalBody').innerHTML = metricDescriptions[key].content;
            document.getElementById('modalOverlay').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(event) {
            if (event && event.target !== document.getElementById('modalOverlay') && event.type !== 'click') return;
            document.getElementById('modalOverlay').classList.remove('active');
            document.body.style.overflow = '';
        }

        document.addEventListener('keydown', e => { if (e.key === 'Escape') closeModal(); });

        // DCF Functions
        let currentScenario = 'base';

        function initDCF() {
            if (!dcfData || !dcfData.valuation) return;

            document.getElementById('dcfCurrent').textContent = '$' + dcfData.current_price.toFixed(0);

            if (dcfData.historical_growth.growth_divergence_warning) {
                document.getElementById('growthWarning').style.display = 'flex';
                document.getElementById('warningText').textContent = dcfData.historical_growth.growth_divergence_warning;
            }

            const base = dcfData.assumptions.base;
            document.getElementById('growthSlider').value = dcfData.historical_growth.selected_growth_rate;
            document.getElementById('waccSlider').value = base.wacc;
            document.getElementById('terminalSlider').value = base.terminal_growth;

            document.getElementById('growthValue').textContent = dcfData.historical_growth.selected_growth_rate + '%';
            document.getElementById('waccValue').textContent = base.wacc + '%';
            document.getElementById('terminalValue').textContent = base.terminal_growth + '%';

            document.getElementById('growthHint').textContent =
                'Based on ' + dcfData.historical_growth.growth_rate_source.replace(/_/g, ' ');

            renderHistoricalGrowth();
            renderSensitivityMatrix();
            updateDCFDisplay();
            switchScenario('base');
        }

        function calculateDCF(growthRate, wacc, terminalGrowth) {
            const years = 5;
            const fcf = dcfData.inputs.last_fcf;
            let pvFCF = 0;
            let projectedFCF = fcf;

            for (let i = 0; i < years; i++) {
                projectedFCF *= (1 + growthRate / 100);
                pvFCF += projectedFCF / Math.pow(1 + wacc/100, i + 1);
            }

            const terminalFCF = projectedFCF * (1 + terminalGrowth/100);
            const terminalValue = terminalFCF / (wacc/100 - terminalGrowth/100);
            const pvTerminal = terminalValue / Math.pow(1 + wacc/100, years);

            const enterpriseValue = pvFCF + pvTerminal;
            const equityValue = enterpriseValue - dcfData.inputs.net_debt;
            const iv = equityValue / dcfData.inputs.shares_outstanding;

            const terminalPerShare = terminalValue / dcfData.inputs.shares_outstanding;
            const entryPrice = terminalPerShare / Math.pow(1.15, years);

            return {
                iv: iv,
                entryPrice: entryPrice,
                terminalPerShare: terminalPerShare,
                pvFCF: pvFCF,
                pvTerminal: pvTerminal,
                enterpriseValue: enterpriseValue
            };
        }

        window.updateDCFDisplay = function() {
            const growth = parseFloat(document.getElementById('growthSlider').value);
            const wacc = parseFloat(document.getElementById('waccSlider').value);
            const terminal = parseFloat(document.getElementById('terminalSlider').value);

            document.getElementById('growthValue').textContent = growth + '%';
            document.getElementById('waccValue').textContent = wacc + '%';
            document.getElementById('terminalValue').textContent = terminal + '%';

            const result = calculateDCF(growth, wacc, terminal);

            document.getElementById('dcfIV').textContent = '$' + result.iv.toFixed(0);
            document.getElementById('dcfEntry').textContent = '$' + result.entryPrice.toFixed(0);

            const upside = ((result.iv - dcfData.current_price) / dcfData.current_price * 100);
            const upsideEl = document.getElementById('dcfUpside');
            upsideEl.textContent = (upside >= 0 ? '+' : '') + upside.toFixed(0) + '% ' + (upside >= 0 ? 'upside' : 'downside');
            upsideEl.className = 'dcf-change ' + (upside >= 0 ? 'positive' : 'negative');

            document.getElementById('dcfWeighted').textContent = '$' + dcfData.probability_weighted.weighted_iv.toFixed(0);

            const grid = document.getElementById('assumptionGrid');
            if (grid) {
                grid.innerHTML = `
                    <div class="assumption-item">
                        <div class="label">Growth Rate</div>
                        <div class="value">${growth}%</div>
                    </div>
                    <div class="assumption-item">
                        <div class="label">WACC</div>
                        <div class="value">${wacc}%</div>
                    </div>
                    <div class="assumption-item">
                        <div class="label">Terminal Growth</div>
                        <div class="value">${terminal}%</div>
                    </div>
                    <div class="assumption-item">
                        <div class="label">Intrinsic Value</div>
                        <div class="value" style="color: #00d4aa;">$${result.iv.toFixed(0)}</div>
                    </div>
                    <div class="assumption-item">
                        <div class="label">Entry Price</div>
                        <div class="value" style="color: #00d4aa;">$${result.entryPrice.toFixed(0)}</div>
                    </div>
                `;
            }
        };

        window.switchScenario = function(scenario) {
            currentScenario = scenario;

            document.querySelectorAll('.scenario-tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.scenario === scenario);
            });

            const assumptions = dcfData.assumptions[scenario];
            const valuation = dcfData.valuation[scenario];

            document.getElementById('growthSlider').value = assumptions.growth_rates[0];
            document.getElementById('waccSlider').value = assumptions.wacc;
            document.getElementById('terminalSlider').value = assumptions.terminal_growth;

            const grid = document.getElementById('assumptionGrid');
            grid.innerHTML = `
                <div class="assumption-item">
                    <div class="label">Year 1 Growth</div>
                    <div class="value">${assumptions.growth_rates[0]}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">Year 5 Growth</div>
                    <div class="value">${assumptions.growth_rates[4]}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">FCF Margin</div>
                    <div class="value">${assumptions.fcf_margin}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">WACC</div>
                    <div class="value">${assumptions.wacc}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">Terminal Growth</div>
                    <div class="value">${assumptions.terminal_growth}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">Intrinsic Value</div>
                    <div class="value" style="color: #00d4aa;">$${valuation.intrinsic_value.toFixed(0)}</div>
                </div>
            `;

            updateDCFDisplay();
        };

        function renderHistoricalGrowth() {
            const growth = dcfData.historical_growth;
            const selectedSource = growth.growth_rate_source;
            const grid = document.getElementById('growthGrid');

            const metrics = [
                { key: 'revenue_3yr_cagr', label: 'Revenue 3Y' },
                { key: 'revenue_5yr_cagr', label: 'Revenue 5Y' },
                { key: 'eps_3yr_cagr', label: 'EPS 3Y' },
                { key: 'eps_5yr_cagr', label: 'EPS 5Y' },
                { key: 'equity_3yr_cagr', label: 'Equity 3Y' },
                { key: 'equity_7yr_cagr', label: 'Equity 7Y' },
                { key: 'fcf_3yr_cagr', label: 'FCF 3Y' },
                { key: 'fcf_5yr_cagr', label: 'FCF 5Y' }
            ];

            grid.innerHTML = metrics.map(m => {
                const rate = growth[m.key];
                const isSelected = selectedSource.includes(m.key.split('_')[0]);
                const colorClass = rate >= 0 ? 'positive' : 'negative';
                return `
                    <div class="growth-item ${isSelected ? 'selected' : ''}">
                        <div class="metric">${m.label}</div>
                        <div class="rate ${colorClass}">${rate >= 0 ? '+' : ''}${rate.toFixed(1)}%</div>
                    </div>
                `;
            }).join('');
        }

        function renderSensitivityMatrix() {
            const sens = dcfData.sensitivity;
            const table = document.getElementById('sensitivityMatrix');
            const currentPrice = dcfData.current_price;

            let html = '<tr><th>WACC \\ Term G</th>';
            sens.terminal_growth_range.forEach(tg => {
                html += `<th>${tg}%</th>`;
            });
            html += '</tr>';

            sens.wacc_range.forEach((wacc, i) => {
                html += `<tr><th>${wacc}%</th>`;
                sens.matrix[i].forEach((val, j) => {
                    const isHighlight = wacc === dcfData.assumptions.base.wacc &&
                                       sens.terminal_growth_range[j] === dcfData.assumptions.base.terminal_growth;
                    const colorClass = val >= currentPrice ? 'above-current' : 'below-current';
                    html += `<td class="${isHighlight ? 'highlight' : colorClass}">$${val.toFixed(0)}</td>`;
                });
                html += '</tr>';
            });

            table.innerHTML = html;
        }

        // Initialize
        renderKPIs();
        renderGuidance();
        createCharts();
        initDCF();

        // Bind slider events
        (function() {
            var growthSlider = document.getElementById('growthSlider');
            var waccSlider = document.getElementById('waccSlider');
            var terminalSlider = document.getElementById('terminalSlider');

            if (growthSlider) {
                growthSlider.oninput = window.updateDCFDisplay;
                growthSlider.onchange = window.updateDCFDisplay;
            }
            if (waccSlider) {
                waccSlider.oninput = window.updateDCFDisplay;
                waccSlider.onchange = window.updateDCFDisplay;
            }
            if (terminalSlider) {
                terminalSlider.oninput = window.updateDCFDisplay;
                terminalSlider.onchange = window.updateDCFDisplay;
            }
        })();
    </script>
</body>
</html>