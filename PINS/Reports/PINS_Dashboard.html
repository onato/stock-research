<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pinterest (PINS) Financial Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        .header h1 {
            font-size: 2.5rem;
            background: linear-gradient(90deg, #00d4aa, #00b894);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }
        .header p {
            color: #888;
            font-size: 1.1rem;
        }

        /* Investment Overview Section */
        .overview-section {
            max-width: 1400px;
            margin: 0 auto 30px;
        }
        .overview-toggle {
            width: 100%;
            background: rgba(0, 212, 170, 0.1);
            border: 1px solid rgba(0, 212, 170, 0.3);
            border-radius: 12px;
            padding: 16px 24px;
            color: #00d4aa;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
        }
        .overview-toggle:hover {
            background: rgba(0, 212, 170, 0.2);
        }
        .overview-toggle .arrow {
            transition: transform 0.3s ease;
        }
        .overview-toggle.active .arrow {
            transform: rotate(180deg);
        }
        .overview-content {
            display: none;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-top: none;
            border-radius: 0 0 12px 12px;
            padding: 30px;
            margin-top: -12px;
        }
        .overview-content.active {
            display: block;
        }
        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
        }
        .overview-card {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .overview-card h3 {
            color: #00d4aa;
            font-size: 1.1rem;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .overview-card p {
            margin-bottom: 12px;
            line-height: 1.6;
        }
        .overview-card ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .overview-card li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            line-height: 1.5;
        }
        .overview-card li:last-child {
            border-bottom: none;
        }
        .overview-card.bull h3 { color: #00d4aa; }
        .overview-card.bear h3 { color: #ff6b6b; }
        .overview-card.risks h3 { color: #fdcb6e; }
        .risk-high { color: #ff6b6b; font-weight: 600; }
        .risk-moderate { color: #fdcb6e; font-weight: 600; }
        .risk-low { color: #00d4aa; font-weight: 600; }
        .revenue-stream {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .revenue-stream .percent {
            color: #00d4aa;
            font-weight: 600;
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
        }
        .kpi-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 212, 170, 0.2);
        }
        .kpi-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #00d4aa;
            margin-bottom: 5px;
        }
        .kpi-label {
            font-size: 0.85rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .kpi-change {
            font-size: 0.9rem;
            margin-top: 5px;
        }
        .kpi-change.positive { color: #00d4aa; }
        .kpi-change.negative { color: #ff6b6b; }

        /* Guidance Section */
        .guidance-section {
            max-width: 1400px;
            margin: 0 auto 30px;
        }
        .guidance-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .guidance-header h3 {
            color: #fff;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .guidance-header h3::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 20px;
            background: linear-gradient(180deg, #00d4aa, #00b894);
            border-radius: 2px;
        }
        .guidance-meta {
            font-size: 0.85rem;
            color: #888;
        }
        .guidance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .guidance-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 18px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.2s ease;
        }
        .guidance-card:hover {
            transform: translateY(-2px);
        }
        .guidance-metric {
            font-size: 0.8rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }
        .guidance-target {
            font-size: 1.4rem;
            font-weight: 600;
            color: #00d4aa;
            margin-bottom: 6px;
        }
        .guidance-period {
            font-size: 0.85rem;
            color: #e0e0e0;
            margin-bottom: 8px;
        }
        .guidance-vs-prior {
            display: inline-block;
            font-size: 0.75rem;
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: 500;
        }
        .guidance-vs-prior.raised {
            background: rgba(0, 212, 170, 0.15);
            color: #00d4aa;
        }
        .guidance-vs-prior.lowered {
            background: rgba(255, 107, 107, 0.15);
            color: #ff6b6b;
        }
        .guidance-vs-prior.maintained {
            background: rgba(255, 255, 255, 0.1);
            color: #888;
        }
        .guidance-vs-prior.new {
            background: rgba(99, 102, 241, 0.15);
            color: #818cf8;
        }
        .guidance-notes {
            font-size: 0.8rem;
            color: #666;
            margin-top: 8px;
            line-height: 1.4;
        }
        .guidance-commentary {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            padding: 16px 20px;
            border-left: 3px solid #00d4aa;
            font-style: italic;
            color: #b0b0b0;
            line-height: 1.6;
        }
        .guidance-commentary::before {
            content: '"';
            font-size: 1.5rem;
            color: #00d4aa;
            margin-right: 4px;
        }

        .section-title {
            font-size: 1.5rem;
            color: #fff;
            margin: 40px auto 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(0, 212, 170, 0.3);
            max-width: 1400px;
        }
        .charts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 25px;
            max-width: 1400px;
            margin: 0 auto;
        }
        .chart-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .chart-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .chart-header h3 {
            color: #fff;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .chart-header h3::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 20px;
            background: linear-gradient(180deg, #00d4aa, #00b894);
            border-radius: 2px;
        }
        .help-btn {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: rgba(0, 212, 170, 0.2);
            border: 1px solid #00d4aa;
            color: #00d4aa;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        .help-btn:hover {
            background: #00d4aa;
            color: #1a1a2e;
        }
        .chart-wrapper {
            position: relative;
            height: 300px;
        }
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .modal-overlay.active { display: flex; }
        .modal {
            background: linear-gradient(135deg, #1e2a4a 0%, #16213e 100%);
            border-radius: 16px;
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid rgba(0, 212, 170, 0.3);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }
        .modal-header {
            padding: 20px 25px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .modal-header h3 {
            color: #00d4aa;
            font-size: 1.4rem;
            margin: 0;
        }
        .modal-close {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255, 107, 107, 0.2);
            border: 1px solid #ff6b6b;
            color: #ff6b6b;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-close:hover {
            background: #ff6b6b;
            color: #fff;
        }
        .modal-body {
            padding: 25px;
            line-height: 1.7;
        }
        .modal-body p { margin-bottom: 15px; }
        .modal-body strong { color: #00d4aa; }
        .modal-body ul { margin: 15px 0; padding-left: 20px; }
        .modal-body li { margin-bottom: 8px; }
        .metric-highlight {
            background: rgba(0, 212, 170, 0.1);
            border-left: 3px solid #00d4aa;
            padding: 12px 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }

        /* DCF Valuation Section */
        .dcf-section {
            max-width: 1400px;
            margin: 0 auto 40px;
        }
        .dcf-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .dcf-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease;
        }
        .dcf-card:hover {
            transform: translateY(-3px);
        }
        .dcf-card.highlight {
            background: rgba(0, 212, 170, 0.1);
            border-color: rgba(0, 212, 170, 0.3);
        }
        .dcf-label {
            font-size: 0.85rem;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }
        .dcf-value {
            font-size: 2.2rem;
            font-weight: bold;
            color: #00d4aa;
        }
        .dcf-card:not(.highlight) .dcf-value {
            color: #fff;
        }
        .dcf-change {
            font-size: 1rem;
            margin-top: 8px;
            font-weight: 600;
        }
        .dcf-change.positive { color: #00d4aa; }
        .dcf-change.negative { color: #ff6b6b; }
        .dcf-sublabel {
            font-size: 0.8rem;
            color: #666;
            margin-top: 8px;
        }
        .dcf-warning {
            background: rgba(253, 203, 110, 0.15);
            border: 1px solid rgba(253, 203, 110, 0.4);
            border-radius: 8px;
            padding: 12px 16px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #fdcb6e;
        }
        .warning-icon {
            font-size: 1.2rem;
        }
        .dcf-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .slider-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .slider-group label {
            font-size: 0.95rem;
            color: #e0e0e0;
            display: flex;
            justify-content: space-between;
        }
        .slider-group label span {
            color: #00d4aa;
            font-weight: 600;
        }
        .slider-group input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: rgba(255, 255, 255, 0.1);
            outline: none;
        }
        .slider-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #00d4aa;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .slider-group input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }
        .slider-group input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #00d4aa;
            cursor: pointer;
            border: none;
        }
        .slider-hint {
            font-size: 0.8rem;
            color: #666;
        }
        .scenario-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .scenario-tab {
            padding: 10px 24px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: transparent;
            color: #888;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            transition: all 0.2s;
        }
        .scenario-tab:hover {
            border-color: rgba(0, 212, 170, 0.5);
            color: #e0e0e0;
        }
        .scenario-tab.active {
            background: rgba(0, 212, 170, 0.15);
            border-color: #00d4aa;
            color: #00d4aa;
        }
        .scenario-details {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .scenario-details h4 {
            color: #00d4aa;
            margin-bottom: 15px;
        }
        .assumption-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        .assumption-item {
            text-align: center;
        }
        .assumption-item .label {
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 4px;
        }
        .assumption-item .value {
            font-size: 1.1rem;
            color: #e0e0e0;
            font-weight: 500;
        }
        .sensitivity-section {
            margin-bottom: 30px;
        }
        .sensitivity-section h4 {
            color: #e0e0e0;
            margin-bottom: 15px;
        }
        .sensitivity-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            overflow: hidden;
        }
        .sensitivity-table th,
        .sensitivity-table td {
            padding: 12px 16px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .sensitivity-table th {
            background: rgba(0, 212, 170, 0.1);
            color: #00d4aa;
            font-weight: 600;
        }
        .sensitivity-table td {
            color: #e0e0e0;
        }
        .sensitivity-table td.highlight {
            background: rgba(0, 212, 170, 0.15);
            color: #00d4aa;
            font-weight: 600;
        }
        .sensitivity-table td.below-current {
            color: #ff6b6b;
        }
        .sensitivity-table td.above-current {
            color: #00d4aa;
        }
        .historical-growth {
            margin-bottom: 30px;
        }
        .historical-growth h4 {
            color: #e0e0e0;
            margin-bottom: 15px;
        }
        .growth-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
        }
        .growth-item {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .growth-item .metric {
            font-size: 0.8rem;
            color: #888;
            margin-bottom: 6px;
        }
        .growth-item .rate {
            font-size: 1.2rem;
            font-weight: 600;
        }
        .growth-item .rate.positive { color: #00d4aa; }
        .growth-item .rate.negative { color: #ff6b6b; }
        .growth-item.selected {
            border-color: #00d4aa;
            background: rgba(0, 212, 170, 0.1);
        }
        .dcf-download {
            text-align: center;
            margin-top: 30px;
        }
        .download-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 14px 28px;
            background: rgba(0, 212, 170, 0.15);
            border: 1px solid #00d4aa;
            border-radius: 8px;
            color: #00d4aa;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.2s;
        }
        .download-btn:hover {
            background: #00d4aa;
            color: #1a1a2e;
        }
        .download-icon {
            font-size: 1.2rem;
        }

        @media (max-width: 768px) {
            .charts-container { grid-template-columns: 1fr; }
            .overview-grid { grid-template-columns: 1fr; }
            .header h1 { font-size: 1.8rem; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Pinterest, Inc. (PINS)</h1>
        <p>Visual Discovery & Advertising Platform | Data as of Q3 2025</p>
    </div>

    <!-- Investment Overview Section -->
    <div class="overview-section">
        <button class="overview-toggle" onclick="toggleOverview()">
            <span>Investment Overview & Analysis</span>
            <span class="arrow">â–¼</span>
        </button>
        <div class="overview-content" id="overviewContent">
            <div class="overview-grid">
                <!-- Company Overview -->
                <div class="overview-card">
                    <h3>Company Overview</h3>
                    <p>Pinterest is a visual search and discovery platform positioned at the intersection of search, social media, and commerce. The platform enables 600 million monthly active users to find inspiration and take action through searches, saves, and shopping. Pinterest generates 100% of revenue from advertising, differentiating itself through intent-based signals and a positive, brand-safe environment that resonates particularly with women (70% of users) and Gen Z (42% of users).</p>
                </div>

                <!-- Business Model -->
                <div class="overview-card">
                    <h3>Business Model</h3>
                    <p>Pure advertising revenue model with 100% of revenue from digital ads. Platform monetizes through auction-based system serving both upper funnel (brand/awareness) and lower funnel (performance/conversion) advertisers.</p>
                    <ul>
                        <li class="revenue-stream"><span>US & Canada Advertising</span> <span class="percent">75%</span></li>
                        <li class="revenue-stream"><span>Europe Advertising</span> <span class="percent">18%</span></li>
                        <li class="revenue-stream"><span>Rest of World Advertising</span> <span class="percent">7%</span></li>
                    </ul>
                    <p style="margin-top: 12px;"><strong>Ad Formats:</strong> Shopping ads (30% of international revenue), Standard/Video ads, Carousel/Collection ads, Premier Spotlight</p>
                    <p><strong>Pricing:</strong> CPM, CPC, CPV, CPA, oCPM models</p>
                </div>

                <!-- Competitive Position -->
                <div class="overview-card">
                    <h3>Competitive Position</h3>
                    <p><strong>Competitors:</strong> Meta (Facebook, Instagram), Google (YouTube), TikTok, Snap, Amazon, Reddit</p>
                    <p><strong>Market Position:</strong> Niche leader in visual discovery and intent-based search, 4th most popular social platform in US ages 18-65</p>
                    <p><strong>Key Moats:</strong></p>
                    <ul>
                        <li><strong>Intent-based signals:</strong> 90%+ unbranded searches show purchase intent vs passive browsing</li>
                        <li><strong>Visual discovery data:</strong> Proprietary Taste-graph, AI visual search outperforms off-the-shelf by 30%+</li>
                        <li><strong>Brand-safe environment:</strong> 60% of Gen Z view Pinterest as more positive than other platforms</li>
                    </ul>
                    <p style="margin-top: 12px;"><strong>Weaknesses:</strong> Revenue concentration in US (75%), 100% ad-dependent, smaller scale than Meta/Google, limited engagement vs daily-use social media</p>
                </div>

                <!-- Growth Drivers -->
                <div class="overview-card">
                    <h3>Growth Drivers</h3>
                    <ul>
                        <li><strong>AI-powered personalization:</strong> Pinterest Assistant launched, driving 40% increase in outbound clicks in Q3 2025</li>
                        <li><strong>International monetization:</strong> 83% of MAUs are international but generate only 25% of revenue. Europe ARPU +31% YoY, Rest of World +44% YoY</li>
                        <li><strong>Shopping & commerce expansion:</strong> Shopping ads now 30% of international revenue, visual search driving discovery</li>
                        <li><strong>Gen Z growth:</strong> 42% of user base, 30% YoY search growth</li>
                        <li><strong>Platform efficiency:</strong> Open-source AI adoption reducing costs while improving performance</li>
                    </ul>
                </div>

                <!-- Key Risks -->
                <div class="overview-card risks">
                    <h3>Key Risks</h3>
                    <ul>
                        <li><span class="risk-high">High:</span> Advertiser concentration, competition from larger platforms, US ad market slowdown (75% of revenue), data privacy regulations (GDPR/CCPA), digital ad market cyclicality</li>
                        <li><span class="risk-moderate">Moderate:</span> User growth slowing (4% US MAU growth), measurement/attribution challenges, international monetization execution, tariff impacts on retailer margins</li>
                        <li><strong>Regulatory:</strong> NOYB complaint filed Oct 2024 alleging GDPR violations, designated Very Large Online Platform under EU DSA</li>
                    </ul>
                </div>

                <!-- Bull Case -->
                <div class="overview-card bull">
                    <h3>Bull Case</h3>
                    <ul>
                        <li><strong>Massive international opportunity:</strong> Europe ARPU ($1.31) and Rest of World ($0.21) have 5-30x upside to reach US levels ($7.64). International revenue accelerating 40-66% YoY</li>
                        <li><strong>Unique intent-based platform:</strong> 90%+ unbranded searches, 40% increase in outbound clicks demonstrates strong commercial intent</li>
                        <li><strong>AI-driven innovation:</strong> Pinterest Assistant and personalized recommendations improving engagement, proprietary visual AI outperforms by 30%+</li>
                        <li><strong>Profitability inflection:</strong> First GAAP profitable year in 2024, Adjusted EBITDA margin 30% with long-term target 30-34%</li>
                        <li><strong>Strong capital returns:</strong> $2B buyback program, no debt, $2.5B cash, ~$1.1B TTM free cash flow</li>
                        <li><strong>Gen Z growth engine:</strong> 42% of users, valuable long-term demographic</li>
                    </ul>
                </div>

                <!-- Bear Case -->
                <div class="overview-card bear">
                    <h3>Bear Case</h3>
                    <ul>
                        <li><strong>US market concentration risk:</strong> 75% of revenue from US & Canada where MAU growth slowed to 4% YoY. Management cited "moderating ad spend" from retailers</li>
                        <li><strong>Fierce competition:</strong> Meta and Google have 10-100x resources and can replicate features. TikTok competing for visual discovery and shopping</li>
                        <li><strong>International execution risk:</strong> Despite opportunity, ARPU gap is massive. No guarantee of success at projected rates</li>
                        <li><strong>Regulatory headwinds:</strong> NOYB GDPR complaint Oct 2024, Very Large Platform under EU DSA. Privacy laws could force less effective contextual ads</li>
                        <li><strong>User engagement concerns:</strong> Q3 earnings miss and weak guidance. Platform less sticky than daily-use social media (WAU/MAU 62%)</li>
                        <li><strong>Valuation compression:</strong> Stock down 20% post-Q3 earnings, down ~37% from 52-week high</li>
                        <li><strong>Single revenue stream:</strong> 100% ad-dependent with no diversification. Economic downturn would disproportionately impact</li>
                    </ul>
                </div>

                <!-- Recent Developments -->
                <div class="overview-card">
                    <h3>Recent Developments</h3>
                    <ul>
                        <li><strong>2025-11:</strong> Q3 2025 earnings miss caused 20% stock drop. EPS $0.38 vs $0.42 expected. Q4 revenue guidance below consensus</li>
                        <li><strong>2025-11:</strong> Record 600M MAUs achieved, 9th consecutive quarter of user growth. Global MAUs +12% YoY</li>
                        <li><strong>2025-11:</strong> International revenue acceleration - Europe +41% YoY, Rest of World +66% YoY</li>
                        <li><strong>2025-11:</strong> Outbound clicks to advertisers rose 40% in Q3 2025, showing improved commerce intent</li>
                        <li><strong>2025-10:</strong> Pinterest Assistant AI shopping tool launched in beta for US users 18+</li>
                        <li><strong>2025-10:</strong> NOYB privacy complaint filed alleging GDPR violations</li>
                        <li><strong>2024-Q4:</strong> First GAAP profitable year - $1.862B net income (includes $1.597B one-time tax benefit)</li>
                        <li><strong>2024-11:</strong> New $2B stock repurchase program authorized</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- KPI Cards -->
    <div class="kpi-grid" id="kpiGrid">
        <!-- Populated by JavaScript -->
    </div>

    <!-- Management Guidance Section -->
    <div class="guidance-section" id="guidanceSection">
        <div class="guidance-header">
            <h3>Management Guidance</h3>
            <span class="guidance-meta">As of <span id="guidanceAsOf">Q3 2025 Earnings (November 4, 2025)</span> | <span id="guidanceFY">FY2025</span></span>
        </div>
        <div class="guidance-grid" id="guidanceGrid">
            <!-- Populated by JavaScript -->
        </div>
        <div class="guidance-commentary" id="guidanceCommentary">
            <!-- Management commentary -->
        </div>
    </div>

    <!-- Charts -->
    <h2 class="section-title">Revenue & Profitability</h2>
    <div class="charts-container">
        <div class="chart-card">
            <div class="chart-header">
                <h3>Quarterly Revenue</h3>
                <button class="help-btn" onclick="openModal('revenue')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="revenueChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Revenue by Geography</h3>
                <button class="help-btn" onclick="openModal('revenueByGeo')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="revenueByGeoChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Operating Income & Margin</h3>
                <button class="help-btn" onclick="openModal('operatingIncome')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="operatingIncomeChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Adjusted EBITDA & Margin</h3>
                <button class="help-btn" onclick="openModal('ebitda')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="ebitdaChart"></canvas>
            </div>
        </div>
    </div>

    <h2 class="section-title">User Growth</h2>
    <div class="charts-container">
        <div class="chart-card">
            <div class="chart-header">
                <h3>Global Monthly Active Users (MAUs)</h3>
                <button class="help-btn" onclick="openModal('mau')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="mauChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>MAUs by Region</h3>
                <button class="help-btn" onclick="openModal('mauByRegion')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="mauByRegionChart"></canvas>
            </div>
        </div>
    </div>

    <h2 class="section-title">Monetization - The Key to Pinterest's Future</h2>
    <div class="charts-container">
        <div class="chart-card">
            <div class="chart-header">
                <h3>ARPU by Region (Critical Metric)</h3>
                <button class="help-btn" onclick="openModal('arpuByRegion')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="arpuByRegionChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Global ARPU Trend</h3>
                <button class="help-btn" onclick="openModal('globalArpu')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="globalArpuChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>ARPU Growth Rate (YoY %)</h3>
                <button class="help-btn" onclick="openModal('arpuGrowth')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="arpuGrowthChart"></canvas>
            </div>
        </div>
    </div>

    <h2 class="section-title">Cash Flow & Balance Sheet</h2>
    <div class="charts-container">
        <div class="chart-card">
            <div class="chart-header">
                <h3>Annual Free Cash Flow</h3>
                <button class="help-btn" onclick="openModal('fcf')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="fcfChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>Operating Cash Flow vs CapEx</h3>
                <button class="help-btn" onclick="openModal('cashFlow')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="cashFlowChart"></canvas>
            </div>
        </div>
    </div>

    <h2 class="section-title">Growth Rates</h2>
    <div class="charts-container">
        <div class="chart-card">
            <div class="chart-header">
                <h3>YoY Revenue Growth %</h3>
                <button class="help-btn" onclick="openModal('revenueGrowth')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="revenueGrowthChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3>YoY MAU Growth %</h3>
                <button class="help-btn" onclick="openModal('mauGrowth')">?</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="mauGrowthChart"></canvas>
            </div>
        </div>
    </div>

    <!-- DCF Valuation Section -->
    <h2 class="section-title">DCF Valuation</h2>

    <!-- SBC Warning -->
    <div class="dcf-warning" style="display: flex; max-width: 1400px; margin: 0 auto 20px; background: rgba(231, 76, 60, 0.15); border: 2px solid rgba(231, 76, 60, 0.5);">
        <span class="warning-icon" style="font-size: 1.5rem;">&#9888;</span>
        <span><strong>Stock-Based Compensation Warning:</strong> Pinterest has significant SBC which dilutes shareholders. This simplified DCF does not account for SBC impact. See <code>pinterest_dcf_sbc_formatted.xlsx</code> in the PINS directory for a more comprehensive valuation that properly accounts for stock-based compensation.</span>
    </div>

    <div class="dcf-section">
        <!-- Valuation Summary Cards -->
        <div class="dcf-summary">
            <div class="dcf-card highlight">
                <div class="dcf-label">Intrinsic Value</div>
                <div class="dcf-value" id="dcfIV">$37</div>
                <div class="dcf-change positive" id="dcfUpside">+42% upside</div>
            </div>
            <div class="dcf-card">
                <div class="dcf-label">Entry Price (15% CAGR)</div>
                <div class="dcf-value" id="dcfEntry">$20</div>
                <div class="dcf-sublabel">Buy below for 15% annual return</div>
            </div>
            <div class="dcf-card">
                <div class="dcf-label">Current Price</div>
                <div class="dcf-value" id="dcfCurrent">$26</div>
            </div>
            <div class="dcf-card">
                <div class="dcf-label">Prob-Weighted IV</div>
                <div class="dcf-value" id="dcfWeighted">$38</div>
                <div class="dcf-sublabel">25% Bull / 50% Base / 25% Bear</div>
            </div>
        </div>

        <!-- Growth Rate Warning -->
        <div class="dcf-warning" id="growthWarning" style="display: none;">
            <span class="warning-icon">&#9888;</span>
            <span id="warningText">Growth divergence warning</span>
        </div>

        <!-- Interactive Sliders -->
        <div class="dcf-controls">
            <div class="slider-group">
                <label>Growth Rate: <span id="growthValue">18%</span></label>
                <input type="range" id="growthSlider" min="0" max="30" value="18" step="1">
                <div class="slider-hint" id="growthHint">Based on equity CAGR</div>
            </div>
            <div class="slider-group">
                <label>WACC: <span id="waccValue">10%</span></label>
                <input type="range" id="waccSlider" min="6" max="18" value="10" step="0.5">
            </div>
            <div class="slider-group">
                <label>Terminal Growth: <span id="terminalValue">3%</span></label>
                <input type="range" id="terminalSlider" min="0" max="5" value="3" step="0.5">
            </div>
        </div>

        <!-- Scenario Tabs -->
        <div class="scenario-tabs">
            <button class="scenario-tab active" data-scenario="base" onclick="switchScenario('base')">Base Case</button>
            <button class="scenario-tab" data-scenario="bull" onclick="switchScenario('bull')">Bull Case</button>
            <button class="scenario-tab" data-scenario="bear" onclick="switchScenario('bear')">Bear Case</button>
        </div>

        <!-- Scenario Details -->
        <div class="scenario-details" id="scenarioDetails">
            <div class="scenario-assumptions">
                <h4>Assumptions</h4>
                <div class="assumption-grid" id="assumptionGrid">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Sensitivity Table -->
        <div class="sensitivity-section">
            <h4>Sensitivity Analysis: Intrinsic Value by WACC & Terminal Growth</h4>
            <table class="sensitivity-table" id="sensitivityMatrix">
                <!-- Populated by JavaScript -->
            </table>
        </div>

        <!-- Historical Growth Rates -->
        <div class="historical-growth">
            <h4>Historical Growth Rates (CAGR)</h4>
            <div class="growth-grid" id="growthGrid">
                <!-- Populated by JavaScript -->
            </div>
        </div>

        <!-- Download Button -->
        <div class="dcf-download">
            <a href="PINS_DCF_Model.xlsx" class="download-btn" download>
                <span class="download-icon">&#8681;</span> Download Excel Model
            </a>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal-overlay" id="modalOverlay" onclick="closeModal(event)">
        <div class="modal">
            <div class="modal-header">
                <h3 id="modalTitle">Metric Title</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Content populated by JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // EMBEDDED CSV DATA
        const csvData = `Period,Revenue,GrossProfit,GrossMargin,OperatingIncome,OperatingMargin,EBITDA,NetIncome,NetMargin,EPS,OperatingCashFlow,FreeCashFlow,ShareholdersEquity,TotalDebt,CashAndEquivalents,SharesOutstanding,MAU_Global,MAU_US_Canada,MAU_Europe,MAU_RestOfWorld,ARPU_Global,ARPU_US_Canada,ARPU_Europe,ARPU_RestOfWorld
Q1 2019,201.9,115.0,57.0,-43.2,-21.4,-38.4,-41.4,-20.5,-0.33,,,,,1680.0,127.3,291,83,93,115,3.31,8.61,1.41,0.25
Q2 2019,261.2,171.9,65.8,44.1,16.9,51.7,47.0,18.0,0.00,,,,,1680.0,542.6,300,85,95,120,3.48,9.09,1.46,0.26
Q3 2019,279.7,190.5,68.1,-22.4,-8.0,-13.4,-18.9,-6.8,-0.15,,,,,1680.0,542.6,300,85,96,119,3.82,9.21,1.60,0.26
Q4 2019,399.9,306.4,76.6,-41.4,-10.3,-31.9,-38.4,-9.6,-0.30,,,1053.9,0.0,1713.3,542.6,300,85,95,120,4.39,10.25,1.66,0.29
FY2019,1142.8,783.9,68.6,-62.9,-5.5,16.7,-151.3,-13.2,-0.36,0.7,-33.1,1053.9,0.0,1713.3,420.5,300,85,95,120,3.81,9.04,1.53,0.27
Q1 2020,271.9,187.1,68.8,-44.8,-16.5,-38.4,-141.1,-51.9,-1.12,,,,,1880.0,542.6,335,88,104,143,3.28,9.39,1.52,0.24
Q2 2020,272.5,202.3,74.2,19.8,7.3,31.6,5.7,2.1,0.01,,,,,1880.0,542.6,376,93,113,170,2.92,8.53,1.42,0.19
Q3 2020,442.6,311.0,70.3,14.3,3.2,22.5,-94.2,-21.3,-0.16,,,,,1950.0,619.8,442,98,125,219,4.08,11.13,1.64,0.24
Q4 2020,705.7,453.8,64.3,-68.5,-9.7,119.6,102.7,14.6,0.16,,,1806.2,0.0,2127.6,632.3,459,100,129,230,4.13,11.88,1.72,0.26
FY2020,1692.7,1154.2,68.2,-79.2,-4.7,135.3,-128.3,-7.6,-0.23,466.1,438.1,1806.2,0.0,2127.6,632.3,459,100,129,230,3.83,10.74,1.60,0.23
Q1 2021,485.2,347.7,71.7,6.2,1.3,21.7,-21.7,-4.5,-0.03,,,,,2400.0,650.0,478,99,132,247,4.14,12.44,1.80,0.24
Q2 2021,613.0,446.7,72.9,27.3,4.5,52.7,-21.6,-3.5,-0.03,,,,,2400.0,675.0,454,92,131,231,5.46,16.43,2.33,0.33
Q3 2021,632.9,458.7,72.5,-28.6,-4.5,-12.1,-65.2,-10.3,-0.10,,,,,2450.0,688.8,444,90,130,224,5.77,17.02,2.46,0.35
Q4 2021,846.9,624.8,73.8,-93.6,-11.1,139.6,-67.9,-8.0,-0.10,,,2535.9,0.0,2579.6,688.8,431,91,127,213,8.01,23.05,3.21,0.50
FY2021,2578.0,1877.9,72.8,-88.5,-3.4,201.9,-176.4,-6.8,-0.26,727.5,687.1,2535.9,0.0,2579.6,688.8,431,91,127,213,5.98,17.96,3.24,0.36
Q1 2022,574.9,405.8,70.6,-77.9,-13.5,-62.1,-5.4,-0.9,-0.01,,,,,2350.0,675.0,433,89,127,217,5.45,16.73,2.83,0.33
Q2 2022,666.0,471.5,70.8,-50.3,-7.6,-33.9,-43.2,-6.5,-0.07,,,,,2350.0,675.0,433,88,127,218,6.25,19.22,3.17,0.38
Q3 2022,684.6,487.3,71.2,26.4,3.9,43.5,-65.2,-9.5,-0.10,,,,,2320.0,675.0,445,89,129,227,6.21,19.49,3.22,0.38
Q4 2022,877.1,759.2,86.6,0.0,0.0,302.2,118.4,13.5,0.18,,,2593.6,0.0,2287.8,665.7,450,89,128,233,7.95,25.14,3.77,0.51
FY2022,2802.6,2124.0,75.8,-101.7,-3.6,250.1,-96.0,-3.4,-0.14,469.2,440.2,2593.6,0.0,2287.8,665.7,450,89,128,233,6.23,20.69,3.40,0.42
Q1 2023,642.5,482.6,75.1,-118.0,-18.4,-99.6,-21.7,-3.4,-0.03,,,,,2380.0,675.0,463,92,133,238,5.66,17.77,3.24,0.34
Q2 2023,708.0,527.7,74.5,-79.7,-11.3,-63.2,-34.8,-4.9,-0.05,,,,,2380.0,675.0,465,93,136,236,6.21,19.34,3.44,0.38
Q3 2023,763.2,578.8,75.8,72.0,9.4,90.5,30.9,4.0,0.05,,,,,2420.0,675.0,482,94,139,249,6.47,20.47,3.60,0.40
Q4 2023,941.4,777.2,82.6,53.6,5.7,330.5,-10.0,-1.1,-0.01,,,3090.7,0.0,2511.1,674.6,498,94,142,262,7.84,26.15,4.70,0.48
FY2023,3055.1,2366.3,77.5,-125.7,-4.1,357.2,-35.6,-1.2,-0.05,613.0,605.0,3090.7,0.0,2511.1,674.6,498,94,142,262,6.43,25.64,4.01,0.50
Q1 2024,740.0,562.3,76.0,13.5,1.8,29.2,-2.8,-0.4,0.00,,,,,2470.0,686.0,518,95,146,277,5.88,19.55,3.31,0.34
Q2 2024,853.7,658.0,77.1,47.7,5.6,67.4,18.8,2.2,0.03,,,,,2470.0,686.0,522,97,150,275,6.73,22.07,3.70,0.36
Q3 2024,898.4,694.2,77.3,64.6,7.2,91.4,30.6,3.4,0.04,,,,,2480.0,690.0,537,99,139,300,7.31,24.12,4.05,0.42
Q4 2024,1154.1,981.3,85.0,54.0,4.7,844.2,1815.3,157.3,2.60,,,4751.2,0.0,2512.9,698.4,553,98,158,297,8.93,31.44,5.60,0.52
FY2024,3646.2,2895.8,79.4,179.8,4.9,1032.3,1862.1,51.1,2.67,964.6,940.0,4751.2,0.0,2512.9,698.4,553,98,158,297,6.94,29.15,4.24,0.59
Q1 2025,901.6,706.4,78.3,92.4,10.2,115.4,64.2,7.1,0.09,,,4688.5,0.0,2615.2,701.0,570,102,148,320,6.54,27.36,3.91,0.45
Q2 2025,951.8,746.0,78.4,118.1,12.4,146.8,93.0,9.8,0.14,,,4812.0,0.0,2659.4,701.0,578,102,146,329,7.29,30.66,4.32,0.60
Q3 2025,1049.2,825.0,78.6,154.4,14.7,187.8,131.3,12.5,0.19,,,5220.0,0.0,2720.0,703.0,600,103,150,347,7.64,31.96,5.28,0.68`;

        // EMBEDDED ANALYSIS JSON
        const analysis = {
            "ticker": "PINS",
            "company_name": "Pinterest, Inc.",
            "overview": "Pinterest is a visual search and discovery platform positioned at the intersection of search, social media, and commerce. The platform enables 600 million monthly active users to find inspiration and take action through searches, saves, and shopping. Pinterest generates 100% of revenue from advertising, differentiating itself through intent-based signals and a positive, brand-safe environment that resonates particularly with women (70% of users) and Gen Z (42% of users).",
            "guidance": {
                "as_of": "Q3 2025 Earnings (November 4, 2025)",
                "fiscal_year": "FY2025",
                "items": [
                    {
                        "metric": "Q4 2025 Revenue",
                        "target": "$1,313M - $1,338M",
                        "period": "Q4 2025",
                        "vs_prior": "below consensus",
                        "notes": "Represents 14-16% YoY growth. Midpoint $1.325B trailed Wall Street expectations of $1.34B. Assumes ~1 point FX tailwind"
                    },
                    {
                        "metric": "Q4 2025 Adjusted EBITDA",
                        "target": "$533M - $558M",
                        "period": "Q4 2025",
                        "vs_prior": "n/a",
                        "notes": "Implies ~40-42% Adjusted EBITDA margin at midpoint"
                    },
                    {
                        "metric": "Q4 2025 Non-GAAP Cost of Revenue",
                        "target": "High single digit % sequential increase from Q3",
                        "period": "Q4 2025",
                        "vs_prior": "n/a",
                        "notes": "Q3 2025 non-GAAP COR was $206M"
                    },
                    {
                        "metric": "Long-term Adjusted EBITDA Margin",
                        "target": "30-34%",
                        "period": "Next 3-5 years",
                        "vs_prior": "n/a",
                        "notes": "Q3 2025 Adjusted EBITDA margin was 29%, trailing 12 months at 30%"
                    },
                    {
                        "metric": "FY2025 Revenue (implied)",
                        "target": "~$4.3B",
                        "period": "FY2025",
                        "vs_prior": "maintained",
                        "notes": "Based on Q4 guidance midpoint plus reported Q1-Q3 actuals. Represents ~18% YoY growth"
                    }
                ],
                "management_commentary": "CFO Julia Donnelly noted 'pockets of moderating ad spend' in US & Canada during Q3, attributed to larger retailers dealing with tariff-related margin pressure. CEO emphasized record user growth and international momentum, with Europe and Rest of World showing strong ARPU acceleration. Management highlighted AI driving improved recommendations and commerce outcomes."
            }
        };

        // EMBEDDED DCF JSON
        const dcfData = {
            "ticker": "PINS",
            "company_name": "Pinterest, Inc.",
            "valuation_date": "2026-01-22",
            "current_price": 25.91,
            "inputs": {
                "shares_outstanding": 703.0,
                "net_debt": -2720.0,
                "last_fcf": 940.0,
                "cash_and_equivalents": 2720.0,
                "total_debt": 0.0,
                "currency": "USD",
                "units": "millions"
            },
            "historical_growth": {
                "revenue_3yr_cagr": 12.2,
                "revenue_5yr_cagr": 26.1,
                "eps_3yr_cagr": null,
                "eps_5yr_cagr": null,
                "equity_3yr_cagr": 23.4,
                "equity_5yr_cagr": 35.2,
                "fcf_3yr_cagr": 11.0,
                "fcf_4yr_cagr": 21.1,
                "selected_growth_rate": 18.0,
                "growth_rate_source": "blended",
                "growth_divergence_warning": "Equity 3Y CAGR (23.4%) is 91% higher than FCF 3Y CAGR (11.0%), suggesting aggressive equity growth driven by FY2024 one-time tax benefit. Using conservative 18% base growth rate blending equity and revenue CAGRs.",
                "notes": "FY2024 equity includes $1.6B one-time tax benefit. Underlying equity growth more conservative. Revenue and FCF CAGRs more stable."
            },
            "assumptions": {
                "base": {
                    "name": "Base Case",
                    "description": "Conservative growth reflecting international monetization success with gradual US market maturity",
                    "growth_rates": [18.0, 16.0, 14.0, 12.0, 10.0],
                    "fcf_margin": 24.0,
                    "wacc": 10.0,
                    "terminal_growth": 3.0,
                    "rationale": "Base growth of 18% year 1 reflects blend of equity and revenue CAGRs, decelerating as international markets mature. FCF margin expansion from current ~24% to 25.5% as operating leverage improves. WACC 10% reflects ad-tech risk profile."
                },
                "bull": {
                    "name": "Bull Case",
                    "description": "Strong international monetization with AI-driven engagement driving sustained premium growth",
                    "growth_rates": [25.0, 22.0, 20.0, 18.0, 15.0],
                    "fcf_margin": 26.0,
                    "wacc": 9.0,
                    "terminal_growth": 3.5,
                    "rationale": "Bull case assumes international ARPU closes gap faster (40-66% YoY growth sustained), Pinterest Assistant drives 50%+ increase in commerce conversions, Gen Z growth accelerates engagement. FCF margins expand to 29% with scale. Lower WACC reflects reduced execution risk."
                },
                "bear": {
                    "name": "Bear Case",
                    "description": "US ad market weakness and international monetization disappointment",
                    "growth_rates": [10.0, 8.0, 6.0, 5.0, 4.0],
                    "fcf_margin": 22.0,
                    "wacc": 12.0,
                    "terminal_growth": 2.5,
                    "rationale": "Bear case reflects continued US slowdown (75% of revenue), international monetization stalls, competition from Meta/TikTok intensifies, regulatory headwinds reduce ad effectiveness. Margins compressed by higher R&D needs. Higher WACC for execution risk."
                }
            },
            "valuation": {
                "base": {
                    "intrinsic_value": 36.77,
                    "upside": 41.9
                },
                "bull": {
                    "intrinsic_value": 59.58,
                    "upside": 130.0
                },
                "bear": {
                    "intrinsic_value": 20.74,
                    "upside": -19.9
                }
            },
            "entry_price": {
                "base": {
                    "entry_price": 20.23,
                    "terminal_value_per_share": 40.68
                },
                "bull": {
                    "entry_price": 35.23,
                    "terminal_value_per_share": 70.85
                },
                "bear": {
                    "entry_price": 9.80,
                    "terminal_value_per_share": 19.70
                }
            },
            "sensitivity": {
                "base_case": {
                    "wacc_range": [8.0, 9.0, 10.0, 11.0, 12.0],
                    "terminal_growth_range": [2.0, 2.5, 3.0, 3.5, 4.0],
                    "matrix": [
                        [48.23, 52.87, 58.94, 67.19, 78.85],
                        [41.79, 45.32, 49.67, 55.24, 62.54],
                        [36.89, 39.66, 42.98, 47.09, 52.30],
                        [33.09, 35.28, 37.85, 40.94, 44.77],
                        [29.99, 31.79, 33.87, 36.32, 39.25]
                    ]
                }
            },
            "probability_weighted": {
                "weights": {
                    "bull": 0.25,
                    "base": 0.50,
                    "bear": 0.25
                },
                "weighted_iv": 37.51,
                "upside_to_weighted": 44.8
            }
        };

        // Parse CSV
        function parseCSV(csv) {
            const lines = csv.trim().split('\n');
            const headers = lines[0].split(',');
            return lines.slice(1).map(line => {
                const values = line.split(',');
                const obj = {};
                headers.forEach((h, i) => obj[h.trim()] = values[i]?.trim());
                return obj;
            });
        }

        const data = parseCSV(csvData);

        // Sort data chronologically (oldest first) for charts
        data.sort((a, b) => {
            const parseDate = (p) => {
                const year = parseInt(p.match(/\d{4}/)?.[0] || '0');
                const isQ1 = p.includes('Q1');
                const isQ2 = p.includes('Q2');
                const isQ3 = p.includes('Q3');
                const isQ4 = p.includes('Q4');
                const isH1 = p.includes('H1');
                const isH2 = p.includes('H2');
                const isFY = p.startsWith('FY');
                const subOrder = isQ1 ? 1 : isQ2 ? 2 : isH1 ? 3 : isQ3 ? 4 : isQ4 ? 5 : isH2 ? 6 : isFY ? 7 : 0;
                return year * 10 + subOrder;
            };
            return parseDate(a.Period) - parseDate(b.Period);
        });

        // Filter for quarterly and annual data
        const quarterlyData = data.filter(d => d.Period.startsWith('Q'));
        const fyData = data.filter(d => d.Period.startsWith('FY'));

        // Latest quarter for KPIs
        const latest = quarterlyData[quarterlyData.length - 1];
        const prevYear = quarterlyData.find(d => {
            const latestQ = latest.Period.match(/Q\d/)?.[0];
            const latestY = latest.Period.match(/\d{4}/)?.[0];
            const prevY = (parseInt(latestY) - 1).toString();
            return d.Period === latestQ + ' ' + prevY;
        });

        // Calculate YoY change
        function calcYoY(current, previous) {
            if (!previous || !current) return null;
            return ((parseFloat(current) - parseFloat(previous)) / Math.abs(parseFloat(previous)) * 100).toFixed(1);
        }

        // Render KPI cards
        function renderKPIs() {
            const kpis = [
                {
                    label: 'Revenue (Q3 2025)',
                    value: '$' + parseFloat(latest.Revenue).toFixed(0) + 'M',
                    change: calcYoY(latest.Revenue, prevYear?.Revenue)
                },
                {
                    label: 'Global MAU',
                    value: parseFloat(latest.MAU_Global).toFixed(0) + 'M',
                    change: calcYoY(latest.MAU_Global, prevYear?.MAU_Global)
                },
                {
                    label: 'Global ARPU',
                    value: '$' + parseFloat(latest.ARPU_Global).toFixed(2),
                    change: calcYoY(latest.ARPU_Global, prevYear?.ARPU_Global)
                },
                {
                    label: 'US/Canada ARPU',
                    value: '$' + parseFloat(latest.ARPU_US_Canada).toFixed(2),
                    change: calcYoY(latest.ARPU_US_Canada, prevYear?.ARPU_US_Canada)
                },
                {
                    label: 'International ARPU',
                    value: '$' + ((parseFloat(latest.ARPU_Europe) + parseFloat(latest.ARPU_RestOfWorld)) / 2).toFixed(2),
                    change: calcYoY(
                        (parseFloat(latest.ARPU_Europe) + parseFloat(latest.ARPU_RestOfWorld)) / 2,
                        (parseFloat(prevYear?.ARPU_Europe || 0) + parseFloat(prevYear?.ARPU_RestOfWorld || 0)) / 2
                    )
                },
                {
                    label: 'Adjusted EBITDA Margin',
                    value: (parseFloat(latest.EBITDA) / parseFloat(latest.Revenue) * 100).toFixed(1) + '%',
                    change: null
                },
                {
                    label: 'Operating Margin',
                    value: parseFloat(latest.OperatingMargin).toFixed(1) + '%',
                    change: null
                },
                {
                    label: 'Free Cash Flow (TTM)',
                    value: '$' + parseFloat(fyData[fyData.length - 1].FreeCashFlow).toFixed(0) + 'M',
                    change: calcYoY(
                        fyData[fyData.length - 1].FreeCashFlow,
                        fyData[fyData.length - 2]?.FreeCashFlow
                    )
                }
            ];

            const grid = document.getElementById('kpiGrid');
            grid.innerHTML = kpis.map(kpi => {
                let changeHtml = '';
                if (kpi.change !== null) {
                    const changeClass = parseFloat(kpi.change) >= 0 ? 'positive' : 'negative';
                    const sign = parseFloat(kpi.change) >= 0 ? '+' : '';
                    changeHtml = `<div class="kpi-change ${changeClass}">${sign}${kpi.change}% YoY</div>`;
                }
                return `
                    <div class="kpi-card">
                        <div class="kpi-value">${kpi.value}</div>
                        <div class="kpi-label">${kpi.label}</div>
                        ${changeHtml}
                    </div>
                `;
            }).join('');
        }

        // Render guidance section
        function renderGuidance() {
            if (!analysis.guidance || !analysis.guidance.items || analysis.guidance.items.length === 0) {
                document.getElementById('guidanceSection').style.display = 'none';
                return;
            }

            const guidance = analysis.guidance;
            document.getElementById('guidanceAsOf').textContent = guidance.as_of || '';
            document.getElementById('guidanceFY').textContent = guidance.fiscal_year || '';

            const grid = document.getElementById('guidanceGrid');
            grid.innerHTML = guidance.items.map(item => {
                let vsClass = 'new';
                let vsLabel = 'New';
                if (item.vs_prior) {
                    const vs = item.vs_prior.toLowerCase();
                    if (vs.includes('raise') || vs.includes('above')) {
                        vsClass = 'raised';
                        vsLabel = 'Raised';
                    } else if (vs.includes('lower') || vs.includes('below')) {
                        vsClass = 'lowered';
                        vsLabel = 'Below Consensus';
                    } else if (vs.includes('maintain')) {
                        vsClass = 'maintained';
                        vsLabel = 'Maintained';
                    } else {
                        vsLabel = item.vs_prior.charAt(0).toUpperCase() + item.vs_prior.slice(1);
                    }
                }
                return `
                    <div class="guidance-card">
                        <div class="guidance-metric">${item.metric}</div>
                        <div class="guidance-target">${item.target}</div>
                        <div class="guidance-period">${item.period}</div>
                        <span class="guidance-vs-prior ${vsClass}">${vsLabel}</span>
                        ${item.notes ? `<div class="guidance-notes">${item.notes}</div>` : ''}
                    </div>
                `;
            }).join('');

            const commentary = document.getElementById('guidanceCommentary');
            if (guidance.management_commentary) {
                commentary.textContent = guidance.management_commentary;
                commentary.style.display = 'block';
            } else {
                commentary.style.display = 'none';
            }
        }

        // Chart defaults
        const chartDefaults = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { labels: { color: '#e0e0e0', font: { size: 11 } } }
            },
            scales: {
                x: { ticks: { color: '#888' }, grid: { color: 'rgba(255,255,255,0.05)' } },
                y: { ticks: { color: '#888' }, grid: { color: 'rgba(255,255,255,0.05)' } }
            }
        };

        const colors = {
            primary: '#00d4aa',
            secondary: '#00b894',
            tertiary: '#0984e3',
            quaternary: '#6c5ce7',
            warning: '#fdcb6e',
            danger: '#ff6b6b'
        };

        // Toggle overview
        function toggleOverview() {
            const btn = document.querySelector('.overview-toggle');
            const content = document.getElementById('overviewContent');
            btn.classList.toggle('active');
            content.classList.toggle('active');
        }

        // Modal functions
        function openModal(key) {
            document.getElementById('modalTitle').textContent = metricDescriptions[key].title;
            document.getElementById('modalBody').innerHTML = metricDescriptions[key].content;
            document.getElementById('modalOverlay').classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        function closeModal(event) {
            if (event && event.target !== document.getElementById('modalOverlay')) return;
            document.getElementById('modalOverlay').classList.remove('active');
            document.body.style.overflow = '';
        }
        document.addEventListener('keydown', e => { if (e.key === 'Escape') closeModal(); });

        // Metric descriptions
        const metricDescriptions = {
            revenue: {
                title: "Quarterly Revenue",
                content: `
                    <p><strong>Revenue</strong> is the total income Pinterest generates from advertising.</p>
                    <div class="metric-highlight">
                        <strong>For Pinterest:</strong> 100% of revenue comes from digital advertising. Revenue is generated when advertisers pay for ad impressions (CPM), clicks (CPC), video views (CPV), or conversions (CPA/oCPM).
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li><strong>Quarterly acceleration/deceleration:</strong> Pinterest is highly seasonal (Q4 holiday peak). Watch for consistent growth trends YoY.</li>
                        <li><strong>Geographic mix:</strong> US & Canada is 75% of revenue but growing slower. International (25% of revenue) is growing 40-66% YoY.</li>
                        <li><strong>Guidance vs actuals:</strong> Q3 2025 guidance miss caused 20% stock drop, showing market sensitivity.</li>
                        <li><strong>Target:</strong> Management guiding to $4.3B for FY2025 (~18% growth). Watch for Q4 2025 performance ($1.31-1.34B guidance).</li>
                    </ul>
                `
            },
            revenueByGeo: {
                title: "Revenue by Geography",
                content: `
                    <p><strong>Revenue by Geography</strong> shows the breakdown of Pinterest's advertising revenue across three regions: US & Canada, Europe, and Rest of World.</p>
                    <div class="metric-highlight">
                        <strong>Critical for Pinterest:</strong> Geographic diversification is THE key growth driver. US & Canada is 75% of revenue but mature. International is only 25% of revenue despite having 83% of users (500M+ MAUs).
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li><strong>International growth acceleration:</strong> Europe grew 41% YoY in Q3 2025, Rest of World 66% YoY. This momentum is critical to the bull case.</li>
                        <li><strong>US & Canada growth:</strong> Growing 10-15% YoY but slowing. CFO cited "pockets of moderating ad spend" from retailers dealing with tariff pressures.</li>
                        <li><strong>International scaling:</strong> Watch for evidence that Pinterest can build advertiser base and sales infrastructure internationally without excessive cost.</li>
                        <li><strong>Geographic ARPU gap:</strong> US ARPU is $7.64 vs Europe $1.31 and Rest of World $0.21. Closing this gap is the multi-billion dollar opportunity.</li>
                    </ul>
                `
            },
            operatingIncome: {
                title: "Operating Income & Margin",
                content: `
                    <p><strong>Operating Income</strong> is revenue minus cost of revenue and operating expenses (R&D, sales & marketing, G&A). Operating margin is operating income as a percentage of revenue.</p>
                    <div class="metric-highlight">
                        <strong>For Pinterest:</strong> Operating profitability turned positive in 2023-2024 after years of losses. Q3 2025 operating margin was 14.7%, showing Pinterest can achieve profitability while investing in growth.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li><strong>Margin expansion trajectory:</strong> Operating margin improving from negative (2019-2022) to low single digits (2023) to mid-teens (2025). Target is 30-34% adjusted EBITDA margin long-term.</li>
                        <li><strong>Investment vs profitability tradeoff:</strong> Pinterest must balance investing in international sales, AI development, and product innovation against near-term profitability.</li>
                        <li><strong>Seasonal patterns:</strong> Operating margins spike in Q4 (holiday advertising surge) and dip in Q1. Focus on year-over-year comparisons.</li>
                        <li><strong>Cost control:</strong> Pinterest is using open-source AI to reduce infrastructure costs while maintaining product quality.</li>
                    </ul>
                `
            },
            ebitda: {
                title: "Adjusted EBITDA & Margin",
                content: `
                    <p><strong>Adjusted EBITDA</strong> (Earnings Before Interest, Taxes, Depreciation, Amortization) is a non-GAAP measure that excludes stock-based compensation and other one-time items. It shows operational cash generation.</p>
                    <div class="metric-highlight">
                        <strong>For Pinterest:</strong> Adjusted EBITDA margin hit 30% on a trailing 12-month basis in Q3 2025. Management's long-term target is 30-34% margin. Q3 2025 adjusted EBITDA was $187.8M (29% margin).
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li><strong>Path to 30-34% target:</strong> Management has articulated a 30-34% long-term margin target. Watch for consistent progress toward this goal.</li>
                        <li><strong>Q4 2025 guidance:</strong> $533-558M adjusted EBITDA implies 40-42% margin (seasonally high due to holiday advertising).</li>
                        <li><strong>Margin sustainability:</strong> Key question is whether Pinterest can maintain 30%+ margins while investing aggressively in international expansion and AI.</li>
                        <li><strong>Comparison to peers:</strong> Meta has 40-50% operating margins, Google 25-30%. Pinterest targeting upper end of ad-tech industry range.</li>
                    </ul>
                `
            },
            mau: {
                title: "Global Monthly Active Users (MAUs)",
                content: `
                    <p><strong>MAU (Monthly Active Users)</strong> is the number of unique users who access Pinterest at least once per month. This is the platform's primary user engagement metric.</p>
                    <div class="metric-highlight">
                        <strong>For Pinterest:</strong> MAUs reached a record 600M in Q3 2025, marking the 9th consecutive quarter of user growth. Global MAUs grew 12% YoY (Q3 2024: 537M â†’ Q3 2025: 600M).
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li><strong>User growth sustainability:</strong> Pinterest has reaccelerated user growth after stagnation in 2021-2022 (peaked at 689M in Q4 2021, declined to 675M by mid-2022). Current momentum is positive.</li>
                        <li><strong>Engagement quality:</strong> MAU is less important than WAU/MAU ratio (62%) and engagement metrics. Pinterest is not a daily-use platform for many users.</li>
                        <li><strong>Gen Z penetration:</strong> Gen Z now represents 42% of users with 30% YoY search growth. Critical demographic for long-term health.</li>
                        <li><strong>Geographic growth:</strong> Most growth is international. US & Canada grew only 4% YoY (99M â†’ 103M), while Rest of World grew 16% (300M â†’ 347M).</li>
                    </ul>
                `
            },
            mauByRegion: {
                title: "MAUs by Region",
                content: `
                    <p><strong>MAUs by Region</strong> breaks down Pinterest's 600M monthly active users across three regions: US & Canada, Europe, and Rest of World.</p>
                    <div class="metric-highlight">
                        <strong>Critical insight:</strong> Geographic distribution of users is inverse to revenue. US & Canada has only 17% of MAUs (103M) but generates 75% of revenue. Rest of World has 58% of MAUs (347M) but only 7% of revenue.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li><strong>US & Canada user growth:</strong> Slowing to 4% YoY (Q3 2025). Market is mature. Focus should be on ARPU growth, not user growth.</li>
                        <li><strong>International user growth:</strong> Europe +2% YoY (stable at 150M), Rest of World +16% YoY (300M â†’ 347M). Strong growth but needs to monetize.</li>
                        <li><strong>User quality by region:</strong> US & Canada users are highest value ($31.96 ARPU). International users generate far less revenue currently but have enormous upside.</li>
                        <li><strong>Total addressable market:</strong> At 600M MAUs, Pinterest has ~10% penetration of global internet users (5-6B). Plenty of room to grow, especially in emerging markets.</li>
                    </ul>
                `
            },
            arpuByRegion: {
                title: "ARPU by Region - THE MOST IMPORTANT CHART",
                content: `
                    <p><strong>ARPU (Average Revenue Per User)</strong> is quarterly revenue divided by MAUs in each region. This is THE key metric for Pinterest's valuation.</p>
                    <div class="metric-highlight">
                        <strong>Why this matters:</strong> The ARPU gap between US and international is the $10-50B question for Pinterest. US ARPU is $31.96 (Q3 2025). Europe ARPU is $5.28 (17% of US). Rest of World ARPU is $0.68 (2% of US).
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li><strong>International ARPU acceleration:</strong> Europe ARPU +31% YoY ($4.05 â†’ $5.28). Rest of World ARPU +44% YoY ($0.47 â†’ $0.68). This acceleration is the bull case.</li>
                        <li><strong>US ARPU trajectory:</strong> US ARPU +33% YoY ($24.12 â†’ $31.96). Still growing robustly despite market maturity, driven by AI improvements and shopping ads.</li>
                        <li><strong>Advertiser density:</strong> US has deep advertiser base with sophisticated measurement. International requires building sales teams, localizing ad products, and signing up local advertisers.</li>
                        <li><strong>Bull case math:</strong> If international ARPU reaches even 25% of US levels ($8 in Europe, $2 in Rest of World), that would add ~$2-3B in annual revenue on top of current $4.3B run rate.</li>
                        <li><strong>Bear case risk:</strong> International ARPU may never approach US levels due to lower advertiser budgets, competition, or user behavior differences.</li>
                    </ul>
                `
            },
            globalArpu: {
                title: "Global ARPU Trend",
                content: `
                    <p><strong>Global ARPU</strong> is the blended average revenue per user across all regions. It's calculated as total quarterly revenue divided by global MAUs.</p>
                    <div class="metric-highlight">
                        <strong>For Pinterest:</strong> Global ARPU was $7.64 in Q3 2025, up from $7.31 in Q3 2024 (+5% YoY). However, this is heavily influenced by geographic mix. As international users grow faster, global ARPU can actually decline even if regional ARPUs are growing.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li><strong>Mix shift dynamics:</strong> Adding 1M users in Rest of World ($0.68 ARPU) dilutes global average more than adding 1M in US ($31.96 ARPU). This is mathematically inevitable but not a sign of business weakness.</li>
                        <li><strong>Focus on regional ARPU, not global:</strong> Regional ARPU trends are more informative. Global ARPU is useful for quick math (600M MAUs Ã— $7.64 Ã— 4 quarters â‰ˆ $18.3B addressable at current monetization).</li>
                        <li><strong>Comparison to competitors:</strong> Meta's global ARPU is ~$12-15, but includes WhatsApp and emerging markets. Pinterest's US ARPU ($32/quarter = $128/year) is comparable to Meta's North America ARPU.</li>
                    </ul>
                `
            },
            arpuGrowth: {
                title: "ARPU Growth Rate (YoY %)",
                content: `
                    <p><strong>ARPU Growth Rate</strong> shows the year-over-year percentage change in ARPU by region. This is the velocity of monetization improvement.</p>
                    <div class="metric-highlight">
                        <strong>Current momentum:</strong> Q3 2025 ARPU growth rates were exceptional: US +33%, Europe +31%, Rest of World +44%, Global +5%. The divergence between regional (+30-40%) and global (+5%) growth shows mix shift impact.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li><strong>Sustainability of 30-40% international ARPU growth:</strong> Can Pinterest maintain 30%+ ARPU growth in Europe and Rest of World for 3-5 years? This determines whether the bull case plays out.</li>
                        <li><strong>US ARPU growth deceleration:</strong> US ARPU growth of 30%+ is unsustainable. Watch for moderation to 10-20% range as base grows larger. Any sustained decline would be concerning.</li>
                        <li><strong>Leading indicators:</strong> Pinterest reported 40% increase in outbound clicks (users clicking to advertiser websites) in Q3 2025. This suggests improving ad effectiveness and should translate to ARPU growth.</li>
                        <li><strong>Competitive benchmarking:</strong> Compare Pinterest's international ARPU growth to Meta, Snap, and other social platforms. Pinterest is playing catch-up but showing strong momentum.</li>
                    </ul>
                `
            },
            fcf: {
                title: "Annual Free Cash Flow",
                content: `
                    <p><strong>Free Cash Flow (FCF)</strong> is operating cash flow minus capital expenditures. It represents the cash available to return to shareholders or reinvest in the business.</p>
                    <div class="metric-highlight">
                        <strong>For Pinterest:</strong> FY2024 FCF was $940M on $3.6B revenue (26% FCF margin). This compares to $605M in FY2023 and $440M in FY2022. Pinterest is generating significant cash and has no debt.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li><strong>FCF margin expansion:</strong> Pinterest's FCF margin improved from 16% (2022) to 20% (2023) to 26% (2024). Base case DCF assumes 24-25% long-term FCF margin, so recent performance is ahead of expectations.</li>
                        <li><strong>Capital allocation:</strong> With $2.7B net cash and $940M FCF, Pinterest authorized a $2B buyback program. At current price (~$26), this represents ~11% of market cap. Strong capital returns.</li>
                        <li><strong>FCF conversion:</strong> Pinterest converts ~95%+ of adjusted EBITDA to FCF, showing capital-light business model. This is attractive for a tech platform.</li>
                        <li><strong>Investment needs:</strong> Watch for any major capex increases for AI infrastructure, international expansion, or new product development. So far, Pinterest has kept capex low (~$25M/quarter).</li>
                    </ul>
                `
            },
            cashFlow: {
                title: "Operating Cash Flow vs CapEx",
                content: `
                    <p><strong>Operating Cash Flow</strong> is cash generated from core business operations. <strong>CapEx (Capital Expenditures)</strong> is cash spent on property, equipment, and infrastructure. The difference is Free Cash Flow.</p>
                    <div class="metric-highlight">
                        <strong>For Pinterest:</strong> FY2024 operating cash flow was $965M with capex of only $25M, resulting in $940M FCF. Pinterest is highly capital-efficient, with capex representing only 0.7% of revenue.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li><strong>Operating leverage:</strong> Operating cash flow growing faster than revenue (OCF margin expanding) shows operating leverage. FY2024 OCF margin was 26% vs 18% in FY2022.</li>
                        <li><strong>Capex intensity:</strong> Pinterest's capex is minimal compared to revenue. This is typical for ad-tech platforms that don't need heavy infrastructure. Meta spends 15-20% of revenue on capex for comparison.</li>
                        <li><strong>AI infrastructure needs:</strong> Watch for capex increases related to AI model training and serving. Pinterest is using open-source models to minimize costs, but may need more investment as AI features scale.</li>
                        <li><strong>Working capital changes:</strong> Large working capital swings can distort OCF. Focus on multi-year trends rather than quarter-to-quarter volatility.</li>
                    </ul>
                `
            },
            revenueGrowth: {
                title: "YoY Revenue Growth %",
                content: `
                    <p><strong>YoY Revenue Growth</strong> shows the year-over-year percentage change in revenue. This is the top-line growth rate that drives valuation.</p>
                    <div class="metric-highlight">
                        <strong>For Pinterest:</strong> Q3 2025 revenue grew 17% YoY ($898M â†’ $1,049M). FY2025 implied growth is ~18% based on Q4 guidance. This is below the 48% CAGR from 2019-2021 but above the 9% growth in 2022-2023 slowdown period.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li><strong>Reacceleration trend:</strong> Revenue growth bottomed at 8-9% in 2022-2023 and has reaccelerated to 17-20% in 2024-2025. Maintaining high-teens growth is critical.</li>
                        <li><strong>Geographic mix:</strong> US growth is moderating (10-15%) while international is accelerating (40-66%). Blended growth depends on international scaling successfully.</li>
                        <li><strong>Guidance vs actuals:</strong> Q3 2025 guidance miss (-4% below consensus) caused 20% stock drop. Markets are unforgiving of misses. Watch for Q4 execution.</li>
                        <li><strong>Long-term target:</strong> Base case DCF assumes 18% growth in year 1 decelerating to 10% by year 5 as Pinterest matures. Bull case assumes 25% year 1 declining to 15% by year 5.</li>
                    </ul>
                `
            },
            mauGrowth: {
                title: "YoY MAU Growth %",
                content: `
                    <p><strong>YoY MAU Growth</strong> shows the year-over-year percentage change in monthly active users. This measures user base expansion.</p>
                    <div class="metric-highlight">
                        <strong>For Pinterest:</strong> Q3 2025 MAU growth was 12% YoY (537M â†’ 600M). This is the 9th consecutive quarter of user growth after stagnation in 2021-2022. MAU growth is critical for showing platform health.
                    </div>
                    <p><strong>What to watch:</strong></p>
                    <ul>
                        <li><strong>US growth slowdown:</strong> US & Canada MAU growth is only 4% YoY (99M â†’ 103M). Market is saturated. Pinterest needs to focus on monetization, not user acquisition in US.</li>
                        <li><strong>International growth:</strong> Rest of World growing 16% YoY (300M â†’ 347M). This is where user growth will come from. Europe is flat at 150M.</li>
                        <li><strong>Engagement metrics:</strong> MAU growth is less important than engagement metrics like WAU/MAU ratio (62%), searches per user, and time on platform. Quality > quantity.</li>
                        <li><strong>Comparison to competitors:</strong> Meta grows MAUs 3-5% YoY with 3.3B users. Pinterest at 600M users growing 12% is strong in absolute terms but has much more room to grow.</li>
                    </ul>
                `
            }
        };

        // Create charts
        function createCharts() {
            // Revenue chart
            new Chart(document.getElementById('revenueChart'), {
                type: 'bar',
                data: {
                    labels: quarterlyData.map(d => d.Period),
                    datasets: [{
                        label: 'Revenue ($M)',
                        data: quarterlyData.map(d => parseFloat(d.Revenue)),
                        backgroundColor: colors.primary,
                        borderRadius: 6
                    }]
                },
                options: {
                    ...chartDefaults,
                    plugins: {
                        ...chartDefaults.plugins,
                        tooltip: {
                            callbacks: {
                                label: (context) => `$${context.parsed.y.toFixed(0)}M`
                            }
                        }
                    }
                }
            });

            // Revenue by Geography (stacked bar)
            const geoLabels = quarterlyData.filter((d, i) => i % 4 === 0).map(d => d.Period); // Annual spacing
            const geoData = quarterlyData.filter((d, i) => i % 4 === 0);

            new Chart(document.getElementById('revenueByGeoChart'), {
                type: 'bar',
                data: {
                    labels: geoLabels,
                    datasets: [
                        {
                            label: 'US & Canada',
                            data: geoData.map(d => parseFloat(d.ARPU_US_Canada) * parseFloat(d.MAU_US_Canada)),
                            backgroundColor: colors.primary
                        },
                        {
                            label: 'Europe',
                            data: geoData.map(d => parseFloat(d.ARPU_Europe) * parseFloat(d.MAU_Europe)),
                            backgroundColor: colors.tertiary
                        },
                        {
                            label: 'Rest of World',
                            data: geoData.map(d => parseFloat(d.ARPU_RestOfWorld) * parseFloat(d.MAU_RestOfWorld)),
                            backgroundColor: colors.quaternary
                        }
                    ]
                },
                options: {
                    ...chartDefaults,
                    scales: {
                        ...chartDefaults.scales,
                        x: { ...chartDefaults.scales.x, stacked: true },
                        y: { ...chartDefaults.scales.y, stacked: true }
                    }
                }
            });

            // Operating Income & Margin
            new Chart(document.getElementById('operatingIncomeChart'), {
                type: 'line',
                data: {
                    labels: quarterlyData.map(d => d.Period),
                    datasets: [
                        {
                            label: 'Operating Income ($M)',
                            data: quarterlyData.map(d => parseFloat(d.OperatingIncome)),
                            borderColor: colors.primary,
                            backgroundColor: 'transparent',
                            yAxisID: 'y',
                            tension: 0.4
                        },
                        {
                            label: 'Operating Margin (%)',
                            data: quarterlyData.map(d => parseFloat(d.OperatingMargin)),
                            borderColor: colors.warning,
                            backgroundColor: 'transparent',
                            yAxisID: 'y1',
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    ...chartDefaults,
                    scales: {
                        ...chartDefaults.scales,
                        y: {
                            ...chartDefaults.scales.y,
                            position: 'left',
                            title: { display: true, text: 'Operating Income ($M)', color: '#888' }
                        },
                        y1: {
                            ...chartDefaults.scales.y,
                            position: 'right',
                            title: { display: true, text: 'Margin (%)', color: '#888' },
                            grid: { drawOnChartArea: false }
                        }
                    }
                }
            });

            // Adjusted EBITDA
            new Chart(document.getElementById('ebitdaChart'), {
                type: 'line',
                data: {
                    labels: quarterlyData.map(d => d.Period),
                    datasets: [
                        {
                            label: 'Adjusted EBITDA ($M)',
                            data: quarterlyData.map(d => parseFloat(d.EBITDA)),
                            borderColor: colors.primary,
                            backgroundColor: 'transparent',
                            yAxisID: 'y',
                            tension: 0.4
                        },
                        {
                            label: 'EBITDA Margin (%)',
                            data: quarterlyData.map(d => (parseFloat(d.EBITDA) / parseFloat(d.Revenue) * 100)),
                            borderColor: colors.tertiary,
                            backgroundColor: 'transparent',
                            yAxisID: 'y1',
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    ...chartDefaults,
                    scales: {
                        ...chartDefaults.scales,
                        y: {
                            ...chartDefaults.scales.y,
                            position: 'left',
                            title: { display: true, text: 'EBITDA ($M)', color: '#888' }
                        },
                        y1: {
                            ...chartDefaults.scales.y,
                            position: 'right',
                            title: { display: true, text: 'Margin (%)', color: '#888' },
                            grid: { drawOnChartArea: false }
                        }
                    }
                }
            });

            // Global MAU
            new Chart(document.getElementById('mauChart'), {
                type: 'line',
                data: {
                    labels: quarterlyData.map(d => d.Period),
                    datasets: [{
                        label: 'Global MAU (Millions)',
                        data: quarterlyData.map(d => parseFloat(d.MAU_Global)),
                        borderColor: colors.primary,
                        backgroundColor: 'rgba(0, 212, 170, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: chartDefaults
            });

            // MAU by Region (stacked area)
            new Chart(document.getElementById('mauByRegionChart'), {
                type: 'line',
                data: {
                    labels: quarterlyData.map(d => d.Period),
                    datasets: [
                        {
                            label: 'US & Canada',
                            data: quarterlyData.map(d => parseFloat(d.MAU_US_Canada)),
                            borderColor: colors.primary,
                            backgroundColor: 'rgba(0, 212, 170, 0.3)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Europe',
                            data: quarterlyData.map(d => parseFloat(d.MAU_Europe)),
                            borderColor: colors.tertiary,
                            backgroundColor: 'rgba(9, 132, 227, 0.3)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'Rest of World',
                            data: quarterlyData.map(d => parseFloat(d.MAU_RestOfWorld)),
                            borderColor: colors.quaternary,
                            backgroundColor: 'rgba(108, 92, 231, 0.3)',
                            fill: true,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    ...chartDefaults,
                    scales: {
                        ...chartDefaults.scales,
                        y: { ...chartDefaults.scales.y, stacked: true }
                    }
                }
            });

            // ARPU by Region (THE KEY CHART)
            new Chart(document.getElementById('arpuByRegionChart'), {
                type: 'line',
                data: {
                    labels: quarterlyData.map(d => d.Period),
                    datasets: [
                        {
                            label: 'US & Canada ARPU',
                            data: quarterlyData.map(d => parseFloat(d.ARPU_US_Canada)),
                            borderColor: colors.primary,
                            backgroundColor: 'transparent',
                            borderWidth: 3,
                            tension: 0.4
                        },
                        {
                            label: 'Europe ARPU',
                            data: quarterlyData.map(d => parseFloat(d.ARPU_Europe)),
                            borderColor: colors.tertiary,
                            backgroundColor: 'transparent',
                            borderWidth: 2,
                            tension: 0.4
                        },
                        {
                            label: 'Rest of World ARPU',
                            data: quarterlyData.map(d => parseFloat(d.ARPU_RestOfWorld)),
                            borderColor: colors.quaternary,
                            backgroundColor: 'transparent',
                            borderWidth: 2,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    ...chartDefaults,
                    plugins: {
                        ...chartDefaults.plugins,
                        tooltip: {
                            callbacks: {
                                label: (context) => `${context.dataset.label}: $${context.parsed.y.toFixed(2)}`
                            }
                        }
                    }
                }
            });

            // Global ARPU
            new Chart(document.getElementById('globalArpuChart'), {
                type: 'line',
                data: {
                    labels: quarterlyData.map(d => d.Period),
                    datasets: [{
                        label: 'Global ARPU ($)',
                        data: quarterlyData.map(d => parseFloat(d.ARPU_Global)),
                        borderColor: colors.primary,
                        backgroundColor: 'rgba(0, 212, 170, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: chartDefaults
            });

            // ARPU Growth Rate
            const arpuGrowthData = quarterlyData.map((d, i) => {
                const prevYearIdx = i - 4;
                if (prevYearIdx < 0) return null;
                const curr = parseFloat(d.ARPU_Global);
                const prev = parseFloat(quarterlyData[prevYearIdx].ARPU_Global);
                return ((curr - prev) / prev * 100).toFixed(1);
            });

            new Chart(document.getElementById('arpuGrowthChart'), {
                type: 'bar',
                data: {
                    labels: quarterlyData.map(d => d.Period),
                    datasets: [{
                        label: 'Global ARPU Growth YoY (%)',
                        data: arpuGrowthData,
                        backgroundColor: arpuGrowthData.map(v => v >= 0 ? colors.primary : colors.danger),
                        borderRadius: 6
                    }]
                },
                options: {
                    ...chartDefaults,
                    plugins: {
                        ...chartDefaults.plugins,
                        tooltip: {
                            callbacks: {
                                label: (context) => context.parsed.y ? `${context.parsed.y}% YoY` : 'N/A'
                            }
                        }
                    }
                }
            });

            // Free Cash Flow (annual)
            new Chart(document.getElementById('fcfChart'), {
                type: 'bar',
                data: {
                    labels: fyData.map(d => d.Period),
                    datasets: [{
                        label: 'Free Cash Flow ($M)',
                        data: fyData.map(d => parseFloat(d.FreeCashFlow || 0)),
                        backgroundColor: colors.primary,
                        borderRadius: 6
                    }]
                },
                options: chartDefaults
            });

            // Operating Cash Flow vs CapEx
            new Chart(document.getElementById('cashFlowChart'), {
                type: 'bar',
                data: {
                    labels: fyData.map(d => d.Period),
                    datasets: [
                        {
                            label: 'Operating Cash Flow',
                            data: fyData.map(d => parseFloat(d.OperatingCashFlow || 0)),
                            backgroundColor: colors.primary
                        },
                        {
                            label: 'CapEx (negative)',
                            data: fyData.map(d => {
                                const ocf = parseFloat(d.OperatingCashFlow || 0);
                                const fcf = parseFloat(d.FreeCashFlow || 0);
                                return -(ocf - fcf);
                            }),
                            backgroundColor: colors.danger
                        }
                    ]
                },
                options: chartDefaults
            });

            // Revenue Growth Rate
            const revenueGrowthData = quarterlyData.map((d, i) => {
                const prevYearIdx = i - 4;
                if (prevYearIdx < 0) return null;
                return calcYoY(d.Revenue, quarterlyData[prevYearIdx].Revenue);
            });

            new Chart(document.getElementById('revenueGrowthChart'), {
                type: 'bar',
                data: {
                    labels: quarterlyData.map(d => d.Period),
                    datasets: [{
                        label: 'Revenue Growth YoY (%)',
                        data: revenueGrowthData,
                        backgroundColor: revenueGrowthData.map(v => v >= 0 ? colors.primary : colors.danger),
                        borderRadius: 6
                    }]
                },
                options: chartDefaults
            });

            // MAU Growth Rate
            const mauGrowthData = quarterlyData.map((d, i) => {
                const prevYearIdx = i - 4;
                if (prevYearIdx < 0) return null;
                return calcYoY(d.MAU_Global, quarterlyData[prevYearIdx].MAU_Global);
            });

            new Chart(document.getElementById('mauGrowthChart'), {
                type: 'bar',
                data: {
                    labels: quarterlyData.map(d => d.Period),
                    datasets: [{
                        label: 'MAU Growth YoY (%)',
                        data: mauGrowthData,
                        backgroundColor: mauGrowthData.map(v => v >= 0 ? colors.primary : colors.danger),
                        borderRadius: 6
                    }]
                },
                options: chartDefaults
            });
        }

        // DCF Section Functions
        let currentScenario = 'base';

        function initDCF() {
            if (!dcfData || !dcfData.valuation) return;

            // Set current price
            document.getElementById('dcfCurrent').textContent = '$' + dcfData.current_price.toFixed(0);

            // Show warning if growth diverges
            if (dcfData.historical_growth.growth_divergence_warning) {
                document.getElementById('growthWarning').style.display = 'flex';
                document.getElementById('warningText').textContent = dcfData.historical_growth.growth_divergence_warning;
            }

            // Set slider defaults from base case
            const base = dcfData.assumptions.base;
            document.getElementById('growthSlider').value = dcfData.historical_growth.selected_growth_rate;
            document.getElementById('waccSlider').value = base.wacc;
            document.getElementById('terminalSlider').value = base.terminal_growth;

            // Update slider labels
            document.getElementById('growthValue').textContent = dcfData.historical_growth.selected_growth_rate + '%';
            document.getElementById('waccValue').textContent = base.wacc + '%';
            document.getElementById('terminalValue').textContent = base.terminal_growth + '%';

            // Set growth hint
            document.getElementById('growthHint').textContent = 'Based on blended equity and revenue CAGRs';

            // Render components
            renderHistoricalGrowth();
            renderSensitivityMatrix();
            updateDCFDisplay();
            switchScenario('base');
        }

        function calculateDCF(growthRate, wacc, terminalGrowth) {
            const years = 5;
            const fcf = dcfData.inputs.last_fcf;
            let pvFCF = 0;
            let projectedFCF = fcf;

            for (let i = 0; i < years; i++) {
                projectedFCF *= (1 + growthRate / 100);
                pvFCF += projectedFCF / Math.pow(1 + wacc/100, i + 1);
            }

            const terminalFCF = projectedFCF * (1 + terminalGrowth/100);
            const terminalValue = terminalFCF / (wacc/100 - terminalGrowth/100);
            const pvTerminal = terminalValue / Math.pow(1 + wacc/100, years);

            const enterpriseValue = pvFCF + pvTerminal;
            const equityValue = enterpriseValue - dcfData.inputs.net_debt;
            const iv = equityValue / dcfData.inputs.shares_outstanding;

            const terminalPerShare = terminalValue / dcfData.inputs.shares_outstanding;
            const entryPrice = terminalPerShare / Math.pow(1.15, years);

            return {
                iv: iv,
                entryPrice: entryPrice,
                terminalPerShare: terminalPerShare,
                pvFCF: pvFCF,
                pvTerminal: pvTerminal,
                enterpriseValue: enterpriseValue
            };
        }

        window.updateDCFDisplay = function() {
            const growth = parseFloat(document.getElementById('growthSlider').value);
            const wacc = parseFloat(document.getElementById('waccSlider').value);
            const terminal = parseFloat(document.getElementById('terminalSlider').value);

            document.getElementById('growthValue').textContent = growth + '%';
            document.getElementById('waccValue').textContent = wacc + '%';
            document.getElementById('terminalValue').textContent = terminal + '%';

            const result = calculateDCF(growth, wacc, terminal);

            document.getElementById('dcfIV').textContent = '$' + result.iv.toFixed(0);
            document.getElementById('dcfEntry').textContent = '$' + result.entryPrice.toFixed(0);

            const upside = ((result.iv - dcfData.current_price) / dcfData.current_price * 100);
            const upsideEl = document.getElementById('dcfUpside');
            upsideEl.textContent = (upside >= 0 ? '+' : '') + upside.toFixed(0) + '% ' + (upside >= 0 ? 'upside' : 'downside');
            upsideEl.className = 'dcf-change ' + (upside >= 0 ? 'positive' : 'negative');

            document.getElementById('dcfWeighted').textContent = '$' + dcfData.probability_weighted.weighted_iv.toFixed(0);

            const grid = document.getElementById('assumptionGrid');
            if (grid) {
                grid.innerHTML = `
                    <div class="assumption-item">
                        <div class="label">Growth Rate</div>
                        <div class="value">${growth}%</div>
                    </div>
                    <div class="assumption-item">
                        <div class="label">WACC</div>
                        <div class="value">${wacc}%</div>
                    </div>
                    <div class="assumption-item">
                        <div class="label">Terminal Growth</div>
                        <div class="value">${terminal}%</div>
                    </div>
                    <div class="assumption-item">
                        <div class="label">Intrinsic Value</div>
                        <div class="value" style="color: #00d4aa;">$${result.iv.toFixed(0)}</div>
                    </div>
                    <div class="assumption-item">
                        <div class="label">Entry Price</div>
                        <div class="value" style="color: #00d4aa;">$${result.entryPrice.toFixed(0)}</div>
                    </div>
                `;
            }
        };

        window.switchScenario = function(scenario) {
            currentScenario = scenario;

            document.querySelectorAll('.scenario-tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.scenario === scenario);
            });

            const assumptions = dcfData.assumptions[scenario];
            const valuation = dcfData.valuation[scenario];

            document.getElementById('growthSlider').value = assumptions.growth_rates[0];
            document.getElementById('waccSlider').value = assumptions.wacc;
            document.getElementById('terminalSlider').value = assumptions.terminal_growth;

            const grid = document.getElementById('assumptionGrid');
            grid.innerHTML = `
                <div class="assumption-item">
                    <div class="label">Year 1 Growth</div>
                    <div class="value">${assumptions.growth_rates[0]}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">Year 5 Growth</div>
                    <div class="value">${assumptions.growth_rates[4]}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">FCF Margin</div>
                    <div class="value">${assumptions.fcf_margin}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">WACC</div>
                    <div class="value">${assumptions.wacc}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">Terminal Growth</div>
                    <div class="value">${assumptions.terminal_growth}%</div>
                </div>
                <div class="assumption-item">
                    <div class="label">Intrinsic Value</div>
                    <div class="value" style="color: #00d4aa;">$${valuation.intrinsic_value.toFixed(0)}</div>
                </div>
            `;

            updateDCFDisplay();
        };

        function renderHistoricalGrowth() {
            const growth = dcfData.historical_growth;
            const selectedSource = growth.growth_rate_source;
            const grid = document.getElementById('growthGrid');

            const metrics = [
                { key: 'revenue_3yr_cagr', label: 'Revenue 3Y' },
                { key: 'revenue_5yr_cagr', label: 'Revenue 5Y' },
                { key: 'equity_3yr_cagr', label: 'Equity 3Y' },
                { key: 'equity_5yr_cagr', label: 'Equity 5Y' },
                { key: 'fcf_3yr_cagr', label: 'FCF 3Y' },
                { key: 'fcf_4yr_cagr', label: 'FCF 4Y' }
            ];

            grid.innerHTML = metrics.map(m => {
                const rate = growth[m.key];
                if (rate === null) return '';
                const isSelected = selectedSource === 'blended' && (m.key === 'equity_3yr_cagr' || m.key === 'revenue_3yr_cagr');
                const colorClass = rate >= 0 ? 'positive' : 'negative';
                return `
                    <div class="growth-item ${isSelected ? 'selected' : ''}">
                        <div class="metric">${m.label}</div>
                        <div class="rate ${colorClass}">${rate >= 0 ? '+' : ''}${rate.toFixed(1)}%</div>
                    </div>
                `;
            }).join('');
        }

        function renderSensitivityMatrix() {
            const sens = dcfData.sensitivity.base_case;
            const table = document.getElementById('sensitivityMatrix');
            const currentPrice = dcfData.current_price;

            let html = '<tr><th>WACC \\ Term G</th>';
            sens.terminal_growth_range.forEach(tg => {
                html += `<th>${tg}%</th>`;
            });
            html += '</tr>';

            sens.wacc_range.forEach((wacc, i) => {
                html += `<tr><th>${wacc}%</th>`;
                sens.matrix[i].forEach((val, j) => {
                    const isHighlight = wacc === dcfData.assumptions.base.wacc &&
                                       sens.terminal_growth_range[j] === dcfData.assumptions.base.terminal_growth;
                    const colorClass = val >= currentPrice ? 'above-current' : 'below-current';
                    html += `<td class="${isHighlight ? 'highlight' : colorClass}">$${val.toFixed(0)}</td>`;
                });
                html += '</tr>';
            });

            table.innerHTML = html;
        }

        // Initialize everything
        renderKPIs();
        renderGuidance();
        createCharts();
        initDCF();

        // Bind slider events
        (function() {
            const growthSlider = document.getElementById('growthSlider');
            const waccSlider = document.getElementById('waccSlider');
            const terminalSlider = document.getElementById('terminalSlider');

            if (growthSlider) {
                growthSlider.oninput = window.updateDCFDisplay;
                growthSlider.onchange = window.updateDCFDisplay;
            }
            if (waccSlider) {
                waccSlider.oninput = window.updateDCFDisplay;
                waccSlider.onchange = window.updateDCFDisplay;
            }
            if (terminalSlider) {
                terminalSlider.oninput = window.updateDCFDisplay;
                terminalSlider.onchange = window.updateDCFDisplay;
            }
        })();
    </script>
</body>
</html>